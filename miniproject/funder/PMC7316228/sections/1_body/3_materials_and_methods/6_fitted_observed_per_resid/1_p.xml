<?xml version="1.0" encoding="UTF-8"?>
<p>Across 1918 to 2008, the charge in a given year, 
 <italic>i.e.</italic>, “yearly charge”, may vary for individual sites. In order to infer per-residue yearly charge from natural sequence data in the multiple sequence alignment, we fit multinomial statistical models. To compute the site-wise fitted observed charge from natural sequences, we used maximum likelihood estimation to obtain fitted observed charge over time at each site. If more than one charge value was present in the set of sequences at a particular site, we used the nnet package [
 <xref rid="pcbi.1007892.ref030" ref-type="bibr">30</xref>] in R [
 <xref rid="pcbi.1007892.ref031" ref-type="bibr">31</xref>] to fit a multinomial logistic regression model at each of the 565 sites, in order to obtain the probability 
 <italic>f</italic>
 <sub>
  <italic>i</italic>,
  <italic>c</italic>
 </sub>(
 <italic>t</italic>) of having the charge 
 <italic>c</italic> ∈ {−1, 0, 1} at site 
 <italic>i</italic> at time 
 <italic>t</italic>. Otherwise, we set 
 <italic>f</italic>
 <sub>
  <italic>i</italic>,
  <italic>c</italic>
 </sub>(
 <italic>t</italic>) = 1 and 
 <italic>f</italic>
 <sub>
  <italic>i</italic>,
  <italic>c</italic>
 </sub>(
 <italic>t</italic>) = 0, respectively, for the values of 
 <italic>c</italic> that occurred in all sequences and for the values of 
 <italic>c</italic> that occurred in none, respectively. Note that if there was ambiguity in a given sequence about its residue at a certain position, that residue was omitted when fitting multinomial models, in contrast to net charge computations. Then, we calculated the fitted observed charge 
 <inline-formula id="pcbi.1007892.e004">
  <alternatives>
   <graphic xlink:href="pcbi.1007892.e004.jpg" id="pcbi.1007892.e004g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M4">
    <mrow>
     <msubsup>
      <mi>C</mi>
      <mi>P</mi>
      <mrow>
       <mo>(</mo>
       <mi>i</mi>
       <mo>)</mo>
      </mrow>
     </msubsup>
     <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> at site 
 <italic>i</italic> at time 
 <italic>t</italic> as 
 <disp-formula id="pcbi.1007892.e005">
  <alternatives>
   <graphic xlink:href="pcbi.1007892.e005.jpg" id="pcbi.1007892.e005g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M5">
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="right">
       <mrow>
        <msubsup>
         <mi>C</mi>
         <mi>P</mi>
         <mrow>
          <mo>(</mo>
          <mi>i</mi>
          <mo>)</mo>
         </mrow>
        </msubsup>
        <mrow>
         <mo>(</mo>
         <mi>t</mi>
         <mo>)</mo>
        </mrow>
        <mo>=</mo>
        <munder>
         <mo>∑</mo>
         <mrow>
          <mi>c</mi>
          <mo>∈</mo>
          <mo>{</mo>
          <mo>-</mo>
          <mn>1</mn>
          <mo>,</mo>
          <mn>0</mn>
          <mo>,</mo>
          <mn>1</mn>
          <mo>}</mo>
         </mrow>
        </munder>
        <mi>c</mi>
        <msub>
         <mi>f</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mi>c</mi>
         </mrow>
        </msub>
        <mrow>
         <mo>(</mo>
         <mi>t</mi>
         <mo>)</mo>
        </mrow>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </math>
  </alternatives>
  <label>(3)</label>
 </disp-formula>
</p>
