<?xml version="1.0" encoding="UTF-8"?>
<fig id="pcbi.1007101.g002" orientation="portrait" position="float">
 <object-id pub-id-type="doi">10.1371/journal.pcbi.1007101.g002</object-id>
 <label>Fig 2</label>
 <caption>
  <title>Phylogeographic reconstruction with the Sankoff algorithm using asymmetric, effective distances.</title>
  <p>Exemplary phylogeographic reconstruction using the Sankoff algorithm on the tree and the cost matrix shown in panel A. The cost matrix 
   <italic>c</italic> is asymmetric and represents effective distances. For each internal node, the Sankoff algorithm calculates the minimal cost 
   <italic>S</italic>(
   <italic>i</italic>) in the subtree, given the node is assigned location 
   <italic>i</italic> (shown as the arrays in A, calculated via 
   <italic>S</italic>(
   <italic>i</italic>) = 
   <italic>min</italic>
   <sub>
    <italic>j</italic>
   </sub>[
   <italic>c</italic>
   <sub>
    <italic>ij</italic>
   </sub>+
   <italic>S</italic>
   <sub>
    <italic>l</italic>
   </sub>(
   <italic>j</italic>)]+
   <italic>min</italic>
   <sub>
    <italic>k</italic>
   </sub>[
   <italic>c</italic>
   <sub>
    <italic>ik</italic>
   </sub>+
   <italic>S</italic>
   <sub>
    <italic>r</italic>
   </sub>(
   <italic>k</italic>)], where 
   <italic>l</italic> and 
   <italic>r</italic> denote the two descendant subtrees, and their costs, 
   <italic>S</italic>
   <sub>
    <italic>l</italic>
   </sub>(
   <italic>j</italic>) and 
   <italic>S</italic>
   <sub>
    <italic>r</italic>
   </sub>(
   <italic>k</italic>), respectively. For the root (shown in red), location A results in the minimal cost and is assigned to that node (marked in green). Backtracking from the root to assign all other locations is shown in panel B. Given that a parent node has been assigned state 
   <italic>j</italic>, the child node will be assigned the state 
   <italic>i</italic> that minimizes 
   <italic>c</italic>
   <sub>
    <italic>ji</italic>
   </sub>+
   <italic>S</italic>(
   <italic>i</italic>). The result of the backtracking is indicated by arrows labeled with the costs and the states marked in green. The reconstructed spread along the tree is shown on a map in panel C.
  </p>
 </caption>
 <graphic xlink:href="pcbi.1007101.g002" xmlns:xlink="http://www.w3.org/1999/xlink"/>
</fig>
