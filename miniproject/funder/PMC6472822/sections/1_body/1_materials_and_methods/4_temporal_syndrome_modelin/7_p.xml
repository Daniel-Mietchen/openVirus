<?xml version="1.0" encoding="UTF-8"?>
<p>Thus, the final step in our approach is to determine the optimal number of components 
 <italic>k</italic>
 <sub>
  <italic>min</italic>
 </sub> to be used for the decomposition. A natural upper bound for 
 <italic>k</italic> would be the total number of symptoms, i.e. 19. We need to determine the number of components with the best trade-off between a model that best approximates the original matrix 
 <italic>X</italic> and at the same time does not overfit the data. Each time we minimize the loss function 
 <xref ref-type="disp-formula" rid="pcbi.1006173.e004">Eq (4)</xref> for a specific number of components 
 <italic>k</italic>, we obtain a candidate decomposition. To determine the best decomposition, we use an approximated model selection criterion, known as the Akaike Information Criterion (
 <italic>AIC</italic>) [
 <xref rid="pcbi.1006173.ref057" ref-type="bibr">57</xref>]. In particular, we employ the corrected version of the Akaike Information Criterion (
 <italic>AIC</italic>
 <sub>
  <italic>c</italic>
 </sub>) proposed in [
 <xref rid="pcbi.1006173.ref058" ref-type="bibr">58</xref>], valid for finite sample sizes. For each of the candidate decompositions generated by the various values of 
 <italic>k</italic>, we estimate the value of 
 <italic>AIC</italic>
 <sub>
  <italic>c</italic>
 </sub>(
 <italic>k</italic>), expressed as: 
 <disp-formula id="pcbi.1006173.e010">
  <alternatives>
   <graphic xlink:href="pcbi.1006173.e010.jpg" id="pcbi.1006173.e010g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M10">
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="right">
       <mrow>
        <msub>
         <mrow>
          <mi>A</mi>
          <mi>I</mi>
          <mi>C</mi>
         </mrow>
         <mi>c</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <mi>k</mi>
         <mo>)</mo>
        </mrow>
        <mo>=</mo>
        <mo>-</mo>
        <mn>2</mn>
        <mi>L</mi>
        <mrow>
         <mo>(</mo>
         <mi>k</mi>
         <mo>)</mo>
        </mrow>
        <mo>+</mo>
        <mn>2</mn>
        <mi>P</mi>
        <mo>+</mo>
        <mn>2</mn>
        <mfrac>
         <mrow>
          <mi>P</mi>
          <mo>(</mo>
          <mi>P</mi>
          <mo>+</mo>
          <mn>1</mn>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mo>-</mo>
          <mi>P</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
        <mo>,</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </math>
  </alternatives>
  <label>(10)</label>
 </disp-formula> where 
 <italic>L</italic>(
 <italic>k</italic>) is the log-likelihood of the model with 
 <italic>k</italic> components, defined in [
 <xref rid="pcbi.1006173.ref056" ref-type="bibr">56</xref>] as: 
 <disp-formula id="pcbi.1006173.e011">
  <alternatives>
   <graphic xlink:href="pcbi.1006173.e011.jpg" id="pcbi.1006173.e011g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M11">
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="right">
       <mrow>
        <mi>L</mi>
        <mrow>
         <mo>(</mo>
         <mi>k</mi>
         <mo>)</mo>
        </mrow>
        <mo>=</mo>
        <munder>
         <mo>âˆ‘</mo>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mi>j</mi>
         </mrow>
        </munder>
        <msub>
         <mi>x</mi>
         <mrow>
          <mi>i</mi>
          <mi>j</mi>
         </mrow>
        </msub>
        <mtext>log</mtext>
        <mspace width="2pt"/>
        <mi>p</mi>
        <mrow>
         <mo>(</mo>
         <mi>i</mi>
         <mo>,</mo>
         <mi>j</mi>
         <mo>)</mo>
        </mrow>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </math>
  </alternatives>
  <label>(11)</label>
 </disp-formula>
 <italic>P</italic> is the number of parameters of the model defined as: 
 <disp-formula id="pcbi.1006173.e012">
  <alternatives>
   <graphic xlink:href="pcbi.1006173.e012.jpg" id="pcbi.1006173.e012g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M12">
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="right">
       <mrow>
        <mi>P</mi>
        <mo>=</mo>
        <mi>K</mi>
        <mspace width="0.166667em"/>
        <mo>(</mo>
        <mi>I</mi>
        <mo>+</mo>
        <mi>J</mi>
        <mo>-</mo>
        <mn>2</mn>
        <mo>)</mo>
        <mo>-</mo>
        <mn>1</mn>
        <mo>,</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </math>
  </alternatives>
  <label>(12)</label>
 </disp-formula> where 
 <italic>K</italic> is the upper bound for the number of components, 
 <italic>I</italic> is the total number of days and 
 <italic>J</italic> is the total number of symptoms. The best candidate decomposition is the one that minimizes 
 <xref ref-type="disp-formula" rid="pcbi.1006173.e010">Eq (10)</xref> and we denote it as 
 <italic>AIC</italic>
 <sub>
  <italic>c</italic>
 </sub>(
 <italic>k</italic>
 <sub>
  <italic>min</italic>
 </sub>). The final result is a model, that we call 
 <inline-formula id="pcbi.1006173.e013">
  <alternatives>
   <graphic xlink:href="pcbi.1006173.e013.jpg" id="pcbi.1006173.e013g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M13">
    <msub>
     <mi>y</mi>
     <mrow>
      <mi>i</mi>
      <msub>
       <mi>k</mi>
       <mrow>
        <mi>m</mi>
        <mi>i</mi>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
    </msub>
   </math>
  </alternatives>
 </inline-formula>, consisting of 
 <italic>k</italic>
 <sub>
  <italic>min</italic>
 </sub> components that best approximate the original matrix 
 <italic>X</italic>.
</p>
