<?xml version="1.0" encoding="UTF-8"?>
<p>To learn these values of 
 <inline-formula>
  <math id="inf29">
   <msub>
    <mi>d</mi>
    <mi>m</mi>
   </msub>
  </math>
 </inline-formula>, we first split our dataset into training (random 90% of measurements) and test data (the remaining 10% of values). We take the training data and fit 
 <inline-formula>
  <math id="inf30">
   <msub>
    <mi>d</mi>
    <mi>m</mi>
   </msub>
  </math>
 </inline-formula> for each mutation that is observed two or more times, subject to regularization as follows (also detailed in Materials and methods, 
 <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). Parsimoniously, we expect that antigenic change is more likely to be incurred by a few key mutations than by many mutations; correspondingly, our prior expectation of values of 
 <inline-formula>
  <math id="inf31">
   <msub>
    <mi>d</mi>
    <mi>m</mi>
   </msub>
  </math>
 </inline-formula> is exponentially distributed such that most values of 
 <inline-formula>
  <math id="inf32">
   <mrow>
    <msub>
     <mi>d</mi>
     <mi>m</mi>
    </msub>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
  </math>
 </inline-formula>. This is directly analogous to lasso regression to identify a few parameters with positive weights and set other parameters to 0 (
 <xref rid="bib51" ref-type="bibr">Tibshirani, 1996</xref>). Additionally, some viruses have greater binding avidity, and some sera are more potent than others (
 <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>); these ‘row’ and ‘column’ effects, respectively, are normally distributed and are taken into account when training the model. The model uses convex optimization to learn the values of 
 <inline-formula>
  <math id="inf33">
   <msub>
    <mi>d</mi>
    <mi>m</mi>
   </msub>
  </math>
 </inline-formula> that minimize the sum of squared errors (SSE) between observed and predicted titers in the training data. We thus learn model parameters from the training data, and then use those parameters to predict test data values. We assess model performance by comparing the predicted test titer values to the actual values, aggregated across 100-fold Monte Carlo cross validation.
</p>
