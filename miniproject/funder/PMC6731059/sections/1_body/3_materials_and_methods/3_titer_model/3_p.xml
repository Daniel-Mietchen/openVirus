<?xml version="1.0" encoding="UTF-8"?>
<p>In the substitution model, observed titer drops are mapped to mutations between each serum and test virus strain after correcting for overall virus avidity, 
 <inline-formula>
  <math id="inf102">
   <msub>
    <mi>v</mi>
    <mi>i</mi>
   </msub>
  </math>
 </inline-formula>, and serum potency, 
 <inline-formula>
  <math id="inf103">
   <msub>
    <mi>p</mi>
    <mi>j</mi>
   </msub>
  </math>
 </inline-formula> (‘row’ and ‘column’ effects, respectively), so that
 <disp-formula id="equ2">
  <label>(2)</label>
  <math id="m2">
   <mstyle displaystyle="true" scriptlevel="0">
    <mrow>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>≈</mo>
     <msub>
      <mrow>
       <mover>
        <mi>D</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <munder>
      <mo>∑</mo>
      <mrow>
       <mi>m</mi>
      </mrow>
     </munder>
     <msub>
      <mi>d</mi>
      <mrow>
       <mi>m</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>v</mi>
      <mrow>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>p</mi>
      <mrow>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>,</mo>
    </mrow>
   </mstyle>
  </math>
 </disp-formula>where 
 <inline-formula>
  <math id="inf104">
   <msub>
    <mi>d</mi>
    <mi>m</mi>
   </msub>
  </math>
 </inline-formula> is the titer drop assigned to each mutation, 
 <inline-formula>
  <math id="inf105">
   <mi>m</mi>
  </math>
 </inline-formula>, between serum 
 <inline-formula>
  <math id="inf106">
   <mi>i</mi>
  </math>
 </inline-formula> and virus 
 <inline-formula>
  <math id="inf107">
   <mi>j</mi>
  </math>
 </inline-formula>, and 
 <inline-formula>
  <math id="inf108">
   <mi>m</mi>
  </math>
 </inline-formula> iterates over mutations. We randomly withhold 10% of titer measurements as a test set. We use the remaining 90% of titer measurements as a training set to learn values for virus avidity, serum potency, and mutation effects. As in 
 <xref rid="bib35" ref-type="bibr">Neher et al. (2016)</xref>, we formulate this as a convex optimization problem and solve for these parameter values to minimize the cost function
 <disp-formula id="equ3">
  <label>(3)</label>
  <math id="m3">
   <mstyle displaystyle="true" scriptlevel="0">
    <mrow>
     <mi>C</mi>
     <mo>=</mo>
     <munder>
      <mo>∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
      </mrow>
     </munder>
     <mo stretchy="false">(</mo>
     <msub>
      <mrow>
       <mover>
        <mi>D</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>−</mo>
     <msub>
      <mi>D</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <msup>
      <mo stretchy="false">)</mo>
      <mrow>
       <mn>2</mn>
      </mrow>
     </msup>
     <mo>+</mo>
     <mi>λ</mi>
     <munder>
      <mo>∑</mo>
      <mrow>
       <mi>m</mi>
      </mrow>
     </munder>
     <msub>
      <mi>d</mi>
      <mrow>
       <mi>m</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <mi>κ</mi>
     <munder>
      <mo>∑</mo>
      <mrow>
       <mi>i</mi>
      </mrow>
     </munder>
     <msubsup>
      <mi>v</mi>
      <mrow>
       <mi>i</mi>
      </mrow>
      <mrow>
       <mn>2</mn>
      </mrow>
     </msubsup>
     <mo>+</mo>
     <mi>δ</mi>
     <munder>
      <mo>∑</mo>
      <mrow>
       <mi>j</mi>
      </mrow>
     </munder>
     <msubsup>
      <mi>p</mi>
      <mrow>
       <mi>j</mi>
      </mrow>
      <mrow>
       <mn>2</mn>
      </mrow>
     </msubsup>
     <mo>.</mo>
    </mrow>
   </mstyle>
  </math>
 </disp-formula>
</p>
