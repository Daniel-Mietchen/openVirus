<?xml version="1.0" encoding="UTF-8"?>
<p>We used a stochastic network modeling method to construct the social structure in a specific region. The population information includes synthesized households, schools, workplaces, and the assignments of individuals to these places. We constructed sub-networks 
 <inline-formula id="m8">
  <inline-graphic id="d33e774" xlink:href="srep08980-m8.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> according to the population information (see 
 <xref ref-type="supplementary-material" rid="s1">Supplementary Fig. S1</xref> online). Each of them stands for a public place, such as school and workplace. The degree of each sub-network 
 <italic>G
  <sub>i</sub>
 </italic> is determined by two parameters: the probability that a given individual is connected to another in the same group in 
 <italic>p
  <sub>in</sub>
 </italic> and the probability that a given individual is connected to another from a different group 
 <italic>p
  <sub>out</sub>
 </italic>. The parameters were estimated using the Markov Chain Monte Carlo (MCMC) Metropolis-Hastings algorithm
 <xref ref-type="bibr" rid="b39">39</xref> to find the best fitting of the clinical data. The parameters can be found as 
 <xref ref-type="supplementary-material" rid="s1">Supplementary Table S1</xref> online. The whole social network was given by a block diagonal matrix 
 <italic>G</italic> with 
 <italic>G
  <sub>i</sub>
 </italic> as diagonal elements.
</p>
