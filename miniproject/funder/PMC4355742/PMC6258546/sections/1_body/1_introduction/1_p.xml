<?xml version="1.0" encoding="UTF-8"?>
<p>Mechanistic models guided by expert knowledge can form an efficient prior on epidemic history when conducting phylodynamic inference with genetic data [
 <xref rid="pcbi.1006546.ref001" ref-type="bibr">1</xref>]. Parameters estimated by fitting mechanistic models, such as the reproduction number 
 <italic>R</italic>
 <sub>0</sub>, are important for epidemic surveillance and forecasting. Compartmental models defined in terms of ordinary or stochastic differential equations are the most common type of mathematical infectious disease model, but in the area of phylodynamic inference, non-parametric approaches such as skyline coalescent models [
 <xref rid="pcbi.1006546.ref002" ref-type="bibr">2</xref>] or sampling-birth-death models [
 <xref rid="pcbi.1006546.ref003" ref-type="bibr">3</xref>] are more commonly used. Methods to translate compartmental infectious disease models into a population genetic framework have been developed only recently [
 <xref rid="pcbi.1006546.ref004" ref-type="bibr">4</xref>–
 <xref rid="pcbi.1006546.ref008" ref-type="bibr">8</xref>]. We address the gap in software tools for epidemic modeling and phylogenetic inference by developing a BEAST2 package, 
 <italic>PhyDyn</italic>, which includes a highly-flexible markup language for defining compartmental infectious disease models in terms of ordinary differential equations. This flexible framework enables phylodynamic inference with the majority of published compartmental models, such as the common susceptible-infected-removed (SIR) model [
 <xref rid="pcbi.1006546.ref009" ref-type="bibr">9</xref>] and its variants, which are often fitted to non-genetic surveillance data. The 
 <italic>PhyDyn</italic> model definition framework supports common mathematical functions, conditional logic, vectorized parameters and the definition of complex functions of time and/or state of the system. The 
 <italic>PhyDyn</italic> package can make use of categorical metadata associated with each sampled sequences, such as location of sampling, demographic attributes of an infected patient (age, sex), or clinical biomarkers. Phylogeographic models designed to estimate migration rates between spatial demes [
 <xref rid="pcbi.1006546.ref010" ref-type="bibr">10</xref>–
 <xref rid="pcbi.1006546.ref012" ref-type="bibr">12</xref>] are special cases within this modeling framework, and more complex phylogeographic models (e.g. time-varying or state-dependent population size or migration rates) can also be easily defined in this framework.
</p>
