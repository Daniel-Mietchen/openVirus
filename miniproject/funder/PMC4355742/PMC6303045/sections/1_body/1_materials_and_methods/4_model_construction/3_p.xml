<?xml version="1.0" encoding="UTF-8"?>
<p>Furthermore, our objective is to provide a universal model for the prediction of antigenic variants of influenza H1N1 that can be applied to all types, so a stacking model was introduced [
 <xref rid="pone.0207777.ref033" ref-type="bibr">33</xref>]. The stacking model uses a similar idea as 
 <italic>k</italic>-fold cross validation to create out-of-sample predictions that works for small or medium sized datasets. It constructs a predictive model by combining different models as illustrated in 
 <xref ref-type="fig" rid="pone.0207777.g001">Fig 1</xref>. In this work, we randomly selected 80% samples containing each type from the original dataset 
 <italic>X</italic>
 <sub>
  <italic>m</italic>×
  <italic>n</italic>
 </sub>, which contained 
 <italic>m</italic> samples and 
 <italic>n</italic> features. The rest 20% data was used to test on the stacking model. The parameter 
 <italic>n</italic> would change in the training dataset 
 <italic>X</italic>
 <sub>
  <italic>m</italic>×
  <italic>n</italic>
 </sub> according to different feature vectors. At level 1, different classifiers were applied on 
 <italic>X</italic>
 <sub>
  <italic>m</italic>×
  <italic>n</italic>
 </sub> and tested on the testing data of each type to select the best algorithms as base classifiers in term of their prediction performance. Correspondingly, logistic regression, naïve bayes and neural network were selected to construct the models at level 2 in terms of the better performance on single models. In addition, random forest and gradient boosting were added to construct the models at level 2. These models at level 2 can provide predictions for the outcome of all data, which were then casted into the second level of training data presented as 
 <italic>X</italic>
 <sub>
  <italic>m</italic>×
  <italic>M</italic>
 </sub>. The parameter 
 <italic>M</italic> stands for the number of new features of the dataset. The model at level 3 was constructed by logistic regression classifier, trained and tested on 
 <italic>X</italic>
 <sub>
  <italic>m</italic>×
  <italic>M</italic>
 </sub> to produce the final outcomes of the predictions of antigenic variants. The performance of the stacking model will be compared with the base classifiers. Meanwhile, to study the influence of data bias of different types on the stacking model, we also investigated the stacking model with the model built on balanced datasets. We set 74, the number of Type VI samples, as benchmark number and randomly selected balanced samples from other types. Totally, 370 samples were extracted as new training and testing dataset to predict antigenic relationship between strains. The performance of stacking model with all datasets and balanced datasets was compared to investigate the influence of imbalanced dataset distribution for prediction. Furthermore, ROC (Receiver Operating Characteristic) curve was plotted by the stacking model constructed above to validate its strengthen and stability.
</p>
