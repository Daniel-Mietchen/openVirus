<?xml version="1.0" encoding="UTF-8"?>
<p>In this study, we measured antigenic diversity as follows: Let 
 <inline-formula>
  <math id="inf115">
   <msub>
    <mi>S</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
  </math>
 </inline-formula> be the set of amino acid sequences for the 
 <inline-formula>
  <math id="inf116">
   <msup>
    <mi>i</mi>
    <mrow>
     <mi>t</mi>
     <mo>⁢</mo>
     <mi>h</mi>
    </mrow>
   </msup>
  </math>
 </inline-formula> protein (one of HA, NA, M1, or M2), collected in year 
 <inline-formula>
  <math id="inf117">
   <mi>t</mi>
  </math>
 </inline-formula> (
 <inline-formula>
  <math id="inf118">
   <mi>t</mi>
  </math>
 </inline-formula> ranging between 2003 and 2011), in state 
 <inline-formula>
  <math id="inf119">
   <mi>x</mi>
  </math>
 </inline-formula> of the continental US. The temporal resolution of the sequence data is thus set to years instead of weeks, and the spatial resolution to states instead of counties. These resolutions are coarse compared to our EHR data on infection incidences, and is set in this manner to maintain sufficient statistical power. For each such set of amino acid sequences 
 <inline-formula>
  <math id="inf120">
   <msub>
    <mi>S</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>t</mi>
    </mrow>
   </msub>
  </math>
 </inline-formula>, we compute the set 
 <inline-formula>
  <math id="inf121">
   <mrow>
    <mi>D</mi>
    <mo>⁢</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>S</mi>
      <mrow>
       <mi>i</mi>
       <mo>,</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>t</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </math>
 </inline-formula> of pairwise edit distances:
 <disp-formula id="equ3">
  <label>(3)</label>
  <math id="m3">
   <mstyle displaystyle="true" scriptlevel="0">
    <mrow>
     <mstyle displaystyle="true" scriptlevel="0">
      <mi>D</mi>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>S</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>t</mi>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
      <mo>=</mo>
      <mo fence="false" stretchy="false">{</mo>
      <mi>y</mi>
      <mo>:</mo>
      <mi>y</mi>
      <mo>=</mo>
      <mrow>
       <mi mathvariant="script">ℒ</mi>
      </mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>s</mi>
       <mrow>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>s</mi>
       <mrow>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
      <mo>,</mo>
      <msub>
       <mi>s</mi>
       <mrow>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>s</mi>
       <mrow>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo>∈</mo>
      <msub>
       <mi>S</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>x</mi>
        <mo>,</mo>
        <mi>t</mi>
       </mrow>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>s</mi>
       <mrow>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>≠</mo>
      <msub>
       <mi>s</mi>
       <mrow>
        <mn>2</mn>
       </mrow>
      </msub>
      <mo fence="false" stretchy="false">}</mo>
     </mstyle>
    </mrow>
   </mstyle>
  </math>
 </disp-formula>where 
 <inline-formula>
  <math id="inf122">
   <mrow>
    <mi class="ltx_font_mathcaligraphic">ℒ</mi>
    <mo>⁢</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>s</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </math>
 </inline-formula> is the standard edit distance (also known as the Levenshtein distance) between the sequences 
 <inline-formula>
  <math id="inf123">
   <mrow>
    <msub>
     <mi>s</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>s</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </math>
 </inline-formula>. Mathematically, the Levenshtein distance between two strings 
 <inline-formula>
  <math id="inf124">
   <mrow>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
   </mrow>
  </math>
 </inline-formula> (of length 
 <inline-formula>
  <math id="inf125">
   <mrow>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>a</mi>
     <mo stretchy="false">|</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mo stretchy="false">|</mo>
     <mi>b</mi>
     <mo stretchy="false">|</mo>
    </mrow>
   </mrow>
  </math>
 </inline-formula> respectively) is given by:
 <disp-formula id="equ4">
  <label>(4)</label>
  <math id="m4">
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">ℒ</mi>
     <mo>⁢</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo>,</mo>
      <mi>b</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mo>lev</mo>
       <mrow>
        <mi>a</mi>
        <mo>,</mo>
        <mi>b</mi>
       </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>a</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>b</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mtext>where </mtext>
    </mrow>
   </mrow>
  </math>
 </disp-formula>
 <disp-formula id="equ5">
  <label>(5)</label>
  <math id="m5">
   <mrow>
    <mrow>
     <msub>
      <mo>lev</mo>
      <mrow>
       <mi>a</mi>
       <mo>,</mo>
       <mi>b</mi>
      </mrow>
     </msub>
     <mo>⁡</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>{</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="left">
        <mrow>
         <mi>max</mi>
         <mo>⁡</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>i</mi>
          <mo>,</mo>
          <mi>j</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="left">
        <mrow>
         <mrow>
          <mrow>
           <mtext>if</mtext>
           <mo>⁢</mo>
           <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>i</mi>
             <mo>,</mo>
             <mi>j</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo>=</mo>
          <mn>0</mn>
         </mrow>
         <mo>,</mo>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="left">
        <mrow>
         <mi>min</mi>
         <mo>⁡</mo>
         <mrow>
          <mo>{</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="left">
             <mrow>
              <mrow>
               <msub>
                <mo>lev</mo>
                <mrow>
                 <mi>a</mi>
                 <mo>,</mo>
                 <mi>b</mi>
                </mrow>
               </msub>
               <mo>⁡</mo>
               <mrow>
                <mo stretchy="false">(</mo>
                <mrow>
                 <mi>i</mi>
                 <mo>-</mo>
                 <mn>1</mn>
                </mrow>
                <mo>,</mo>
                <mi>j</mi>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
              <mo>+</mo>
              <mn>1</mn>
             </mrow>
            </mtd>
            <mtd/>
           </mtr>
           <mtr>
            <mtd columnalign="left">
             <mrow>
              <mrow>
               <msub>
                <mo>lev</mo>
                <mrow>
                 <mi>a</mi>
                 <mo>,</mo>
                 <mi>b</mi>
                </mrow>
               </msub>
               <mo>⁡</mo>
               <mrow>
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo>,</mo>
                <mrow>
                 <mi>j</mi>
                 <mo>-</mo>
                 <mn>1</mn>
                </mrow>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
              <mo>+</mo>
              <mn>1</mn>
             </mrow>
            </mtd>
            <mtd/>
           </mtr>
           <mtr>
            <mtd columnalign="left">
             <mrow>
              <mrow>
               <msub>
                <mo>lev</mo>
                <mrow>
                 <mi>a</mi>
                 <mo>,</mo>
                 <mi>b</mi>
                </mrow>
               </msub>
               <mo>⁡</mo>
               <mrow>
                <mo stretchy="false">(</mo>
                <mrow>
                 <mi>i</mi>
                 <mo>-</mo>
                 <mn>1</mn>
                </mrow>
                <mo>,</mo>
                <mrow>
                 <mi>j</mi>
                 <mo>-</mo>
                 <mn>1</mn>
                </mrow>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
              <mo>+</mo>
              <msub>
               <mn>1</mn>
               <mrow>
                <mo stretchy="false">(</mo>
                <msub>
                 <mi>a</mi>
                 <mi>i</mi>
                </msub>
                <mo>≠</mo>
                <msub>
                 <mi>b</mi>
                 <mi>j</mi>
                </msub>
                <mo stretchy="false">)</mo>
               </mrow>
              </msub>
             </mrow>
            </mtd>
            <mtd/>
           </mtr>
          </mtable>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="left">
        <mtext>otherwise.</mtext>
       </mtd>
      </mtr>
     </mtable>
    </mrow>
   </mrow>
  </math>
 </disp-formula>where 
 <inline-formula>
  <math id="inf126">
   <msub>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>a</mi>
      <mi>i</mi>
     </msub>
     <mo>≠</mo>
     <msub>
      <mi>b</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </msub>
  </math>
 </inline-formula> is the indicator function equal to 0 when 
 <inline-formula>
  <math id="inf127">
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>b</mi>
     <mi>j</mi>
    </msub>
   </mrow>
  </math>
 </inline-formula> and equal to one otherwise, and 
 <inline-formula>
  <math id="inf128">
   <mrow>
    <msub>
     <mo>lev</mo>
     <mrow>
      <mi>a</mi>
      <mo>,</mo>
      <mi>b</mi>
     </mrow>
    </msub>
    <mo>⁡</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </math>
 </inline-formula> is the distance between the first 
 <inline-formula>
  <math id="inf129">
   <mi>i</mi>
  </math>
 </inline-formula> characters of 
 <inline-formula>
  <math id="inf130">
   <mi>a</mi>
  </math>
 </inline-formula> and the first 
 <inline-formula>
  <math id="inf131">
   <mi>j</mi>
  </math>
 </inline-formula> characters of 
 <inline-formula>
  <math id="inf132">
   <mi>b</mi>
  </math>
 </inline-formula>.
</p>
