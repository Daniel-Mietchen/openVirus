<?xml version="1.0" encoding="UTF-8"?>
<p>To demonstrate how our method can be used for prediction, let 
 <italic>Z</italic> denote the quantity that we wish to predict (e.g. the number of diagnoses during the subsequent week) and 
 <inline-formula id="pcbi.1005257.e031">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e031.jpg" id="pcbi.1005257.e031g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M31">
    <mrow>
     <mi mathvariant="script">P</mi>
     <mo>(</mo>
     <mi>Z</mi>
     <mo>|</mo>
     <msub>
      <mi>ν</mi>
      <mi>i</mi>
     </msub>
     <mo>;</mo>
     <mi>θ</mi>
     <mo>)</mo>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> denote the probability density function of the random variable 
 <italic>Z</italic> if the epidemic is at state 
 <italic>ν</italic>
 <sub>
  <italic>i</italic>
 </sub> ∈ 
 <italic>Ω</italic>
 <sub>
  <italic>i</italic>
 </sub> at time 
 <italic>t</italic>
 <sub>
  <italic>i</italic>
 </sub> and the epidemic parameters have value 
 <italic>θ</italic> ∈ Θ. Now, the probability distribution of the random variable 
 <italic>Z</italic> given the accumulated observations at time 
 <italic>t</italic>
 <sub>
  <italic>i</italic>
 </sub>, 
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub> = (
 <italic>y</italic>
 <sub>1</sub>, 
 <italic>y</italic>
 <sub>2</sub>, …, 
 <italic>y</italic>
 <sub>
  <italic>i</italic>
 </sub>), can be calculated as: 
 <disp-formula id="pcbi.1005257.e032">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e032.jpg" id="pcbi.1005257.e032g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M32">
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo>(</mo>
      <mi>Z</mi>
      <mo>|</mo>
      <msub>
       <mi>Y</mi>
       <mi>i</mi>
      </msub>
      <mo>)</mo>
     </mrow>
     <mo>=</mo>
     <msub>
      <mo>∫</mo>
      <mrow>
       <mi>θ</mi>
       <mo>∈</mo>
       <mo>Θ</mo>
      </mrow>
     </msub>
     <msub>
      <mo>∫</mo>
      <mrow>
       <msub>
        <mi>ν</mi>
        <mi>i</mi>
       </msub>
       <mo>∈</mo>
       <msub>
        <mo>Ω</mo>
        <mi>i</mi>
       </msub>
      </mrow>
     </msub>
     <mi>P</mi>
     <mrow>
      <mo>(</mo>
      <mi>Z</mi>
      <mo>|</mo>
      <msub>
       <mi>ν</mi>
       <mi>i</mi>
      </msub>
      <mo>;</mo>
      <mi>θ</mi>
      <mo>)</mo>
     </mrow>
     <mspace width="4pt"/>
     <mo>Π</mo>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>ν</mi>
       <mi>i</mi>
      </msub>
      <mo>|</mo>
      <msub>
       <mi>Y</mi>
       <mi>i</mi>
      </msub>
      <mo>;</mo>
      <mi>θ</mi>
      <mo>)</mo>
     </mrow>
     <mspace width="4pt"/>
     <msub>
      <mi>π</mi>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo>(</mo>
      <mi>θ</mi>
      <mo>|</mo>
      <msub>
       <mi>Y</mi>
       <mi>i</mi>
      </msub>
      <mo>)</mo>
     </mrow>
     <mspace width="4pt"/>
     <mi>d</mi>
     <msub>
      <mi>ν</mi>
      <mi>i</mi>
     </msub>
     <mspace width="4pt"/>
     <mi>d</mi>
     <mi>θ</mi>
     <mo>.</mo>
    </mrow>
   </math>
  </alternatives>
  <label>(9)</label>
 </disp-formula> In 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e032">Eq (9)</xref>, the belief state Π(⋅|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>; 
 <italic>θ</italic>) and the parameter posterior distribution 
 <italic>π</italic>
 <sub>
  <italic>i</italic>
 </sub>(⋅|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>) are both obtained from the algorithm described in 
 <xref ref-type="fig" rid="pcbi.1005257.g002">Fig 2</xref>. To calculate the distribution of the random variable 
 <italic>Z</italic>|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>, we assume that we have access to a stochastic simulation model to sample from the random variable 
 <italic>Z</italic>|
 <italic>ν</italic>
 <sub>
  <italic>i</italic>
 </sub> for a given set of parameter values 
 <italic>θ</italic>. For the numerical results presented here, we use the Gillespie algorithm [
 <xref rid="pcbi.1005257.ref040" ref-type="bibr">40</xref>] (see SI document) to generate realizations for 
 <italic>Z</italic>|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub> that can be used to estimate the probability function 
 <italic>P</italic>(
 <italic>Z</italic>|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>) in 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e032">Eq (9)</xref>, or to calculate mean or other moments of the random variable 
 <italic>Z</italic>|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>.
</p>
