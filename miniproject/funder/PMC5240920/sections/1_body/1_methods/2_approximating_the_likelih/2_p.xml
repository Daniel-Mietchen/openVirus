<?xml version="1.0" encoding="UTF-8"?>
<p>Let Π(⋅|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>) denote the belief state at time 
 <italic>t</italic>
 <sub>
  <italic>i</italic>
 </sub> given the accumulated observations 
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>. Now by conditioning on the epidemic state at time 
 <italic>t</italic>
 <sub>
  <italic>i</italic>−1
 </sub>, i.e. 
 <italic>ν</italic>
 <sub>
  <italic>i</italic>−1
 </sub>, the probability function 
 <inline-formula id="pcbi.1005257.e005">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e005.jpg" id="pcbi.1005257.e005g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M5">
    <mrow>
     <mi mathvariant="script">P</mi>
     <mo>(</mo>
     <mo>·</mo>
     <mo>|</mo>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mo>…</mo>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>;</mo>
     <mi>θ</mi>
     <mo>)</mo>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> in 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e001">Eq (1)</xref> can be calculated as: 
 <disp-formula id="pcbi.1005257.e006">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e006.jpg" id="pcbi.1005257.e006g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M6">
    <mrow>
     <mi mathvariant="script">P</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo>|</mo>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mo>…</mo>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>;</mo>
      <mi>θ</mi>
      <mo>)</mo>
     </mrow>
     <mo>=</mo>
     <munder>
      <mo>∑</mo>
      <mrow>
       <msub>
        <mi>ν</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>∈</mo>
       <msub>
        <mo>Ω</mo>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
     </munder>
     <mi>P</mi>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo>|</mo>
      <msub>
       <mi>ν</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>;</mo>
      <mi>θ</mi>
      <mo>)</mo>
     </mrow>
     <mspace width="4pt"/>
     <mo>Π</mo>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>ν</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>|</mo>
      <msub>
       <mi>y</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mo>…</mo>
      <mo>,</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>;</mo>
      <mi>θ</mi>
      <mo>)</mo>
     </mrow>
     <mo>,</mo>
    </mrow>
   </math>
  </alternatives>
  <label>(2)</label>
 </disp-formula> where 
 <italic>Ω</italic>
 <sub>
  <italic>i</italic>−1
 </sub> is the set of feasible epidemic states (i.e. the support of the belief state Π) at time 
 <italic>t</italic>
 <sub>
  <italic>i</italic>−1
 </sub>. By conditioning on the state of the epidemic at time 
 <italic>t</italic>
 <sub>
  <italic>i</italic>
 </sub>, the probability function 
 <inline-formula id="pcbi.1005257.e007">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e007.jpg" id="pcbi.1005257.e007g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M7">
    <mrow>
     <mi mathvariant="script">P</mi>
     <mo>(</mo>
     <mo>·</mo>
     <mo>|</mo>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mo>…</mo>
     <mo>,</mo>
     <msub>
      <mi>y</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>;</mo>
     <mi>θ</mi>
     <mo>)</mo>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> in 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e006">Eq (2)</xref> can be calculated as: 
 <disp-formula id="pcbi.1005257.e008">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e008.jpg" id="pcbi.1005257.e008g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M8">
    <mtable displaystyle="true">
     <mtr>
      <mtd/>
      <mtd columnalign="left">
       <mrow>
        <mi mathvariant="script">P</mi>
        <mo>(</mo>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
        <mo>|</mo>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mn>2</mn>
        </msub>
        <mo>,</mo>
        <mo>…</mo>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mrow>
          <mi>i</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo>;</mo>
        <mi>θ</mi>
        <mo>)</mo>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd/>
      <mtd columnalign="left">
       <mrow>
        <mspace width="28.45274pt"/>
        <mo>=</mo>
        <munder>
         <mo>∑</mo>
         <mrow>
          <msub>
           <mi>ν</mi>
           <mi>i</mi>
          </msub>
          <mo>∈</mo>
          <msub>
           <mo>Ω</mo>
           <mi>i</mi>
          </msub>
         </mrow>
        </munder>
        <mspace width="4pt"/>
        <munder>
         <mo>∑</mo>
         <mrow>
          <msub>
           <mi>ν</mi>
           <mrow>
            <mi>i</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mo>∈</mo>
          <msub>
           <mo>Ω</mo>
           <mrow>
            <mi>i</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
         </mrow>
        </munder>
        <mi>P</mi>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>y</mi>
          <mi>i</mi>
         </msub>
         <mo>|</mo>
         <msub>
          <mi>ν</mi>
          <mi>i</mi>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>ν</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>;</mo>
         <mi>θ</mi>
         <mo>)</mo>
        </mrow>
        <mi>p</mi>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>ν</mi>
          <mi>i</mi>
         </msub>
         <mo>|</mo>
         <msub>
          <mi>ν</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>;</mo>
         <mi>θ</mi>
         <mo>)</mo>
        </mrow>
        <mspace width="4pt"/>
        <mo>Π</mo>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>ν</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>|</mo>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
         <mo>,</mo>
         <mo>…</mo>
         <mo>,</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>;</mo>
         <mi>θ</mi>
         <mo>)</mo>
        </mrow>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </math>
  </alternatives>
  <label>(3)</label>
 </disp-formula> Calculating the probability function 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e008">(3)</xref> can be computationally difficult. First, it requires calculating or approximating the transition probability 
 <italic>p</italic>(
 <italic>ν</italic>
 <sub>
  <italic>i</italic>
 </sub>|
 <italic>ν</italic>
 <sub>
  <italic>i</italic>−1
 </sub>; 
 <italic>θ</italic>) for each pair (
 <italic>ν</italic>
 <sub>
  <italic>i</italic>
 </sub>, 
 <italic>ν</italic>
 <sub>
  <italic>i</italic>−1
 </sub>) ∈ 
 <italic>Ω</italic>
 <sub>
  <italic>i</italic>
 </sub> × 
 <italic>Ω</italic>
 <sub>
  <italic>i</italic>−1
 </sub>, and second, it involves enumeration over the set 
 <italic>Ω</italic>
 <sub>
  <italic>i</italic>
 </sub> × 
 <italic>Ω</italic>
 <sub>
  <italic>i</italic>−1
 </sub>, which can be prohibitively large even for simple epidemic models. One way to simplify the computational complexity of 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e008">Eq (3)</xref> is to represent the belief state Π(⋅|
 <italic>Y</italic>
 <sub>
  <italic>i</italic>
 </sub>) as a step function that takes 1 for the most probable state (denoted by 
 <inline-formula id="pcbi.1005257.e009">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e009.jpg" id="pcbi.1005257.e009g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M9">
    <mover accent="true">
     <mi>ν</mi>
     <mo>^</mo>
    </mover>
   </math>
  </alternatives>
 </inline-formula>) and 0 elsewhere. This allows us to approximate the function 
 <inline-formula id="pcbi.1005257.e010">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e010.jpg" id="pcbi.1005257.e010g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M10">
    <mrow>
     <mi mathvariant="script">P</mi>
     <mo>(</mo>
     <mo>·</mo>
     <mo>)</mo>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> in 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e008">Eq (3)</xref> with: 
 <disp-formula id="pcbi.1005257.e011">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e011.jpg" id="pcbi.1005257.e011g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M11">
    <mtable displaystyle="true">
     <mtr>
      <mtd>
       <mrow>
        <mover accent="true">
         <mi mathvariant="script">P</mi>
         <mo>˜</mo>
        </mover>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>y</mi>
          <mi>i</mi>
         </msub>
         <mo>|</mo>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
         <mo>,</mo>
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
         <mo>,</mo>
         <mo>…</mo>
         <mo>,</mo>
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>;</mo>
         <mi>θ</mi>
         <mo>)</mo>
        </mrow>
        <mo>=</mo>
        <munder>
         <mo>∑</mo>
         <mrow>
          <msub>
           <mi>ν</mi>
           <mi>i</mi>
          </msub>
          <mo>∈</mo>
          <msub>
           <mo>Ω</mo>
           <mi>i</mi>
          </msub>
         </mrow>
        </munder>
        <mspace width="4pt"/>
        <mi>P</mi>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>y</mi>
          <mi>i</mi>
         </msub>
         <mo>|</mo>
         <msub>
          <mi>ν</mi>
          <mi>i</mi>
         </msub>
         <mo>,</mo>
         <msub>
          <mover accent="true">
           <mi>ν</mi>
           <mo>^</mo>
          </mover>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>;</mo>
         <mi>θ</mi>
         <mo>)</mo>
        </mrow>
        <mi>p</mi>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>ν</mi>
          <mi>i</mi>
         </msub>
         <mo>|</mo>
         <msub>
          <mover accent="true">
           <mi>ν</mi>
           <mo>^</mo>
          </mover>
          <mrow>
           <mi>i</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>;</mo>
         <mi>θ</mi>
         <mo>)</mo>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </math>
  </alternatives>
  <label>(4)</label>
 </disp-formula> where 
 <inline-formula id="pcbi.1005257.e012">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e012.jpg" id="pcbi.1005257.e012g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M12">
    <msub>
     <mover accent="true">
      <mi>ν</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mi>i</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </math>
  </alternatives>
 </inline-formula> represents the most likely epidemic state given observations 
 <italic>Y</italic>
 <sub>
  <italic>i</italic>−1
 </sub> = (
 <italic>y</italic>
 <sub>1</sub>, 
 <italic>y</italic>
 <sub>2</sub>, …, 
 <italic>y</italic>
 <sub>
  <italic>i</italic>−1
 </sub>). By the definition of epidemic states, the transition from state 
 <italic>ν</italic>
 <sub>
  <italic>i</italic>−1
 </sub> to 
 <italic>ν</italic>
 <sub>
  <italic>i</italic>
 </sub> generates a unique set of observations, and it is trivial to find whether the state transition 
 <inline-formula id="pcbi.1005257.e013">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e013.jpg" id="pcbi.1005257.e013g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M13">
    <msub>
     <mover accent="true">
      <mi>ν</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mi>i</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </math>
  </alternatives>
 </inline-formula> to 
 <italic>ν</italic>
 <sub>
  <italic>i</italic>
 </sub> can generate the observation 
 <italic>y</italic>
 <sub>
  <italic>i</italic>
 </sub> (see design of performance analysis for an illustrative example). Therefore, for a given observation 
 <italic>y</italic>
 <sub>
  <italic>i</italic>
 </sub>, the probability 
 <inline-formula id="pcbi.1005257.e014">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e014.jpg" id="pcbi.1005257.e014g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M14">
    <mrow>
     <mi>P</mi>
     <mo>(</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo>|</mo>
     <msub>
      <mi>ν</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mover accent="true">
       <mi>ν</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>;</mo>
     <mi>θ</mi>
     <mo>)</mo>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> in 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e011">Eq (4)</xref> is equal to 1 if the transition from state 
 <inline-formula id="pcbi.1005257.e015">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e015.jpg" id="pcbi.1005257.e015g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M15">
    <msub>
     <mover accent="true">
      <mi>ν</mi>
      <mo>^</mo>
     </mover>
     <mrow>
      <mi>i</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </math>
  </alternatives>
 </inline-formula> to 
 <italic>ν</italic>
 <sub>
  <italic>i</italic>
 </sub> results in observing 
 <italic>y</italic>
 <sub>
  <italic>i</italic>
 </sub>, and is zero otherwise. To calculate 
 <inline-formula id="pcbi.1005257.e016">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e016.jpg" id="pcbi.1005257.e016g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M16">
    <mrow>
     <mover accent="true">
      <mi mathvariant="script">P</mi>
      <mo>˜</mo>
     </mover>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo>|</mo>
      <msub>
       <mover accent="true">
        <mi>ν</mi>
        <mo>^</mo>
       </mover>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>;</mo>
      <mi>θ</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> in 
 <xref ref-type="disp-formula" rid="pcbi.1005257.e011">Eq (4)</xref>, it only remains to identify the state transition probability function 
 <inline-formula id="pcbi.1005257.e017">
  <alternatives>
   <graphic xlink:href="pcbi.1005257.e017.jpg" id="pcbi.1005257.e017g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M17">
    <mrow>
     <mi>p</mi>
     <mo>(</mo>
     <msub>
      <mi>ν</mi>
      <mi>i</mi>
     </msub>
     <mo>|</mo>
     <msub>
      <mover accent="true">
       <mi>ν</mi>
       <mo>^</mo>
      </mover>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo>;</mo>
     <mi>θ</mi>
     <mo>)</mo>
    </mrow>
   </math>
  </alternatives>
 </inline-formula> and a state estimation scheme. In the next subsections, we propose an algorithm to achieve this.
</p>
