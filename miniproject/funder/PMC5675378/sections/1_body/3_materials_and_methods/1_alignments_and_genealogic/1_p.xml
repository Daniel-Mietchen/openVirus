<?xml version="1.0" encoding="UTF-8"?>
<p>A sample of HA and NA sequences is obtained by downloading all the available A/H3N2 human strains in the EpiFlu DATABASE (
 <ext-link ext-link-type="uri" xlink:href="http://www.gisaid.org" xmlns:xlink="http://www.w3.org/1999/xlink">http://www.gisaid.org</ext-link>), regardless the geographical region, which were collected between January 1968 and October 2015. Only the strains with complete HA and NA sequences are taken into consideration. Acknowledgements for sequences used in this study are available in 
 <xref ref-type="supplementary-material" rid="ppat.1006685.s008">S1 File</xref>. From this sample, alignments of single segments are created year by year using BLAST [
 <xref rid="ppat.1006685.ref048" ref-type="bibr">48</xref>]. After discarding the segments with more than three gaps, a first run of RAxML [
 <xref rid="ppat.1006685.ref049" ref-type="bibr">49</xref>] is performed to reconstruct the genealogy for each segment and detect clear outliers sequences (i.e. sequences that are found clearly isolated from the rest of the tree and which were likely misreported) to be excluded from the subsequent analysis. We then obtain alignments of linked HA-NA segment pairs and construct maximum-likelihood two-segment genealogies by RAxML, choosing the best-scoring ML tree out of 10 RAxML runs. Potential ambiguities in the definition of the nucleotide at a certain site in a strain are resolved by assigning the orthologous nucleotide of the closest ancestral node with an unambiguous sequence. The subsequent reassortment inference is performed on trees of subsampled data with a maximum of 600 sequences per year. This step reduces computational time and avoids over-representation of recent viruses, which are the most abundant in the database. We note that these joint genealogies differ from single-segment phylogenetic trees, because the underlying process of reassortment violates the tree topology.
</p>
