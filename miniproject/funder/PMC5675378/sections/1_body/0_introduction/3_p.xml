<?xml version="1.0" encoding="UTF-8"?>
<p>In this paper, we infer a comprehensive map of intra-lineage reassortment between the surface proteins HA and NA of influenza A/H3N2, and we provide evidence that most of these events are under negative selection increasing with distance between parental strains. An important methodological basis for our analysis is a faithful inference of intra-subtype reassortment events from sequence data. Although these dynamics have long been recognized as a potentially important mechanism for evolution [
 <xref rid="ppat.1006685.ref025" ref-type="bibr">25</xref>, 
 <xref rid="ppat.1006685.ref026" ref-type="bibr">26</xref>], the detection of events within the same subtype is notoriously difficult due to their weak phylogenetic signal. There is a number of current methods to infer reassortment events from a data set of viral sequences. These methods can be roughly divided into two groups: distance-based methods [
 <xref rid="ppat.1006685.ref027" ref-type="bibr">27</xref>, 
 <xref rid="ppat.1006685.ref028" ref-type="bibr">28</xref>] and methods based on the phylogeny [
 <xref rid="ppat.1006685.ref013" ref-type="bibr">13</xref>, 
 <xref rid="ppat.1006685.ref026" ref-type="bibr">26</xref>, 
 <xref rid="ppat.1006685.ref029" ref-type="bibr">29</xref>–
 <xref rid="ppat.1006685.ref035" ref-type="bibr">35</xref>]. As recently pointed out [
 <xref rid="ppat.1006685.ref036" ref-type="bibr">36</xref>], these approaches coherently report some fraction of the reassortment events but show a substantial degree of discrepancy between their results, which can be traced to method-specific differences in sensitivity. Distance-based methods rely on the assumption that, for reassortant strains, high similarity between the sequences of one segment goes along with large differences in the other segment. These methods do not pass through the step of inferring the phylogeny of the virus. They are fast, can be efficiently applied to large alignments, and are insensitive to errors in tree reconstruction. Without a viral phylogeny, however, it can be hard to determine if two or more inferred events are independent. Hence, distance-based methods can generate multiple representations of the same original event between unobserved ancestral strains. Resolving false positives constitutes a major issue for this kind of algorithms. Phylogenetic methods, on the other hand, are based on the observation that reassortant strains are located in different clades of the coalescent trees built for different segments. These approaches are usually successful in detecting reassortment across different lineages of the virus, i.e., between strains with substantial genetic differences. The incompatibility between tree topologies, however, can also be a result of phylogenetic errors, so that inconsistencies in the evolutionary histories of different segments are a necessary but not sufficient condition for reassortment. Successful attempts to overcome this issue [
 <xref rid="ppat.1006685.ref033" ref-type="bibr">33</xref>] have produced algorithms which are applicable only to small datasets. Since the scaling of the number of inferred events with sample sizes has not been investigated, it is not clear if the rate of reassortment is independent on the size of the trees. Hence, even if the gain in information coming from the phylogenetic trees constitutes an advantage over the distance-based algorithms, the limited resolution constrains these methods in the detection of intra-lineage events [
 <xref rid="ppat.1006685.ref008" ref-type="bibr">8</xref>]. In order to fill this methodological gap, we propose a new genealogical inference method for reassortment in fast-evolving populations with segmented genomes, such as influenza virus. We analyze the mutations arising in joint genealogies built from pairs of segments and set a simple criterion to identify reassortment events. An important part of our method is the exclusion of false positive events generated by ambiguities in tree reconstruction, which can be estimated from a statistical null model of non-reassorting sequences. In order to reduce the list of putative reassortments to a minimal set of independent events, we include internal inferred nodes as possible candidates for reassortment and cluster events with similar patterns of mutations. The overall number of reassortment events reported by our method turns out to be in broad agreement with the results of previous studies [
 <xref rid="ppat.1006685.ref037" ref-type="bibr">37</xref>–
 <xref rid="ppat.1006685.ref039" ref-type="bibr">39</xref>]. Furthermore, we have extensively tested our method on simulated data for evolving influenza-like strain populations under mutations, genetic drift, selection, and reassortment. We find that a large fraction of the simulated reassortment events are recovered by our algorithm, and these events outweigh the rate of false positives.
</p>
