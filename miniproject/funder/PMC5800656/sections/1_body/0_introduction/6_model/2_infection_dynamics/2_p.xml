<?xml version="1.0" encoding="UTF-8"?>
<p>To consider the evolution of virus trait value 
 <italic>G</italic>, we use invasion analysis which examines whether a mutant strain can increase or not when it arises at a resident equilibrium. We can obtain analytical expressions of the resident’s equilibrium densities for a given value of 
 <italic>G</italic> from implicit relationship (A6)-(A8) in Appendix A. A resident equilibrium exists as long as the parameters satisfy the endemic condition that is obtained in the next section. At the resident equilibrium, mutants (denoted by subscript 
 <italic>J</italic>) with proportion of global infection is 
 <italic>G</italic>′, are introduced with a small initial frequency. In the full dynamics of residents (with 
 <italic>G</italic>) and mutants (with 
 <italic>G</italic>′), there are ten possible pair densities but we only have to consider seven pairs due to the three constraints, Eq (
 <xref ref-type="disp-formula" rid="pcbi.1005952.e002">2</xref>) and 
 <italic>x</italic>
 <sub>
  <italic>S</italic>
 </sub> + 
 <italic>x</italic>
 <sub>
  <italic>I</italic>
 </sub> + 
 <italic>x</italic>
 <sub>
  <italic>O</italic>
 </sub> = 1. The dynamics are obtained by adding four more equations to the Eq (
 <xref ref-type="disp-formula" rid="pcbi.1005952.e010">4</xref>): 
 <disp-formula id="pcbi.1005952.e013">
  <alternatives>
   <graphic xlink:href="pcbi.1005952.e013.jpg" id="pcbi.1005952.e013g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M13">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>x</mi>
       </mrow>
       <mrow>
        <mi>I</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>{</mo>
     <mi>g</mi>
     <msub>
      <mrow>
       <mi>x</mi>
      </mrow>
      <mrow>
       <mi>S</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>l</mi>
      <mo>+</mo>
      <mi>ψ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
     <mfrac>
      <mrow>
       <msub>
        <mrow>
         <mi>p</mi>
        </mrow>
        <mrow>
         <mi>S</mi>
         <mi>I</mi>
        </mrow>
       </msub>
      </mrow>
      <mrow>
       <msub>
        <mrow>
         <mi>x</mi>
        </mrow>
        <mrow>
         <mi>I</mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac>
     <mo>−</mo>
     <mi>α</mi>
     <mo>}</mo>
    </mrow>
    <msub>
     <mrow>
      <mi>x</mi>
     </mrow>
     <mrow>
      <mi>I</mi>
     </mrow>
    </msub>
    <mo>,</mo>
   </math>
  </alternatives>
  <label>(5a)</label>
 </disp-formula>
 <disp-formula id="pcbi.1005952.e014">
  <alternatives>
   <graphic xlink:href="pcbi.1005952.e014.jpg" id="pcbi.1005952.e014g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M14">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>p</mi>
       </mrow>
       <mrow>
        <mi>S</mi>
        <mi>I</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mrow>
      <mo>−</mo>
      <mo>(</mo>
      <mrow>
       <mi>ϕ</mi>
       <mo>+</mo>
       <mi>ψ</mi>
       <mo>+</mo>
       <mi>α</mi>
      </mrow>
      <mo>)</mo>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>S</mi>
      <mi>I</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mi>ϕ</mi>
    <msub>
     <mrow>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>S</mi>
      <mi>S</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mi>α</mi>
    <mo>(</mo>
    <mrow>
     <msub>
      <mrow>
       <mi>p</mi>
      </mrow>
      <mrow>
       <mi>I</mi>
       <mi>I</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msub>
      <mrow>
       <mi>p</mi>
      </mrow>
      <mrow>
       <mi>I</mi>
       <mi>J</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>)</mo>
    <mo>,</mo>
   </math>
  </alternatives>
  <label>(5b)</label>
 </disp-formula>
 <disp-formula id="pcbi.1005952.e015">
  <alternatives>
   <graphic xlink:href="pcbi.1005952.e015.jpg" id="pcbi.1005952.e015g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M15">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>p</mi>
       </mrow>
       <mrow>
        <mi>I</mi>
        <mi>O</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mrow>
      <mi>ϕ</mi>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>S</mi>
      <mi>O</mi>
     </mrow>
    </msub>
    <mo>−</mo>
    <mi>α</mi>
    <msub>
     <mrow>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>I</mi>
      <mi>O</mi>
     </mrow>
    </msub>
    <mo>.</mo>
   </math>
  </alternatives>
  <label>(5c)</label>
 </disp-formula>
 <disp-formula id="pcbi.1005952.e016">
  <alternatives>
   <graphic xlink:href="pcbi.1005952.e016.jpg" id="pcbi.1005952.e016g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M16">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>x</mi>
       </mrow>
       <mrow>
        <mi>J</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>{</mo>
     <mi>g</mi>
     <mo>′</mo>
     <msub>
      <mrow>
       <mi>x</mi>
      </mrow>
      <mrow>
       <mi>S</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>l</mi>
      <mo>′</mo>
      <mo>+</mo>
      <mi>ψ</mi>
      <mo>′</mo>
     </mrow>
     <mo stretchy="false">)</mo>
     <mfrac>
      <mrow>
       <msub>
        <mrow>
         <mi>p</mi>
        </mrow>
        <mrow>
         <mi>S</mi>
         <mi>J</mi>
        </mrow>
       </msub>
      </mrow>
      <mrow>
       <msub>
        <mrow>
         <mi>x</mi>
        </mrow>
        <mrow>
         <mi>J</mi>
        </mrow>
       </msub>
      </mrow>
     </mfrac>
     <mo>−</mo>
     <mi>α</mi>
     <mo>}</mo>
    </mrow>
    <msub>
     <mrow>
      <mi>x</mi>
     </mrow>
     <mrow>
      <mi>J</mi>
     </mrow>
    </msub>
    <mo>,</mo>
   </math>
  </alternatives>
  <label>(5d)</label>
 </disp-formula>
 <disp-formula id="pcbi.1005952.e017">
  <alternatives>
   <graphic xlink:href="pcbi.1005952.e017.jpg" id="pcbi.1005952.e017g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M17">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>p</mi>
       </mrow>
       <mrow>
        <mi>S</mi>
        <mi>J</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mrow>
      <mo>−</mo>
      <mo>(</mo>
      <mrow>
       <mi>ϕ</mi>
       <mo>+</mo>
       <mi>ϕ</mi>
       <mo>′</mo>
       <mo>+</mo>
       <mi>ψ</mi>
       <mo>′</mo>
       <mo>+</mo>
       <mi>α</mi>
      </mrow>
      <mo>)</mo>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>S</mi>
      <mi>J</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mi>ϕ</mi>
    <mo>′</mo>
    <msub>
     <mrow>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>S</mi>
      <mi>S</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mi>α</mi>
    <mo>(</mo>
    <mrow>
     <msub>
      <mrow>
       <mi>p</mi>
      </mrow>
      <mrow>
       <mi>J</mi>
       <mi>J</mi>
      </mrow>
     </msub>
     <mo>+</mo>
     <msub>
      <mrow>
       <mi>p</mi>
      </mrow>
      <mrow>
       <mi>I</mi>
       <mi>J</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>)</mo>
    <mo>,</mo>
   </math>
  </alternatives>
  <label>(5e)</label>
 </disp-formula>
 <disp-formula id="pcbi.1005952.e018">
  <alternatives>
   <graphic xlink:href="pcbi.1005952.e018.jpg" id="pcbi.1005952.e018g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M18">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>p</mi>
       </mrow>
       <mrow>
        <mi>I</mi>
        <mi>J</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mrow>
      <mi>ϕ</mi>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>S</mi>
      <mi>J</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mi>ϕ</mi>
    <mo>′</mo>
    <msub>
     <mrow>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>S</mi>
      <mi>I</mi>
     </mrow>
    </msub>
    <mo>−</mo>
    <mn>2</mn>
    <mi>α</mi>
    <msub>
     <mrow>
      <mi>p</mi>
     </mrow>
     <mrow>
      <mi>I</mi>
      <mi>J</mi>
     </mrow>
    </msub>
    <mo>,</mo>
   </math>
  </alternatives>
  <label>(5f)</label>
 </disp-formula>
 <disp-formula id="pcbi.1005952.e019">
  <alternatives>
   <graphic xlink:href="pcbi.1005952.e019.jpg" id="pcbi.1005952.e019g" mimetype="image" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
   <math id="M19">
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mrow>
        <mi>p</mi>
       </mrow>
       <mrow>
        <mi>J</mi>
        <mi>J</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mn>2</mn>
    <mrow>
     <mo>{</mo>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>ϕ</mi>
      <mo>′</mo>
      <mo>+</mo>
      <mi>ψ</mi>
      <mo>′</mo>
     </mrow>
     <mo stretchy="false">)</mo>
     <msub>
      <mrow>
       <mi>p</mi>
      </mrow>
      <mrow>
       <mi>S</mi>
       <mi>J</mi>
      </mrow>
     </msub>
     <mo>−</mo>
     <mi>α</mi>
     <msub>
      <mrow>
       <mi>p</mi>
      </mrow>
      <mrow>
       <mi>J</mi>
       <mi>J</mi>
      </mrow>
     </msub>
     <mo>}</mo>
    </mrow>
    <mo>.</mo>
   </math>
  </alternatives>
  <label>(5g)</label>
 </disp-formula> where 
 <italic>g</italic>′, 
 <italic>l</italic>′, and 
 <italic>ψ</italic>′ are as defined before but the definition of 
 <italic>G</italic> is replaced by 
 <italic>G</italic>′, and 
 <italic>ϕ</italic>′ = 
 <italic>g</italic>′
 <italic>x</italic>
 <sub>
  <italic>J</italic>
 </sub> + 
 <italic>l</italic>′
 <italic>p</italic>
 <sub>
  <italic>SJ</italic>
 </sub>/
 <italic>x</italic>
 <sub>
  <italic>S</italic>
 </sub>,. From the dynamics of resident and mutant, the linearized dynamics of a mutant strain around the resident equilibrium are obtained. If the mutant can increase its density, which is judged by inequality (B9) in 
 <xref ref-type="supplementary-material" rid="pcbi.1005952.s001">S1 Text</xref>, we infer that the mutant can invade the resident population. To find an ESS, we assume 101 different possible strains with equally divided 
 <italic>G</italic> values from 
 <italic>G</italic>
 <sub>
  <italic>min</italic>
 </sub> = 0 to 
 <italic>G</italic>
 <sub>
  <italic>max</italic>
 </sub> = 1, and pairwise invasibilities are checked between two neighboring strains. If a strain prevents the invasion by adjacent strains, we regard it as a local ESS.
</p>
