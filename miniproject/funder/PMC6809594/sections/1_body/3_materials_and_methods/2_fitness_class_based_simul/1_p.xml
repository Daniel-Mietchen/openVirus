<?xml version="1.0" encoding="UTF-8"?>
<p>The stability of the RQS and the extinction dynamics is fully captured by the traveling wave 
 <xref ref-type="disp-formula" rid="equ8">Equation (8)</xref>. We simulate the traveling wave by discretizing the fitness space 
 <inline-formula>
  <math id="inf313">
   <mi>x</mi>
  </math>
 </inline-formula> into bins of step size 
 <inline-formula>
  <math id="inf314">
   <mi>s</mi>
  </math>
 </inline-formula> around zero. The number of individuals infected by different strains correspond to integers in each bin 
 <inline-formula>
  <math id="inf315">
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </math>
 </inline-formula>. At each time step, the population in each bin 
 <inline-formula>
  <math id="inf316">
   <msub>
    <mi>I</mi>
    <mi>i</mi>
   </msub>
  </math>
 </inline-formula> updates to a number sampled from the Poisson distribution with parameter 
 <inline-formula>
  <math id="inf317">
   <mrow>
    <msub>
     <mi>λ</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>N</mi>
      <mi>h</mi>
     </msub>
     <mo>⁢</mo>
     <msub>
      <mi>I</mi>
      <mi>i</mi>
     </msub>
     <mo>⁢</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>⁢</mo>
        <mi mathvariant="normal">Δ</mi>
        <mo>⁢</mo>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </math>
 </inline-formula> determined by mean fitness 
 <inline-formula>
  <math id="inf318">
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </math>
 </inline-formula> and a dynamic mean fitness 
 <inline-formula>
  <math id="inf319">
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
  </math>
 </inline-formula>, which increases by 
 <inline-formula>
  <math id="inf320">
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mo>⁢</mo>
    <mi>t</mi>
    <mo>⁢</mo>
    <msub>
     <mi>I</mi>
     <mrow>
      <mi>t</mi>
      <mo>⁢</mo>
      <mi>o</mi>
      <mo>⁢</mo>
      <mi>t</mi>
     </mrow>
    </msub>
   </mrow>
  </math>
 </inline-formula>, where 
 <inline-formula>
  <math id="inf321">
   <msub>
    <mi>I</mi>
    <mrow>
     <mi>t</mi>
     <mo>⁢</mo>
     <mi>o</mi>
     <mo>⁢</mo>
     <mi>t</mi>
    </mrow>
   </msub>
  </math>
 </inline-formula> is the total infected fraction summed over all bins. When 
 <inline-formula>
  <math id="inf322">
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
  </math>
 </inline-formula> becomes larger than one bin size 
 <inline-formula>
  <math id="inf323">
   <mi>s</mi>
  </math>
 </inline-formula>, we shift the all populations to left by one bin and reset 
 <inline-formula>
  <math id="inf324">
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
  </math>
 </inline-formula> to , a trick to keep only a finite number of bins in the simulation. At the same time, antigenic mutation is represented by moving the mutated fraction in each bin to the adjacent bin on the right. The fraction is determined by a random number drawn from the Poisson distribution with the mean 
 <inline-formula>
  <math id="inf325">
   <mrow>
    <mi>m</mi>
    <mo>⁢</mo>
    <msub>
     <mi>I</mi>
     <mi>i</mi>
    </msub>
    <mo>⁢</mo>
    <mi mathvariant="normal">Δ</mi>
    <mo>⁢</mo>
    <mi>t</mi>
   </mrow>
  </math>
 </inline-formula>. The typical ranges of the three parameters 
 <inline-formula>
  <math id="inf326">
   <mi>s</mi>
  </math>
 </inline-formula>, 
 <inline-formula>
  <math id="inf327">
   <mi>m</mi>
  </math>
 </inline-formula>, and 
 <inline-formula>
  <math id="inf328">
   <msub>
    <mi>N</mi>
    <mi>h</mi>
   </msub>
  </math>
 </inline-formula> follow the parameters in the genealogical simulation, as documented also in 
 <xref rid="table1" ref-type="table">Table 1</xref>.
</p>
