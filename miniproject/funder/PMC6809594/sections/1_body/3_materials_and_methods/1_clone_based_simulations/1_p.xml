<?xml version="1.0" encoding="UTF-8"?>
<p>We simulate the original model on a genealogical tree by combining the deterministic update of SIR-type equations and the stochastic step introducing mutated strains. In each time step 
 <inline-formula>
  <math id="inf270">
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mo>⁢</mo>
     <mi>t</mi>
    </mrow>
    <mo>&lt;</mo>
    <mn>1</mn>
   </mrow>
  </math>
 </inline-formula>, we apply the mid-point method to advance SIR equations 
 <xref ref-type="disp-formula" rid="equ1 equ2 equ4">Equations (1,2,4)</xref>. We then generate a random number uniformly sampled between zero and one for each surviving strain with 
 <inline-formula>
  <math id="inf271">
   <mrow>
    <mrow>
     <msub>
      <mi>N</mi>
      <mi>h</mi>
     </msub>
     <mo>⁢</mo>
     <msub>
      <mi>I</mi>
      <mi>a</mi>
     </msub>
    </mrow>
    <mo>≥</mo>
    <mn>1</mn>
   </mrow>
  </math>
 </inline-formula>. If the random number is smaller than 
 <inline-formula>
  <math id="inf272">
   <mrow>
    <mi>m</mi>
    <mo>⁢</mo>
    <msub>
     <mi>N</mi>
     <mi>h</mi>
    </msub>
    <mo>⁢</mo>
    <msub>
     <mi>I</mi>
     <mi>a</mi>
    </msub>
    <mo>⁢</mo>
    <mi mathvariant="normal">Δ</mi>
    <mo>⁢</mo>
    <mi>t</mi>
   </mrow>
  </math>
 </inline-formula> for strain 
 <inline-formula>
  <math id="inf273">
   <mi>a</mi>
  </math>
 </inline-formula>, we append a new strain 
 <inline-formula>
  <math id="inf274">
   <mi>b</mi>
  </math>
 </inline-formula> as a descendent to 
 <inline-formula>
  <math id="inf275">
   <mi>a</mi>
  </math>
 </inline-formula>. The susceptibility to strain 
 <inline-formula>
  <math id="inf276">
   <mi>b</mi>
  </math>
 </inline-formula> is related to susceptibility to strain 
 <inline-formula>
  <math id="inf277">
   <mi>a</mi>
  </math>
 </inline-formula> via 
 <inline-formula>
  <math id="inf278">
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>b</mi>
    </msub>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>S</mi>
       <mi>a</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mi>d</mi>
       </mrow>
      </mrow>
     </msup>
    </msup>
   </mrow>
  </math>
 </inline-formula>. In most of the simulations, the transmissibility of different strains is held constant 
 <inline-formula>
  <math id="inf279">
   <mi>β</mi>
  </math>
 </inline-formula>. Otherwise we allow for a strain specific transmissibility that is to its parent: 
 <inline-formula>
  <math id="inf280">
   <mrow>
    <msub>
     <mi>β</mi>
     <mi>b</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>a</mi>
     </msub>
     <mo>-</mo>
     <mrow>
      <mi>δ</mi>
      <mo>⁢</mo>
      <mi>β</mi>
     </mrow>
    </mrow>
   </mrow>
  </math>
 </inline-formula> with 
 <inline-formula>
  <math id="inf281">
   <mrow>
    <mrow>
     <mi>δ</mi>
     <mo>⁢</mo>
     <mi>β</mi>
    </mrow>
    <mo>&gt;</mo>
    <mn>0</mn>
   </mrow>
  </math>
 </inline-formula> for the deleterious effect of antigenic mutations and 
 <inline-formula>
  <math id="inf282">
   <mrow>
    <msub>
     <mi>β</mi>
     <mi>b</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>β</mi>
     <mi>max</mi>
    </msub>
   </mrow>
  </math>
 </inline-formula> if the mutation is compensatory. The new strain grows deterministically only if 
 <inline-formula>
  <math id="inf283">
   <mrow>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>b</mi>
     </msub>
     <mo>⁢</mo>
     <msub>
      <mi>S</mi>
      <mi>b</mi>
     </msub>
    </mrow>
    <mo>&gt;</mo>
    <mn>1</mn>
   </mrow>
  </math>
 </inline-formula>.
</p>
