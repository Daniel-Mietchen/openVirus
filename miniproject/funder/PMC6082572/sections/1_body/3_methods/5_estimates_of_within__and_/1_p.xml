<?xml version="1.0" encoding="UTF-8"?>
<p>We estimated the within- and between-host evolutionary rates using BEAST [
 <xref rid="ppat.1007167.ref067" ref-type="bibr">67</xref>] by employing a hierarchical phylogenetic model (HPM) [
 <xref rid="ppat.1007167.ref068" ref-type="bibr">68</xref>] and a renaissance counting approach [
 <xref rid="ppat.1007167.ref069" ref-type="bibr">69</xref>]. For the within-host evolutionary analysis, this approach has been shown to yield more precise estimates (e.g. [
 <xref rid="ppat.1007167.ref070" ref-type="bibr">70</xref>]), as it enables information about the evolutionary parameters (e.g. substitution model and molecular clock) to be explicitly shared among the different individual datasets while allowing independent evolutionary histories for each individual. Specifically, renaissance counting is a probabilistic counting method for estimating nonsynonymous and synonymous substitution rates and site-specific dN/dS ratios using codon-partitioned nucleotide substitution models. It is based on a stochastic mapping approach, which infers the changes (or counts) at each site in the alignment across the phylogeny using a continuous-time Markov chain (CTMC) model of nucleotide substitutions, and empirical Bayes modeling to avoid inflated standard errors of the number of substitution counts, namely by excluding counts that are either zero or infinity. Site-specific dN/dS ratios can be estimated by dividing the observed nonsynonymous (cN) and synonymous substitutions (cS) with expected nonsynonymous (uN) and synonymous changes (uS), e.g. dN/dS = (cN/cS)/(uN/uS). As this method is implemented in a Bayesian phylogenetic framework, estimates of nonsynonymous and synonymous substitution rates also take into account phylogenetic uncertainty. Furthermore, it compares well with methods that use codon substitution models, with the advantage that it is more computationally efficient. For our analysis, we first estimated posterior tree distributions for each individual (for both gene regions), using a codon-structured nucleotide substitution model [
 <xref rid="ppat.1007167.ref071" ref-type="bibr">71</xref>], a strict molecular clock, and a constant tree prior, and applied noninformative hierarchical priors on the substitution, clock, and population parameters. These were subsequently used as empirical tree distributions for the renaissance counting analysis, where noninformative hierarchical priors were similarly employed for all evolutionary parameters. To reduce the computational burden of the within-host evolutionary analysis, we used a subsampled dataset for each individual, where 25 sequences per time-point were randomly selected for each gene region. The final dataset comprised of 8100 sequences where each gene-specific individual dataset ranged from 75 to 125 sequences. For the BEAST sensitivity analyses we used the CIPRES Science Gateway [
 <xref rid="ppat.1007167.ref072" ref-type="bibr">72</xref>].
</p>
