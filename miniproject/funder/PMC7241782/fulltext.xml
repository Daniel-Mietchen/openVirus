<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?subarticle pone.0233126.r001?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">7241782</article-id><article-id pub-id-type="publisher-id">PONE-D-19-34966</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0233126</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Infectious Diseases</subject><subj-group><subject>Viral Diseases</subject><subj-group><subject>Influenza</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and Places</subject><subj-group><subject>Geographical Locations</subject><subj-group><subject>Asia</subject><subj-group><subject>Japan</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Information Technology</subject><subj-group><subject>Data Processing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Mathematical and Statistical Techniques</subject><subj-group><subject>Statistical Methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical Methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social Sciences</subject><subj-group><subject>Sociology</subject><subj-group><subject>Communications</subject><subj-group><subject>Social Communication</subject><subj-group><subject>Social Media</subject><subj-group><subject>Twitter</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Network Analysis</subject><subj-group><subject>Social Networks</subject><subj-group><subject>Social Media</subject><subj-group><subject>Twitter</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social Sciences</subject><subj-group><subject>Sociology</subject><subj-group><subject>Social Networks</subject><subj-group><subject>Social Media</subject><subj-group><subject>Twitter</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Machine Learning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Infectious Diseases</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical Data</subject></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Robust two-stage influenza prediction model considering regular and irregular trends</article-title><alt-title alt-title-type="running-head">Robust two-stage influenza prediction model considering regular and irregular trends</alt-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1148-711X</contrib-id><name><surname>Murayama</surname><given-names>Taichi</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Methodology</role><role content-type="http://credit.casrai.org/">Writing &#x02013; original draft</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Shimizu</surname><given-names>Nobuyuki</given-names></name><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Fujita</surname><given-names>Sumio</given-names></name><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9371-1340</contrib-id><name><surname>Wakamiya</surname><given-names>Shoko</given-names></name><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Aramaki</surname><given-names>Eiji</given-names></name><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="corresp" rid="cor001">*</xref></contrib></contrib-group><aff id="aff001">
<label>1</label>
<addr-line>Nara Institute of Science and Technology (NAIST), Ikoma-city, Japan</addr-line>
</aff><aff id="aff002">
<label>2</label>
<addr-line>Yahoo Japan Corporation, Tokyo, Japan</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Wen</surname><given-names>Tzai-Hung</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">
<addr-line>National Taiwan University, TAIWAN</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>This study was supported in part by JSPS KAKENHI Grant Number JP19K20279, Health and Labor Sciences Research Grant Number H30-shinkougyousei-shitei-004, and Yahoo! Japan. The funder provided support in the form of salaries for authors (Dr Nobuyuki Shimizu and Mr Sumio Fujita), but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. This does not alter our adherence to PLOS ONE policies on sharing data and materials.</p></fn><corresp id="cor001">* E-mail: <email>aramaki@is.naist.jp</email></corresp></author-notes><pub-date pub-type="collection"><year>2020</year></pub-date><pub-date pub-type="epub"><day>21</day><month>5</month><year>2020</year></pub-date><volume>15</volume><issue>5</issue><elocation-id>e0233126</elocation-id><history><date date-type="received"><day>18</day><month>12</month><year>2019</year></date><date date-type="accepted"><day>28</day><month>4</month><year>2020</year></date></history><permissions><copyright-statement>&#x000a9; 2020 Murayama et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Murayama et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0233126.pdf"/><abstract><p>Influenza causes numerous deaths worldwide every year. Predicting the number of influenza patients is an important task for medical institutions. Two types of data regarding influenza-like illnesses (ILIs) are often used for flu prediction: (1) historical data and (2) user generated content (UGC) data on the web such as search queries and tweets. Historical data have an advantage against the normal state but show disadvantages against irregular phenomena. In contrast, UGC data are advantageous for irregular phenomena. So far, no effective model providing the benefits of both types of data has been devised. This study proposes a novel model, designated the two-stage model, which combines both historical and UGC data. The basic idea is, first, basic regular trends are estimated using the historical data-based model, and then, irregular trends are predicted by the UGC data-based model. Our approach is practically useful because we can train models separately. Thus, if a UGC provider changes the service, our model could produce better performance because the first part of the model is still stable. Experiments on the US and Japan datasets demonstrated the basic feasibility of the proposed approach. In the dropout (pseudo-noise) test that assumes a UGC service would change, the proposed method also showed robustness against outliers. The proposed model is suitable for prediction of seasonal flu.</p></abstract><funding-group><award-group id="award001"><funding-source><institution-wrap><institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001691</institution-id><institution>Japan Society for the Promotion of Science</institution></institution-wrap></funding-source><award-id>JP19K20279</award-id><principal-award-recipient><name><surname>Aramaki</surname><given-names>Eiji</given-names></name></principal-award-recipient></award-group><award-group id="award002"><funding-source><institution>Health and Labor Sciences Research</institution></funding-source><award-id>H30-shinkougyousei-shitei-004</award-id><principal-award-recipient><name><surname>Aramaki</surname><given-names>Eiji</given-names></name></principal-award-recipient></award-group><award-group id="award003"><funding-source><institution>Yahoo! Japan</institution></funding-source><principal-award-recipient><name><surname>Aramaki</surname><given-names>Eiji</given-names></name></principal-award-recipient></award-group><funding-statement>This study was supported in part by JSPS KAKENHI Grant Number JP19K20279, Health and Labor Sciences Research Grant Number H30-shinkougyousei-shitei-004, and Yahoo! Japan. The funder provided support in the form of salaries for authors (Dr Nobuyuki Shimizu and Mr Sumio Fujita), but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the &#x02018;author contributions&#x02019; section.</funding-statement></funding-group><counts><fig-count count="4"/><table-count count="3"/><page-count count="14"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>All google trends data (google queries) are available from the google Trends site (<ext-link ext-link-type="uri" xlink:href="https://trends.google.co.jp/">https://trends.google.co.jp/</ext-link>) All US influenza surveillance reports are available from the FLUView (<ext-link ext-link-type="uri" xlink:href="http://gis.cdc.gov/grasp/fluview/fluportaldashboard.html">http://gis.cdc.gov/grasp/fluview/fluportaldashboard.html</ext-link>) All Japan influenza surveillance reports are available from the NIID (<ext-link ext-link-type="uri" xlink:href="https://www.niid.go.jp/niid/ja/idwr.html">https://www.niid.go.jp/niid/ja/idwr.html</ext-link>).</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>All google trends data (google queries) are available from the google Trends site (<ext-link ext-link-type="uri" xlink:href="https://trends.google.co.jp/">https://trends.google.co.jp/</ext-link>) All US influenza surveillance reports are available from the FLUView (<ext-link ext-link-type="uri" xlink:href="http://gis.cdc.gov/grasp/fluview/fluportaldashboard.html">http://gis.cdc.gov/grasp/fluview/fluportaldashboard.html</ext-link>) All Japan influenza surveillance reports are available from the NIID (<ext-link ext-link-type="uri" xlink:href="https://www.niid.go.jp/niid/ja/idwr.html">https://www.niid.go.jp/niid/ja/idwr.html</ext-link>).</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Seasonal influenza epidemics, representing severe infectious diseases, are characterized by the widespread incidence of various symptoms such as a sudden onset of fever, cough, headache, and muscle and joint pain. The World Health Organization (WHO) reported that 3&#x02013;5 million cases of severe illness occur worldwide each year because of seasonal influenza, leading to approximately 290,000&#x02014;650,000 deaths annually [<xref rid="pone.0233126.ref001" ref-type="bibr">1</xref>]. Seasonal influenza also affects the economic productivity because of employee absence and unexpected increases in hospital work loads [<xref rid="pone.0233126.ref002" ref-type="bibr">2</xref>]. Prediction of influenza outbreaks is therefore crucially important to support real-time decision-making related to the management of hospital resources with a rapid response.</p><p>To predict influenza incidence, influenza-like illness (ILI) data of two types have been widely applied: (1) historical time series data, which mostly involve the previous year&#x02019;s data, and (2) online user generated content (UGC) data.</p><sec id="sec002"><title>Historical data</title><p>Historical time series data, called historical data, have a feature that potentially involves crucially important information such as marked seasonality. Therefore, approaches based on historical data have been reported [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>&#x02013;<xref rid="pone.0233126.ref005" ref-type="bibr">5</xref>], and various models [<xref rid="pone.0233126.ref006" ref-type="bibr">6</xref>&#x02013;<xref rid="pone.0233126.ref008" ref-type="bibr">8</xref>] have been proposed. Kane et al. [<xref rid="pone.0233126.ref009" ref-type="bibr">9</xref>] compared the effectiveness of flu prediction of an autoregressive integrated moving average (ARIMA) model and a regression model based on random forest. Nasserie T., et al. [<xref rid="pone.0233126.ref010" ref-type="bibr">10</xref>] used disease models such as the IDEA model to project influenza peaks and epidemic final sizes. Some researches [<xref rid="pone.0233126.ref011" ref-type="bibr">11</xref>&#x02013;<xref rid="pone.0233126.ref013" ref-type="bibr">13</xref>] used long short-term memory (LSTM), a neural network model, to verify its effectiveness in flu prediction. Yang Wan. et al. [<xref rid="pone.0233126.ref014" ref-type="bibr">14</xref>] showed that the application of statistical filtering methods to epidemiological models makes reliable influenza prediction possible by comparing the performance of six state-of-the-art filter methods such as particle filters. These researches improved the prediction performance and showed the effectiveness of data intensive prediction techniques of flu epidemics. Although numerous efforts have been made, these approaches suffer from one limitation; they are insufficient to discriminate against various unexpected sudden movements.</p></sec><sec id="sec003"><title>UGC data</title><p>Another line of flu prediction research typically utilizes UGC text data or search query logs to seek signals of epidemic-related activities from crowds of users. To capture irregular movements detected by these signals, most studies have employed UGC on the Web [<xref rid="pone.0233126.ref015" ref-type="bibr">15</xref>] including search queries [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0233126.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0233126.ref017" ref-type="bibr">17</xref>], microblogs [<xref rid="pone.0233126.ref018" ref-type="bibr">18</xref>&#x02013;<xref rid="pone.0233126.ref020" ref-type="bibr">20</xref>], and access logs to Web pages such as Wikipedia [<xref rid="pone.0233126.ref016" ref-type="bibr">16</xref>] for flu prediction. Although a comparison of these resources has been presented in earlier reports [<xref rid="pone.0233126.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0233126.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0233126.ref022" ref-type="bibr">22</xref>], it still requires active discussions regarding which resources are the most useful for predicting flu epidemics. Signorini, A., et al. [<xref rid="pone.0233126.ref022" ref-type="bibr">22</xref>] examined the volume in posts including keywords related to influenza in the Twitter stream and showed the usefulness of twitter data for tracking flu epidemics. In addition, some have studies tackled the aspects such as which keywords on Google are useful [<xref rid="pone.0233126.ref023" ref-type="bibr">23</xref>] and when and where the model based on Twitter works well [<xref rid="pone.0233126.ref020" ref-type="bibr">20</xref>]. Various posts and search queries by users in UGC are important as signals to identify the beginning of epidemics and are used for the prediction of various epidemics [<xref rid="pone.0233126.ref024" ref-type="bibr">24</xref>] apart from influenza. Currently, Google Flu Trends (GFT) [<xref rid="pone.0233126.ref017" ref-type="bibr">17</xref>] is one of the most representative systems using UGC, which was designed to estimate the current ILI rate using Google search terms related to ILI. A benefit of using UGC data is that they can quickly detect the signals from online activities of a crowd of users. Nevertheless, UGC-based ILI prediction has some limitations: UGC exhibits difficulty in capturing crucially important regular trends such as long term annual movements in the time series of historical flu data, which might help the prediction of flu outbreaks [<xref rid="pone.0233126.ref025" ref-type="bibr">25</xref>].</p><p>In conclusion, these materials have their own advantages and disadvantages. They mostly correspond to two phenomena of epidemic management: (1) interpreting the intrinsic time series (regular trend) and (2) interpreting a sudden unexpected epidemic (irregular trend). Several studies [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0233126.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0233126.ref026" ref-type="bibr">26</xref>] described the model of predicting the influenza volume using historical data and UGC data simultaneously and showed the effectiveness of the combination of each resource simultaneously. Instead of simultaneously, this study separately employs the two resources; the historical data are applied for regular trends, and the UGC data, for irregular trends (<xref ref-type="fig" rid="pone.0233126.g001">Fig 1</xref>). Our approach is practically useful because we can train the models separately; in case a UGC provider changes its service, our model would only have to train the UGC model. Our model is also robust against noise and outliers in data because the model is divided into two parts: regular prediction using historical data and irregular trend prediction using UGC data. We validated our hypothesis regarding the robustness of the proposed method throughout the experiment in &#x0201c;Robustness&#x0201d; of the Results Section.</p><fig id="pone.0233126.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0233126.g001</object-id><label>Fig 1</label><caption><title>Overview of the previous research (Left) and two-stage prediction model (Right).</title><p>Given historical data and UGC data, the existing approaches predict the influenza volume using historical and UGC simultaneously. In contrast, the Two-stage prediction model comprising the <bold>1st model</bold> and the <bold>2nd model</bold> can predict regular trends such as the periodicity from the historical data in the <bold>1st model</bold> and irregular trends such as sudden epidemics from the UGC data in the <bold>2nd model</bold>. Finally, the Two-stage model combines the regular and irregular trends from these models and predicts ILI activity such as the ILI rate in the US and the number of flu patients in Japan after a week.</p></caption><graphic xlink:href="pone.0233126.g001"/></fig></sec></sec><sec sec-type="materials|methods" id="sec004"><title>Materials and methods</title><sec id="sec005"><title>Material</title><sec id="sec006"><title>US historical ILI data (CDC data)</title><p>In the US, the Centers for Disease Control and Prevention (CDC) provides weekly influenza surveillance reports called FluView. Information on outpatient visits to health care providers for ILI is collected through the US Outpatient Influenza-like Illness Surveillance Network (ILINet). The national percentage of patient visits to healthcare providers for ILI reported each week is calculated by combining state-specific data weighted by state population. Because of the time required for data aggregation and percentage calculation, the CDC reports have a delay of about a week. We use the ILI rate data from the 2010/40th week to the 2018/39th week as the US&#x02019;s historical ILI data.</p></sec><sec id="sec007"><title>Japanese historical ILI data (NIID data)</title><p>Similar to the CDC, the National Institute of Infectious Diseases (NIID) reports data on the number of patients with ILI symptoms every week in Japan through the Infectious Disease Weekly Report (IDWR). These reports have a delay of approximately a week because of the time necessary for aggregating clinical information, similar to CDC reports. However, the ILI patient number is more generic than the ILI rate in Japan, unlike the US. Therefore, we use the number of ILI patients from the 2009/40th week to the 2018/39th week as Japanese historical ILI data.</p></sec><sec id="sec008"><title>UGC data (Google trends)</title><p>Google Trend (GT) data has been used as UGC data. We randomly selected 20 query words from flu-related queries used in [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>] as predictors and obtained the approximate weekly search volume data of these words from the 2012/40th week to the 2018/39th week. The time series of GT data were normalized to have a zero mean and a standard deviation of one.</p><p>Because flu-related words used in the US differ from those in Japan, translating English words into Japanese is insufficient to select the appropriate queries. For example, the abbreviation of influenza &#x0201c;flu&#x0201d; is translated into &#x0201c;I-N-FU-LU-E-N-ZA&#x0201d; and is not translated into the Japanese abbreviation of influenza &#x0201c;I-N-FU-LU&#x0201d;. As an orthographical variant, the three categories of characters used by the Japanese three writing script are applied (kanji-script, hiragana-script, and katakana-script). Twenty queries were selected based on the correlation coefficients between the word frequency in Twitter and the number of patients with ILI symptoms. From GT, we obtained the approximate search volume weekly data of 20 words from the 2011/40th to the 2018/39th week. Like the US data, we normalized GT data such that the time series of GT data had a zero mean and a standard deviation of one. Our collection method complied with the terms and conditions for these data provision sites.</p></sec></sec><sec id="sec009"><title>Method: Two-stage model</title><sec id="sec010"><title>Basic idea</title><p>Our methodology can accommodate data of two types: historical data and UGC data, which have different benefits and shortcomings. To exploit the benefits of each kind, we proposed a novel method that divides the prediction process into two stages&#x02014;the 1st model and the 2nd model&#x02014;where each model uses different types of data.</p><list list-type="order"><list-item><p><bold>1st model for regular trends</bold>: First, an autoregressive model is used to learn and predict the regular movements from only the historical data. We designate this model as the 1st model, which makes the basis of the succeeding model. The model predicts the future ILI rate/patient number from the historical data.</p></list-item><list-item><p><bold>2nd model for irregular trends</bold>: This model is designed to predict sudden outbreaks. To identify sudden outbreaks, the model learns and predicts the difference between the ground truth and the predicted values by the 1st model using GTs data, in a different training term from the 1st model training term.</p></list-item></list><p>We designated the combination of the 1st model and 2nd model as the <bold>Two-stage model</bold>. Thus, the final prediction values of the Two-stage Model are calculated as the sum of the output value of the 1st model and that of the 2nd model. As each model is trained to predict a regular trend value and a deviated value from this, no coefficient weights are required to adjust them. <xref ref-type="fig" rid="pone.0233126.g002">Fig 2</xref> shows the example of the prediction by the Two-stage model: the 1st model first predicts future ILI rate/patient number as regular trends from historical data (blue point), and then, the 2nd model predicts the differences between the output of the 1st model and the actual value (red dotted arrow), as irregular trends. The Two-stage model outputs the sum of the output of the 1st and 2nd model.</p><fig id="pone.0233126.g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0233126.g002</object-id><label>Fig 2</label><caption><title>Outline of the two-stage model: Black points in the upper graph indicate the observed values in each week.</title><p>A Two-stage model produces a one-week ahead flu prediction by a combination of the 1st and 2nd models. The 1st model, the input of which is the time series of historical data, predicts future ILI rate/patient number as regular trends. The 1st model predicts the number of patients of this week and one-week ahead, given the historical data until the last week. The outputs of the 1st model are shown as blue points in the upper graph. Then, the 2nd model predicts irregular trends, which are differences between the predicted values and the actual values. The input for the 2nd model is time series data of the weekly total search frequencies of a set of predefined queries. The output of the 2nd model is shown as a dotted red arrow in the upper graph. The output of the Two-stage model is indicated by a red point, which is the simple sum of the outputs of the 1st and 2nd models.</p></caption><graphic xlink:href="pone.0233126.g002"/></fig></sec></sec><sec id="sec011"><title>Implementation</title><p>An autoregressive model (AR model) [<xref rid="pone.0233126.ref027" ref-type="bibr">27</xref>] is used for the 1st model. A LSTM model [<xref rid="pone.0233126.ref011" ref-type="bibr">11</xref>&#x02013;<xref rid="pone.0233126.ref013" ref-type="bibr">13</xref>] is employed for the 2nd model. The Two-stage model calculates the sum of the output value of the 1st model and that of the 2nd model without any coefficient weights, as follows:</p><sec id="sec012"><title>Autoregressive model (AR model)</title><p>The AR model is a type of random process, which is commonly used in time-series analyses. This model calculates each value of a time series using its own previous values. Given a time series, AR(p) has the following form.
<disp-formula id="pone.0233126.e001"><alternatives><graphic xlink:href="pone.0233126.e001.jpg" id="pone.0233126.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p><p>Therein, <italic>p</italic> represents the number of most recent values before a time <italic>t</italic> which predicts the value of <italic>t</italic>: <italic>y</italic><sub><italic>t</italic></sub>. In addition, <italic>&#x003c6;</italic><sub><italic>i</italic></sub> stands for a parameter of the model, <italic>c</italic> is a constant, and <italic>&#x003b5;</italic><sub><italic>t</italic></sub> denotes white noise.</p><p>Our paper uses the AR model as the 1st model. The input data for the AR model is the total weekly ILI rate/number data. It is aggregated by medical institutions in each area. We selected AR(26), which uses 26 weeks (a half year) of ILI data as predictors, and attempted to capture the seasonality of half a year. Although AR(52) would be the best to capture year-long seasonality as a year accounts for 52 weeks, it practically requires more data in training. Thus, it is difficult to perform a sufficient number of test verifications.</p></sec><sec id="sec013"><title>Long Short-Term Memory (LSTM)</title><p>LSTM, which is a successful method for NLP applications [<xref rid="pone.0233126.ref028" ref-type="bibr">28</xref>, <xref rid="pone.0233126.ref029" ref-type="bibr">29</xref>], processes a sequence of input and target pairs [(<italic>x</italic><sub>1</sub>, <italic>y</italic><sub>1</sub>), &#x02026;, (<italic>x</italic><sub><italic>n</italic></sub>, <italic>y</italic><sub><italic>n</italic></sub>)]. For each pair, it takes a new input <italic>x</italic><sub><italic>i</italic></sub> and produces an estimate for a target <italic>y</italic><sub><italic>i</italic></sub> using earlier inputs <italic>x</italic><sub><italic>i</italic>&#x02212;<italic>t</italic></sub>, &#x02026;, <italic>x</italic><sub><italic>i</italic></sub>. An LSTM cell works as a memory to manage information according to the decisions specified by the input <bold>I</bold>, output <bold>Y</bold>, and forget gates <bold>F</bold>. Each memory cell is implemented as shown below.
<disp-formula id="pone.0233126.e002"><alternatives><graphic xlink:href="pone.0233126.e002.jpg" id="pone.0233126.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">o</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="16.0pt"/><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">o</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">o</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="12.0pt"/><mml:mover accent="true"><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:msub><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi mathvariant="bold">o</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="7.0pt"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>&#x02299;</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>&#x02299;</mml:mo><mml:mtext mathvariant="bold">tanh</mml:mtext><mml:mo>(</mml:mo><mml:mover accent="true"><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="12.0pt"/><mml:msub><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>&#x02299;</mml:mo><mml:mtext mathvariant="bold">tanh</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mspace width="60.0pt"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p><p>Here, <bold>W</bold><sub><bold>x</bold></sub> and <bold>W</bold><sub><bold>m</bold></sub> are adaptive weights and <bold>b</bold> is the intercept, initialized randomly in the range (0,1). In addition, <bold>x</bold><sub><bold>t</bold></sub> and <bold>o</bold><sub><bold>t</bold>&#x02212;<bold>1</bold></sub> denote the current input and previous output vectors, respectively. The current cell state is denoted as <italic>C</italic><sub><italic>t</italic></sub>; <italic>&#x003c3;</italic> denotes the sigmoid function; and &#x02299; denotes the Hadamard product.</p><p>Our paper uses the LSTM as the 2nd model. The input data for LSTM are the weekly search query frequency data obtained through GT. We use 26 weeks of GT data before each prediction point as predictors. We predicted the differences between the ground truth and the predicted values by the 1st model. In <xref ref-type="disp-formula" rid="pone.0233126.e002">Eq (2)</xref>, <italic>o</italic><sub><italic>t</italic></sub> denotes the predicted difference at time <italic>t</italic>. In <xref ref-type="fig" rid="pone.0233126.g002">Fig 2</xref>, we show the usage of LSTM mentioned above for our experiment; such usage is very similar to the method used in a previous study [<xref rid="pone.0233126.ref012" ref-type="bibr">12</xref>].</p></sec><sec id="sec014"><title>The two-stage model</title><p>The Two-stage model outputs the sum of the output of the 1st model (AR model) and the 2nd model (LSTM). In our setting, the AR model first outputs the prediction of the ILI rate/patient number from historical data prior to more than two weeks, and then, the LSTM model outputs the prediction of sudden outbreaks, which is the difference between the ground truth and the output of the AR model. We predict the number of influenza patients at time <italic>t</italic>+ 1, as formulated as follows:
<disp-formula id="pone.0233126.e003"><alternatives><graphic xlink:href="pone.0233126.e003.jpg" id="pone.0233126.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>26</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p><p>The AR model, as the 1st model, predicts a regular trend, <inline-formula id="pone.0233126.e004"><alternatives><graphic xlink:href="pone.0233126.e004.jpg" id="pone.0233126.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> from the 26 weeks of the historical data <italic>y</italic>. The LSTM model, as the 2nd model, predicts the irregular trend <inline-formula id="pone.0233126.e005"><alternatives><graphic xlink:href="pone.0233126.e005.jpg" id="pone.0233126.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> from 26 weeks of the GT data <italic>g</italic>. The output of the Two-stage model, <inline-formula id="pone.0233126.e006"><alternatives><graphic xlink:href="pone.0233126.e006.jpg" id="pone.0233126.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, is calculated by adding <inline-formula id="pone.0233126.e007"><alternatives><graphic xlink:href="pone.0233126.e007.jpg" id="pone.0233126.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0233126.e008"><alternatives><graphic xlink:href="pone.0233126.e008.jpg" id="pone.0233126.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p></sec></sec></sec><sec id="sec015"><title>Results &#x00026; discussion</title><sec id="sec016"><title>Settings</title><p>The proposed model is evaluated by estimating ILI indexes (relative ratio in the US; the absolute patient numbers in Japan). The model produces a one-week forecast from a specific week using the ILI report delayed by one week in each country and GT data in the same week. Given <italic>i</italic>-th week <italic>t</italic><sub><italic>i</italic></sub>, the model estimates the ILI rate (in the US case) or the number of ILI patients (in Japan case) after a week.</p><p>We apply the AR(26) model as the 1st model using historical data for 26 weeks (a half year) as predictors. The LSTM model as the 2nd model uses GT data, the period of which is from a total of 26 weeks. It predicts the gap separating the ground truth and predicted values by the 1st model. The number of hidden layers in LSTM is one layer; the size of the hidden layer is selected from (5, 20, 32, 64, 128) in the validation period. We set 50 as the number of epochs. <xref ref-type="fig" rid="pone.0233126.g003">Fig 3</xref> presents an example of prediction using the proposed model.</p><fig id="pone.0233126.g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0233126.g003</object-id><label>Fig 3</label><caption><title>Example of flu prediction using the two-stage model.</title><p>When estimating the ILI rate/ILI patient number for the target week of 51th week, the historical data for 26 weeks from 24th to 49th week are used for the 1st model because of an approximately one week delay before data are reported. For the 2nd model, GT data for 26 weeks from 25th to 50th week are available before the target week is used.</p></caption><graphic xlink:href="pone.0233126.g003"/></fig><p>
<xref rid="pone.0233126.t001" ref-type="table">Table 1</xref> presents an overview of training, validation, and test periods. For the experiments, we assessed the predictive performance using test data for one year. A year-long period is also set for the validation data. We set 104 weeks (two year-long) and 156 weeks (three year-long) for the 1st model training on historical data and the 2nd model training on GT data before the test period, respectively.</p><table-wrap id="pone.0233126.t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0233126.t001</object-id><label>Table 1</label><caption><title>Overview of training, validation and test periods used for experiments.</title></caption><alternatives><graphic id="pone.0233126.t001g" xlink:href="pone.0233126.t001"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="2" colspan="1"/><th align="center" colspan="2" rowspan="1">Training</th><th align="center" rowspan="2" colspan="1">Validation</th><th align="center" rowspan="2" colspan="1">Test</th></tr><tr><th align="center" rowspan="1" colspan="1">1st model</th><th align="center" rowspan="1" colspan="1">2nd model</th></tr></thead><tbody><tr><td align="center" rowspan="2" colspan="1">US</td><td align="right" rowspan="1" colspan="1">2010/40th&#x02013;2012/39th</td><td align="right" rowspan="1" colspan="1">2012/40th&#x02013;2015/39th</td><td align="right" rowspan="1" colspan="1">2015/40th&#x02013;2016/39th</td><td align="right" rowspan="1" colspan="1">2016/40th&#x02013;2017/39th</td></tr><tr><td align="right" rowspan="1" colspan="1">2011/40th&#x02013;2013/39th</td><td align="right" rowspan="1" colspan="1">2013/40th&#x02013;2016/39th</td><td align="right" rowspan="1" colspan="1">2016/40th&#x02013;2017/39th</td><td align="right" rowspan="1" colspan="1">2017/40th&#x02013;2018/39th</td></tr><tr><td align="center" rowspan="3" colspan="1">Japan</td><td align="right" rowspan="1" colspan="1">2009/40th&#x02013;2011/39th</td><td align="right" rowspan="1" colspan="1">2011/40th&#x02013;2014/39th</td><td align="right" rowspan="1" colspan="1">2014/40th&#x02013;2015/39th</td><td align="right" rowspan="1" colspan="1">2015/40th&#x02013;2016/39th</td></tr><tr><td align="right" rowspan="1" colspan="1">2010/40th&#x02013;2012/39th</td><td align="right" rowspan="1" colspan="1">2012/40th&#x02013;2015/39th</td><td align="right" rowspan="1" colspan="1">2015/40th&#x02013;2016/39th</td><td align="right" rowspan="1" colspan="1">2016/40th&#x02013;2017/39th</td></tr><tr><td align="right" rowspan="1" colspan="1">2011/40th&#x02013;2013/39th</td><td align="right" rowspan="1" colspan="1">2013/40th&#x02013;2016/39th</td><td align="right" rowspan="1" colspan="1">2016/40th&#x02013;2017/39th</td><td align="right" rowspan="1" colspan="1">2017/40th&#x02013;2018/39th</td></tr></tbody></table></alternatives></table-wrap><p>We also prepared datasets with outliers to evaluate the robustness of the proposed model. UGC data sometimes exhibit disadvantages against noise (outliers) due to malfunctions in crawling or those in services because of heavy traffic. These problems lead to confounded prediction and time-consuming preprocessing of the data. Robustness against noise and outliers is important. Thus, we investigated the robustness of the Two-stage model. ILI data is not processed because it is less susceptible to contain outliers. GT datasets with outliers were created by randomly changing the frequency values of GT data in each query at each time span to 0.0 (the minimum value) or to the maximum value in each dataset without assuming any statistical distribution. Based on the above processing, three datasets with different ratios of outliers; 5.0%, 10.0%, and 15.0%, were created from the US GT data and the Japanese GT data, respectively. As described in the experimental settings, we conducted the same experiments on the prediction of the ILI rate and the number of ILI patients in the US and Japan from the 40th week of 2017 to the 39th week of 2018.</p></sec><sec id="sec017"><title>Baseline methods</title><p>To evaluate the proposed method, we compared the proposed model with the two following models: the ARGO model and Random Forest Regression (RFR), which are well known for flu prediction [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0233126.ref007" ref-type="bibr">7</xref>, <xref rid="pone.0233126.ref009" ref-type="bibr">9</xref>].</p><sec id="sec018"><title>ARGO model</title><p>The ARGO model [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>], which is motivated by the hidden Markov model, performs autoregression on Google search data, in which Google search queries act as exogenous variables. The ARGO model is presented as follows.
<disp-formula id="pone.0233126.e009"><alternatives><graphic xlink:href="pone.0233126.e009.jpg" id="pone.0233126.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="5.0pt"/><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msup><mml:mo/><mml:mi>~</mml:mi></mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic>y</italic><sub><italic>t</italic></sub> represents the weighted ILI rate at time <italic>t</italic>, and <italic>X</italic><sub><italic>i</italic>,<italic>t</italic></sub> is the result of term <italic>i</italic> at time <italic>t</italic> using GT. Here, <italic>N</italic> stands for the number of weeks incorporated in ARGO to capture the seasonality in ILI activity. Then, as described also in an earlier report [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>], we set <italic>N</italic> = 52 (weeks) to find parameters <italic>&#x003bc;</italic><sub><italic>y</italic></sub>, <italic>&#x003b1;</italic><sub>1</sub>&#x02026;<italic>&#x003b1;</italic><sub>52</sub>, and <italic>&#x003b2;</italic><sub>1</sub>&#x02026;<italic>&#x003b2;</italic><sub>20</sub> that minimize the following.
<disp-formula id="pone.0233126.e010"><alternatives><graphic xlink:href="pone.0233126.e010.jpg" id="pone.0233126.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>52</mml:mn></mml:munderover><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>20</mml:mn></mml:munderover><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>&#x003bb;</mml:mo><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mo>&#x003bb;</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p><p>Here, &#x003bb;<sub><italic>&#x003b1;</italic></sub>, &#x003bb;<sub><italic>&#x003b2;</italic></sub>, <italic>&#x003b7;</italic><sub><italic>&#x003b1;</italic></sub>, and <italic>&#x003b7;</italic><sub><italic>&#x003b2;</italic></sub> are hyperparameters. The ARGO model employs L1 and L2 regularization to achieve automatic selection of the most relevant information separately for each data group. These hyperparameters are selected from &#x003bb;<sub><italic>&#x003b1;</italic></sub>, &#x003bb;<sub><italic>&#x003b2;</italic></sub>, <italic>&#x003b7;</italic><sub><italic>&#x003b1;</italic></sub> = (0.001, 0.01, 0.1, 1.0) during the validation period.</p></sec><sec id="sec019"><title>Random Forest Regression (RFR)</title><p>The random forest approach has been used for several public health studies such as the prediction of deer mouse population dynamics [<xref rid="pone.0233126.ref030" ref-type="bibr">30</xref>] along with influenza studies. This approach is a tree-based method that stratifies or segments the predictor space into several simple regions. It is frequently used to analyze variable importance.</p></sec></sec><sec id="sec020"><title>Evaluation metrics</title><p>Three evaluation metrics were used&#x02014;the coefficient of determination <italic>R</italic><sup>2</sup>, mean absolute error (MAE), and mean absolute percent error (MAPE). <italic>R</italic><sup>2</sup> is a measure of how well the predicted values conform to true values; the higher, the better. MAE is a measure of the average magnitude of differences between predicted values and true ones; the lower the better. Finally, MAPE is a measure of the average magnitude of the different ratio between predicted values and true ones; the lower the better. These metrics are defined as presented below.
<disp-formula id="pone.0233126.e011"><alternatives><graphic xlink:href="pone.0233126.e011.jpg" id="pone.0233126.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="15.0pt"/><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
<disp-formula id="pone.0233126.e012"><alternatives><graphic xlink:href="pone.0233126.e012.jpg" id="pone.0233126.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mfrac><mml:mo>|</mml:mo><mml:mo>*</mml:mo><mml:mn>100</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where <italic>n</italic> denotes the number of weeks. In addition, <italic>A</italic><sub><italic>t</italic></sub> and <italic>F</italic><sub><italic>t</italic></sub> respectively denote the true value and the predicted value at week <italic>t</italic>. <italic>R</italic><sup>2</sup> is an important indicator among the three in terms of flu prediction because it shows how well a model fits and represents the accuracy of the prediction during epidemic seasons.</p></sec><sec id="sec021"><title>Results</title><p><xref rid="pone.0233126.t002" ref-type="table">Table 2</xref> and <xref ref-type="fig" rid="pone.0233126.g004">Fig 4</xref> present the overall summary. In the US, the Two-stage model showed the best performance in some metrics of respective periods. However, no significant advantage was observed when compared to other models. In Japan, the Two-stage model exhibited the best performance in terms of all metrics for all periods.</p><fig id="pone.0233126.g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0233126.g004</object-id><label>Fig 4</label><caption><title>The ILI rate and performance of the multiple models from the 2017/40th to the 2018/39th week in (a) the US and (b) Japan.</title><p>The left graph shows the time series (upper) and error plot (lower), which indicates the differences in between true and predicted ILI values of each model. The right graph shows observed vs. predicted scatter plot for each model.</p></caption><graphic xlink:href="pone.0233126.g004"/></fig><table-wrap id="pone.0233126.t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0233126.t002</object-id><label>Table 2</label><caption><title>Accuracy of the proposed model (two-stage model) and the models used for comparison (ARGO model (ARGO) and Random Forest Regression (RFR)).</title></caption><alternatives><graphic id="pone.0233126.t002g" xlink:href="pone.0233126.t002"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1"/><th align="right" rowspan="1" colspan="1">Test period</th><th align="center" rowspan="1" colspan="1">Metrics</th><th align="center" rowspan="1" colspan="1">ARGO</th><th align="center" rowspan="1" colspan="1">RFR</th><th align="center" rowspan="1" colspan="1">Two-stage model</th></tr></thead><tbody><tr><td align="center" rowspan="6" colspan="1">US</td><td align="right" rowspan="3" colspan="1">2016/40th&#x02013;2017/39th</td><td align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.964</bold></td><td align="char" char="." rowspan="1" colspan="1">0.950</td><td align="char" char="." rowspan="1" colspan="1">0.935</td></tr><tr><td align="right" rowspan="1" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.171</bold></td><td align="char" char="." rowspan="1" colspan="1">0.200</td><td align="char" char="." rowspan="1" colspan="1">0.216</td></tr><tr><td align="right" rowspan="1" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">11.21</td><td align="char" char="." rowspan="1" colspan="1">11.70</td><td align="char" char="." rowspan="1" colspan="1"><bold>11.10</bold></td></tr><tr><td align="right" rowspan="3" colspan="1">2017/40th&#x02013;2018/39th</td><td align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.941</td><td align="char" char="." rowspan="1" colspan="1">0.834</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.947</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">0.329</td><td align="char" char="." rowspan="1" colspan="1">0.432</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.321</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1"><bold>13.92</bold></td><td align="char" char="." rowspan="1" colspan="1">16.68</td><td align="char" char="." rowspan="1" colspan="1">15.09</td></tr><tr><td align="center" rowspan="9" colspan="1">Japan</td><td align="right" rowspan="3" colspan="1">2015/40th&#x02013;2016/39th</td><td align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.895</td><td align="char" char="." rowspan="1" colspan="1">0.840</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.914</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">8493.20</td><td align="char" char="." rowspan="1" colspan="1">12375.92</td><td align="char" char="." rowspan="1" colspan="1"><bold>6989.78</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">62.97</td><td align="char" char="." rowspan="1" colspan="1">179.22</td><td align="char" char="." rowspan="1" colspan="1"><bold>34.47</bold></td></tr><tr><td align="right" rowspan="3" colspan="1">2016/40th&#x02013;2017/39th</td><td align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.528</td><td align="char" char="." rowspan="1" colspan="1">0.739</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.745</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">14684.53</td><td align="char" char="." rowspan="1" colspan="1">12143.82</td><td align="char" char="." rowspan="1" colspan="1"><bold>8966.96</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">110.59</td><td align="char" char="." rowspan="1" colspan="1">58.13</td><td align="char" char="." rowspan="1" colspan="1"><bold>31.48</bold></td></tr><tr><td align="right" rowspan="3" colspan="1">2017/40th&#x02013;2018/39th</td><td align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.837</td><td align="char" char="." rowspan="1" colspan="1">0.817</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.863</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">16049.81</td><td align="char" char="." rowspan="1" colspan="1">12923.58</td><td align="char" char="." rowspan="1" colspan="1"><bold>10958.86</bold></td></tr><tr><td align="right" rowspan="1" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">989.64</td><td align="char" char="." rowspan="1" colspan="1">54.68</td><td align="char" char="." rowspan="1" colspan="1"><bold>31.66</bold></td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec022"><title>Model comparison</title><p>The Two-stage model achieved the best performance for several periods and metrics in the US and achieved the best performance among all metrics in Japan, demonstrating that the Two-stage model is better for flu prediction compared to the other two models. Especially, in MAPE, it outperformed the other compared models, indicating that suitable values were predicted.</p><p>The accuracy of ARGO in the US is close to that of the Two-stage model, but its accuracy in Japan is not as high as in MAE and MAPE. This indicates that ARGO highly depends on feature quantity. Compared to ARGO, the results from random forest seems to be a more stable result in every period. The predictive performance of the Two-stage model was higher than those of the ARGO and RFR models in many points of comparison.</p><p>
<xref ref-type="fig" rid="pone.0233126.g004">Fig 4</xref> shows the time series and observed (obs.) vs. predicted scatter plots of each model and the observed values in the US and Japan cases. The time series graphs show that the Two-stage model output predicted values close to the observed values. The model performed better at the beginning of epidemics than the other models in the case of Japan. The obs. vs. predicted scatter plots illustrate the prediction result of each model by period and country. It shows that ARGO tended to deviate upward while the Two-stage model and random forest tended to deviate downward. We need a longer observation period for the interpretation of the phenomena. The verification of how each model works for flu prediction is an issue for future studies.</p></sec><sec id="sec023"><title>Robustness</title><p><xref rid="pone.0233126.t003" ref-type="table">Table 3</xref> presents the results of testing for accuracy and the differences in accuracy scores between the original data and processed data with outliers. The smaller the difference value is, the more robust the model is. In <italic>R</italic><sup>2</sup>, the 15% outliers reduced the performance by only -0.020 (compared with 0.112 for RFR, and 0.081 for ARGO), such a smaller difference against outliers shows the high robustness of the proposed model. Although under specified situations, the ARGO model in Japan for <italic>R</italic><sup>2</sup> and random forest in the US for MAPE show better performance, the Two-stage model is relatively stronger. For example, the Two-stage model showed that the difference in MAPE is between +1.30 and -3.33 in the US and between -2.14 and -7.95 in Japan. Consequently, the results demonstrate that the Two-stage model is robust against outliers.</p><table-wrap id="pone.0233126.t003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0233126.t003</object-id><label>Table 3</label><caption><title>Accuracy of each model on noisy data from the 2017/40th week to the 2018/39th week.</title><p>The values given in parentheses are the difference of accuracy scores between the original data and processed data with outliers.</p></caption><alternatives><graphic id="pone.0233126.t003g" xlink:href="pone.0233126.t003"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="2" colspan="1">Outlier Ratio</th><th align="center" rowspan="2" colspan="1">Metrics</th><th align="center" colspan="3" rowspan="1">US</th><th align="center" colspan="3" rowspan="1">Japan</th></tr><tr><th align="right" rowspan="1" colspan="1">ARGO</th><th align="right" rowspan="1" colspan="1">RFR</th><th align="center" rowspan="1" colspan="1">Two-stage Model</th><th align="right" rowspan="1" colspan="1">ARGO</th><th align="right" rowspan="1" colspan="1">RFR</th><th align="center" rowspan="1" colspan="1">Two-stage Model</th></tr></thead><tbody><tr><td align="center" rowspan="3" colspan="1">0%</td><td align="right" rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.941</td><td align="char" char="." rowspan="1" colspan="1">0.834</td><td align="char" char="." rowspan="1" colspan="1">0.947</td><td align="char" char="." rowspan="1" colspan="1">0.837</td><td align="char" char="." rowspan="1" colspan="1">0.739</td><td align="char" char="." rowspan="1" colspan="1">0.863</td></tr><tr><td align="right" rowspan="1" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">0.329</td><td align="char" char="." rowspan="1" colspan="1">0.432</td><td align="char" char="." rowspan="1" colspan="1">0.321</td><td align="char" char="." rowspan="1" colspan="1">16049.81</td><td align="char" char="." rowspan="1" colspan="1">12143.82</td><td align="char" char="." rowspan="1" colspan="1">10958.8</td></tr><tr><td align="right" rowspan="1" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">13.92</td><td align="char" char="." rowspan="1" colspan="1">16.68</td><td align="char" char="." rowspan="1" colspan="1">15.09</td><td align="char" char="." rowspan="1" colspan="1">989.64</td><td align="char" char="." rowspan="1" colspan="1">58.13</td><td align="char" char="." rowspan="1" colspan="1">31.66</td></tr><tr><td align="center" rowspan="6" colspan="1">5%</td><td align="right" rowspan="2" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.917</td><td align="char" char="." rowspan="1" colspan="1">0.801</td><td align="char" char="." rowspan="1" colspan="1">0.934</td><td align="char" char="." rowspan="1" colspan="1">0.845</td><td align="char" char="." rowspan="1" colspan="1">0.645</td><td align="char" char="." rowspan="1" colspan="1">0.836</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-0.024)</td><td align="char" char="." rowspan="1" colspan="1">(-0.033)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.013)</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>(+0.008)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-0.094)</td><td align="char" char="." rowspan="1" colspan="1">(-0.027)</td></tr><tr><td align="right" rowspan="2" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">0.346</td><td align="char" char="." rowspan="1" colspan="1">0.467</td><td align="char" char="." rowspan="1" colspan="1">0.341</td><td align="char" char="." rowspan="1" colspan="1">20861.21</td><td align="char" char="." rowspan="1" colspan="1">16795.37</td><td align="char" char="." rowspan="1" colspan="1">11923.57</td></tr><tr><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.017)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-0.035)</td><td align="char" char="." rowspan="1" colspan="1">(-0.020)</td><td align="char" char="." rowspan="1" colspan="1">(-4811.40)</td><td align="char" char="." rowspan="1" colspan="1">(-4651.55)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-964.71)</bold></td></tr><tr><td align="right" rowspan="2" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">15.14</td><td align="char" char="." rowspan="1" colspan="1">15.70</td><td align="char" char="." rowspan="1" colspan="1">13.79</td><td align="char" char="." rowspan="1" colspan="1">1590.54</td><td align="char" char="." rowspan="1" colspan="1">82.39</td><td align="char" char="." rowspan="1" colspan="1">33.80</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-1.22)</td><td align="char" char="." rowspan="1" colspan="1">(+0.98)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(+1.30)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-600.90)</td><td align="char" char="." rowspan="1" colspan="1">(-24.26)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-2.14)</bold></td></tr><tr><td align="center" rowspan="6" colspan="1">10%</td><td align="right" rowspan="2" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.912</td><td align="char" char="." rowspan="1" colspan="1">0.756</td><td align="char" char="." rowspan="1" colspan="1">0.937</td><td align="char" char="." rowspan="1" colspan="1">0.815</td><td align="char" char="." rowspan="1" colspan="1">0.439</td><td align="char" char="." rowspan="1" colspan="1">0.760</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-0.029)</td><td align="char" char="." rowspan="1" colspan="1">(-0.078)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.010)</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.022)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-0.300)</td><td align="char" char="." rowspan="1" colspan="1">(-0.076)</td></tr><tr><td align="right" rowspan="2" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">0.413</td><td align="char" char="." rowspan="1" colspan="1">0.547</td><td align="char" char="." rowspan="1" colspan="1">0.357</td><td align="char" char="." rowspan="1" colspan="1">22813.21</td><td align="char" char="." rowspan="1" colspan="1">21699.12</td><td align="char" char="." rowspan="1" colspan="1">14242.20</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-0.084)</td><td align="char" char="." rowspan="1" colspan="1">(-0.115)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.036)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-6763.4)</td><td align="char" char="." rowspan="1" colspan="1">(-5649.31)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-1807.61)</bold></td></tr><tr><td align="right" rowspan="2" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">16.76</td><td align="char" char="." rowspan="1" colspan="1">17.99</td><td align="char" char="." rowspan="1" colspan="1">16.46</td><td align="char" char="." rowspan="1" colspan="1">2534.14</td><td align="char" char="." rowspan="1" colspan="1">107.69</td><td align="char" char="." rowspan="1" colspan="1">36.85</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-2.44)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-1.31)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-1.37)</td><td align="char" char="." rowspan="1" colspan="1">(-1544.50)</td><td align="char" char="." rowspan="1" colspan="1">(-49.56)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-5.19)</bold></td></tr><tr><td align="center" rowspan="6" colspan="1">15%</td><td align="right" rowspan="2" colspan="1"><italic>R</italic><sup>2</sup></td><td align="char" char="." rowspan="1" colspan="1">0.860</td><td align="char" char="." rowspan="1" colspan="1">0.722</td><td align="char" char="." rowspan="1" colspan="1">0.927</td><td align="char" char="." rowspan="1" colspan="1">0.735</td><td align="char" char="." rowspan="1" colspan="1">0.167</td><td align="char" char="." rowspan="1" colspan="1">0.777</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-0.081)</td><td align="char" char="." rowspan="1" colspan="1">(-0.112)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.020)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-0.102)</td><td align="char" char="." rowspan="1" colspan="1">(-0.478)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.086)</bold></td></tr><tr><td align="right" rowspan="2" colspan="1">MAE</td><td align="char" char="." rowspan="1" colspan="1">0.538</td><td align="char" char="." rowspan="1" colspan="1">0.579</td><td align="char" char="." rowspan="1" colspan="1">0.382</td><td align="char" char="." rowspan="1" colspan="1">23000.91</td><td align="char" char="." rowspan="1" colspan="1">27653.42</td><td align="char" char="." rowspan="1" colspan="1">13879.09</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-0.209)</td><td align="char" char="." rowspan="1" colspan="1">(-0.147)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.061)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-6951.10)</td><td align="char" char="." rowspan="1" colspan="1">(-11603.61)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-2170.72)</bold></td></tr><tr><td align="right" rowspan="2" colspan="1">MAPE</td><td align="char" char="." rowspan="1" colspan="1">21.92</td><td align="char" char="." rowspan="1" colspan="1">17.31</td><td align="char" char="." rowspan="1" colspan="1">18.42</td><td align="char" char="." rowspan="1" colspan="1">2610.99</td><td align="char" char="." rowspan="1" colspan="1">113.94</td><td align="char" char="." rowspan="1" colspan="1">39.61</td></tr><tr><td align="char" char="." rowspan="1" colspan="1">(-8.00)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-0.62)</bold></td><td align="char" char="." rowspan="1" colspan="1">(-3.33)</td><td align="char" char="." rowspan="1" colspan="1">(-1621.35)</td><td align="char" char="." rowspan="1" colspan="1">(-55.81)</td><td align="char" char="." rowspan="1" colspan="1"><bold>(-7.95)</bold></td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec024"><title>Strengths and weaknesses of the two-stage model</title><p>Throughout the experiments, we demonstrate that historical ILI data and UGC data are useful for flu prediction, which is consistent with the results of previous studies [<xref rid="pone.0233126.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0233126.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0233126.ref018" ref-type="bibr">18</xref>]. One salient feature of our model is that the time series data spans are divided clearly into regular trend parts and irregular trend parts. We show that the proposed model, which processes the historical data separately from the UGC data as input, achieves better performance than the existing models that use these two input data simultaneously. Although this study employed the AR model as the 1st model, we could replace this part with any other models such as RNN [<xref rid="pone.0233126.ref011" ref-type="bibr">11</xref>] and disease model [<xref rid="pone.0233126.ref031" ref-type="bibr">31</xref>].</p><p>The proposed method has an advantage not only in performance, but also in robustness against outlier data. Noise and outliers included in UGC data, which are sometimes caused by transaction delays under heavy traffic or malfunctions in crawling, always hinder epidemic prediction tasks. It is crucial to build a model which is robust against outlier data for prediction, but most researches, except [<xref rid="pone.0233126.ref008" ref-type="bibr">8</xref>] and ours, have ignored the issue.</p><p>However, the proposed model has some limitations. Our approach depends strongly on the historical model produced by the 1st model. In flu prediction, the 1st model itself performs very well, which is suitable for our approach. However, in other targets such as infectious gastroenteritis (mainly norovirus) and Zika fever, which do not show any seasonal trends, the model mostly relying only on UGC data might perform better [<xref rid="pone.0233126.ref018" ref-type="bibr">18</xref>]. In future studies, a large scale comparative investigation that covers more infectious diseases would be desired.</p></sec></sec><sec sec-type="conclusions" id="sec025"><title>Conclusions</title><p>This study proposed a novel method for flu prediction: The Two-stage model that predicts regular trends from historical data and irregular trends from the UGC data. In the experiments conducted using the datasets of the US and Japan, we demonstrated that the proposed model can predict the ILI rate and the number of ILI patients with higher accuracy than existing models in the respective countries. The present results suggest that the proposed model is the most suitable for seasonal flu prediction among the compared models and that it is robust to outliers. Our model is only applicable to countries or regions where the amount of historical data is sufficient, which is the resource of the 1st model. Future studies must be conducted to develop a predictive model that can achieve higher accuracy without historical data or with fewer historical health reports.</p></sec><sec sec-type="supplementary-material" id="sec026"><title>Supporting information</title><supplementary-material content-type="local-data" id="pone.0233126.s001"><label>S1 Table</label><caption><title>Queries in English.</title><p>(DOCX)</p></caption><media xlink:href="pone.0233126.s001.docx"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0233126.s002"><label>S2 Table</label><caption><title>Queries in Japanese.</title><p>(DOCX)</p></caption><media xlink:href="pone.0233126.s002.docx"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list><title>References</title><ref id="pone.0233126.ref001"><label>1</label><mixed-citation publication-type="other">World Health Organization website, Influenza (seasonal), <ext-link ext-link-type="uri" xlink:href="http://www.who.int/news-room/fact-sheets/detail/influenza-(seasonal)">http://www.who.int/news-room/fact-sheets/detail/influenza-(seasonal)</ext-link>. Last accessed 2 Apr 2019.</mixed-citation></ref><ref id="pone.0233126.ref002"><label>2</label><mixed-citation publication-type="journal">
<name><surname>Molinari</surname><given-names>NA.</given-names></name>, <etal>et al</etal>
<article-title>The annual impact of seasonal influenza in the US: measuring disease burden and costs</article-title>. <source>Vaccine</source>
<volume>25</volume>(<issue>27</issue>), pp.<fpage>5086</fpage>&#x02013;<lpage>5096</lpage>. (<year>2007</year>). <pub-id pub-id-type="doi">10.1016/j.vaccine.2007.03.046</pub-id>
<?supplied-pmid 17544181?><pub-id pub-id-type="pmid">17544181</pub-id></mixed-citation></ref><ref id="pone.0233126.ref003"><label>3</label><mixed-citation publication-type="journal">
<name><surname>Yang</surname><given-names>S</given-names></name>, <etal>et al</etal>
<article-title>Accurate estimation of influenza epidemics using Google search data via ARGO</article-title>. <source>Proceedings of the National Academy of Sciences</source>
<volume>112</volume>(<issue>47</issue>), pp.<fpage>14473</fpage>&#x02013;<lpage>14478</lpage>. (<year>2015</year>). <pub-id pub-id-type="doi">10.1073/pnas.1515373112</pub-id></mixed-citation></ref><ref id="pone.0233126.ref004"><label>4</label><mixed-citation publication-type="journal">
<name><surname>Zhang</surname><given-names>J.</given-names></name>, and <name><surname>Nawata</surname><given-names>K.</given-names></name>, <article-title>A comparative study on predicting influenza outbreaks</article-title>. <source>Bioscience Trends</source>
<volume>11</volume><issue>5</issue>, pp.<fpage>533</fpage>&#x02013;<lpage>541</lpage>, (<year>2017</year>). <pub-id pub-id-type="doi">10.5582/bst.2017.01257</pub-id>
<?supplied-pmid 29070762?><pub-id pub-id-type="pmid">29070762</pub-id></mixed-citation></ref><ref id="pone.0233126.ref005"><label>5</label><mixed-citation publication-type="journal">
<name><surname>Shaman</surname><given-names>Jeffrey</given-names></name>, <etal>et al</etal>
<article-title>Real-time influenza forecasts during the 2012&#x02013;2013 season</article-title>. <source>Nature Communications</source>
<volume>4</volume><issue>1</issue>, pp. <fpage>1</fpage>&#x02013;<lpage>10</lpage> (<year>2013</year>). <pub-id pub-id-type="doi">10.1038/ncomms3837</pub-id></mixed-citation></ref><ref id="pone.0233126.ref006"><label>6</label><mixed-citation publication-type="journal">
<name><surname>Xu</surname><given-names>Q.</given-names></name>, <etal>et al</etal>
<article-title>Forecasting influenza in Hong Kong with Google search queries and statistical model fusion</article-title>. <source>PLoS One</source>, <volume>12</volume>(<issue>5</issue>), p. <fpage>e0176690</fpage> (<year>2017</year>). <pub-id pub-id-type="doi">10.1371/journal.pone.0176690</pub-id>
<?supplied-pmid 28464015?><pub-id pub-id-type="pmid">28464015</pub-id></mixed-citation></ref><ref id="pone.0233126.ref007"><label>7</label><mixed-citation publication-type="journal">
<name><surname>Wu</surname><given-names>H.</given-names></name>, <etal>et al</etal>
<article-title>Time series analysis of weekly influenza-like illness rate using a one-year period of factors in random forest regression</article-title>. <source>Bioscience Trends</source>
<volume>11</volume>(<issue>3</issue>), pp. <fpage>292</fpage>&#x02013;<lpage>296</lpage> (<year>2017</year>). <pub-id pub-id-type="doi">10.5582/bst.2017.01035</pub-id>
<?supplied-pmid 28484187?><pub-id pub-id-type="pmid">28484187</pub-id></mixed-citation></ref><ref id="pone.0233126.ref008"><label>8</label><mixed-citation publication-type="other">Zou, B., et al. Multi-task learning improves disease models from web search. Proceedings of the International Conference on World Wide Web, pp.87&#x02013;96 (2018).</mixed-citation></ref><ref id="pone.0233126.ref009"><label>9</label><mixed-citation publication-type="journal">
<name><surname>Kane</surname><given-names>M.</given-names></name>, <etal>et al</etal>
<article-title>Comparison of ARIMA and Random Forest time series models for prediction of avian influenza H5N1 outbreaks</article-title>, <source>BMC Bioinformatics</source>
<volume>15</volume>(<issue>1</issue>), pp. <fpage>276</fpage> (<year>2014</year>). <pub-id pub-id-type="doi">10.1186/1471-2105-15-276</pub-id>
<?supplied-pmid 25123979?><pub-id pub-id-type="pmid">25123979</pub-id></mixed-citation></ref><ref id="pone.0233126.ref010"><label>10</label><mixed-citation publication-type="journal">
<name><surname>Biggerstaff</surname><given-names>M.</given-names></name>, <etal>et al</etal>
<article-title>Results from the centers for disease control and prevention&#x02019;s predict the 2013&#x02013;2014 Influenza Season Challenge</article-title>. <source>BMC Infectious Diseases</source>
<volume>16</volume>(<issue>1</issue>), pp. <fpage>357</fpage> (<year>2016</year>). <pub-id pub-id-type="doi">10.1186/s12879-016-1669-x</pub-id>
<?supplied-pmid 27449080?><pub-id pub-id-type="pmid">27449080</pub-id></mixed-citation></ref><ref id="pone.0233126.ref011"><label>11</label><mixed-citation publication-type="other">Liu, L., et al. LSTM Recurrent Neural Networks for Influenza Trends Prediction. In: International Symposium on Bioinformatics Research and Applications, pp.259&#x02013;264 (2018).</mixed-citation></ref><ref id="pone.0233126.ref012"><label>12</label><mixed-citation publication-type="other">Venna, SR., et al. A Novel Data-driven Model for Real-Time Influenza Forecasting. IEEE Access. pp.7691&#x02013;7701 (2018).</mixed-citation></ref><ref id="pone.0233126.ref013"><label>13</label><mixed-citation publication-type="journal">
<name><surname>Volkova</surname><given-names>S.</given-names></name>, <etal>et al</etal>
<article-title>Forecasting influenza-like illness dynamics for military populations using neural networks and social media</article-title>. <source>PLoS One</source>
<volume>12</volume>(<issue>12</issue>) (<year>2017</year>). <pub-id pub-id-type="doi">10.1371/journal.pone.0188941</pub-id>
<?supplied-pmid 29244814?><pub-id pub-id-type="pmid">29244814</pub-id></mixed-citation></ref><ref id="pone.0233126.ref014"><label>14</label><mixed-citation publication-type="journal">
<name><surname>Yang</surname><given-names>Wan</given-names></name>, <name><surname>Karspeck</surname><given-names>Alicia</given-names></name>, and <name><surname>Shaman</surname><given-names>Jeffrey</given-names></name>. <article-title>Comparison of filtering methods for the modeling and retrospective forecasting of influenza epidemics</article-title>. <source>PLoS Computational Biology</source>
<volume>10</volume><issue>4</issue>, (<year>2014</year>). <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003583</pub-id></mixed-citation></ref><ref id="pone.0233126.ref015"><label>15</label><mixed-citation publication-type="journal">
<name><surname>Eysenbach</surname><given-names>G</given-names></name>. <article-title>Infodemiology and infoveillance: framework for an emerging set of public health informatics methods to analyze search, communication and publication behavior on the Internet</article-title>. <source>Journal of Medical Internet Research</source>, <volume>11</volume>(<issue>1</issue>) (<year>2009</year>). <pub-id pub-id-type="doi">10.2196/jmir.1157</pub-id>
<?supplied-pmid 19329408?><pub-id pub-id-type="pmid">19329408</pub-id></mixed-citation></ref><ref id="pone.0233126.ref016"><label>16</label><mixed-citation publication-type="journal">
<name><surname>Sharpe</surname><given-names>JD.</given-names></name>, <etal>et al</etal>
<article-title>Evaluating Google, Twitter, and Wikipedia as tools for influenza surveillance using Bayesian change point analysis: a comparative analysis</article-title>. <source>JMIR Public Health and Surveillance</source>
<volume>2</volume>(<issue>2</issue>) (<year>2016</year>). <pub-id pub-id-type="doi">10.2196/publichealth.5901</pub-id>
<?supplied-pmid 27765731?><pub-id pub-id-type="pmid">27765731</pub-id></mixed-citation></ref><ref id="pone.0233126.ref017"><label>17</label><mixed-citation publication-type="journal">
<name><surname>Ginsberg</surname><given-names>J.</given-names></name>, <etal>et al</etal>
<article-title>Detecting influenza epidemics using search engine query data</article-title>. <source>Nature</source>, <volume>457</volume> (<issue>7232</issue>), pp.<fpage>1012</fpage>&#x02013;<lpage>1014</lpage>. (<year>2009</year>). <pub-id pub-id-type="doi">10.1038/nature07634</pub-id>
<?supplied-pmid 19020500?><pub-id pub-id-type="pmid">19020500</pub-id></mixed-citation></ref><ref id="pone.0233126.ref018"><label>18</label><mixed-citation publication-type="journal">
<name><surname>Santillana</surname><given-names>M.</given-names></name>, <etal>et al</etal>
<article-title>Combining search, social media, and traditional data sources to improve influenza surveillance</article-title>. <source>PLoS Computational Biology</source>, <volume>11</volume>(<issue>10</issue>), p. <fpage>e1004513</fpage> (<year>2015</year>). <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004513</pub-id>
<?supplied-pmid 26513245?><pub-id pub-id-type="pmid">26513245</pub-id></mixed-citation></ref><ref id="pone.0233126.ref019"><label>19</label><mixed-citation publication-type="other">Aramaki, E., et al. Twitter catches the flu: detecting influenza epidemics using Twitter. In Proceedings of EMNLP, pp. 1568&#x02013;1576. (2011).</mixed-citation></ref><ref id="pone.0233126.ref020"><label>20</label><mixed-citation publication-type="journal">
<name><surname>Paul</surname><given-names>MJ.</given-names></name>, <etal>et al</etal>
<article-title>Twitter improves influenza forecasting</article-title>. <source>PLoS Currents</source>, <volume>6</volume> (<year>2014</year>).</mixed-citation></ref><ref id="pone.0233126.ref021"><label>21</label><mixed-citation publication-type="journal">
<name><surname>Nagar</surname><given-names>R.</given-names></name>, <etal>et al</etal>
<article-title>A case study of the New York City 2012-2013 influenza season with daily geocoded Twitter data from temporal and spatiotemporal perspectives</article-title>. <source>Journal of Medical Internet Research</source>
<volume>16</volume><issue>10</issue>, (<year>2014</year>). <pub-id pub-id-type="doi">10.2196/jmir.3416</pub-id>
<?supplied-pmid 25331122?><pub-id pub-id-type="pmid">25331122</pub-id></mixed-citation></ref><ref id="pone.0233126.ref022"><label>22</label><mixed-citation publication-type="journal">
<name><surname>Signorini</surname><given-names>A.</given-names></name>, <etal>et al</etal>
<article-title>The use of Twitter to track levels of disease activity and public concern in the US during the influenza A H1N1 pandemic</article-title>. <source>PloS One</source>
<volume>6</volume>(<issue>5</issue>), p. <fpage>e19467</fpage> (<year>2011</year>). <pub-id pub-id-type="doi">10.1371/journal.pone.0019467</pub-id>
<?supplied-pmid 21573238?><pub-id pub-id-type="pmid">21573238</pub-id></mixed-citation></ref><ref id="pone.0233126.ref023"><label>23</label><mixed-citation publication-type="other">Dalum HN., et al. Seasonal Web Search Query Selection for Influenza-Like Illness (ILI) Estimation. Proc. of the 40th International ACM SIGIR Conference on Research and Development in Information Retrieval, pp.1197&#x02013;1200, 2017.</mixed-citation></ref><ref id="pone.0233126.ref024"><label>24</label><mixed-citation publication-type="journal">
<name><surname>Masri</surname><given-names>Shahir</given-names></name>, <etal>et al</etal>
<article-title>Use of Twitter data to improve Zika virus surveillance in the United States during the 2016 epidemic</article-title>. <source>BMC Public Health</source>
<volume>19</volume><issue>1</issue>, p. <fpage>761</fpage> (<year>2019</year>). <pub-id pub-id-type="doi">10.1186/s12889-019-7103-8</pub-id>
<?supplied-pmid 31200692?><pub-id pub-id-type="pmid">31200692</pub-id></mixed-citation></ref><ref id="pone.0233126.ref025"><label>25</label><mixed-citation publication-type="journal">
<name><surname>Olson</surname><given-names>DR.</given-names></name>, <etal>et al</etal>
<article-title>Reassessing Google Flu Trends data for detection of seasonal and pandemic influenza: a comparative epidemiological study at three geographic scales</article-title>. <source>PLoS Computational Biology</source>
<volume>9</volume>(<issue>10</issue>), (<year>2013</year>). <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003256</pub-id>
<?supplied-pmid 24146603?><pub-id pub-id-type="pmid">24146603</pub-id></mixed-citation></ref><ref id="pone.0233126.ref026"><label>26</label><mixed-citation publication-type="journal">
<name><surname>Lampos</surname><given-names>V.</given-names></name>, <etal>et al</etal>
<article-title>Advances in nowcasting influenza-like illness rates using search query logs</article-title>. <source>Scientific Reports</source>
<volume>5</volume>, (<year>2015</year>). <pub-id pub-id-type="doi">10.1038/srep12760</pub-id>
<?supplied-pmid 26234783?><pub-id pub-id-type="pmid">26234783</pub-id></mixed-citation></ref><ref id="pone.0233126.ref027"><label>27</label><mixed-citation publication-type="book">
<name><surname>Box</surname><given-names>George EP.</given-names></name>, <etal>et al</etal>
<source>Time series analysis: Forecasting and control</source> (<year>1976</year>).</mixed-citation></ref><ref id="pone.0233126.ref028"><label>28</label><mixed-citation publication-type="other">Sutskever, I., et al. Sequence to sequence learning with neural networks. In Advances in Neural Information Processing Systems, pp. 3104-3112 (2014).</mixed-citation></ref><ref id="pone.0233126.ref029"><label>29</label><mixed-citation publication-type="journal">
<name><surname>Hochreiter</surname><given-names>S.</given-names></name> and <name><surname>Schmidhuber</surname><given-names>J</given-names></name>. <article-title>Long short-term memory</article-title>. <source>Neural Computation</source>
<volume>9</volume>(<issue>8</issue>), pp.<fpage>1735</fpage>&#x02013;<lpage>1780</lpage> (<year>1997</year>). <pub-id pub-id-type="doi">10.1162/neco.1997.9.8.1735</pub-id>
<?supplied-pmid 9377276?><pub-id pub-id-type="pmid">9377276</pub-id></mixed-citation></ref><ref id="pone.0233126.ref030"><label>30</label><mixed-citation publication-type="journal">
<name><surname>Loehman</surname><given-names>R.</given-names></name>, <etal>et al</etal>
<article-title>Prediction of Peromyscus maniculatus (deer mouse) population dynamics in Montana, USA, using satellite-driven vegetation productivity and weather data</article-title>. <source>Journal of Wildlife Diseases</source>
<volume>48</volume>(<issue>2</issue>), pp. <fpage>348</fpage>&#x02013;<lpage>360</lpage> (<year>2012</year>). <pub-id pub-id-type="doi">10.7589/0090-3558-48.2.348</pub-id>
<?supplied-pmid 22493110?><pub-id pub-id-type="pmid">22493110</pub-id></mixed-citation></ref><ref id="pone.0233126.ref031"><label>31</label><mixed-citation publication-type="journal">
<name><surname>Nasserie</surname><given-names>T.</given-names></name>, <etal>et al</etal>
<article-title>Seasonal Influenza Forecasting in Real Time Using the Incidence Decay With Exponential Adjustment Model</article-title>. <source>Open Forum Infectious Diseases</source>. <volume>4</volume>(<issue>3</issue>), (<year>2017</year>). <pub-id pub-id-type="doi">10.1093/ofid/ofx166</pub-id>
<?supplied-pmid 29497629?><pub-id pub-id-type="pmid">29497629</pub-id></mixed-citation></ref></ref-list></back><sub-article id="pone.0233126.r001" article-type="aggregated-review-documents"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0233126.r001</article-id><title-group><article-title>Decision Letter 0</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wen</surname><given-names>Tzai-Hung</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2020 Tzai-Hung Wen</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Tzai-Hung Wen</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0233126" related-article-type="reviewed-article"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>0</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="letter-date">31 Jan 2020</named-content>
</p><p>PONE-D-19-34966</p><p>Robust Two-stage Influenza Prediction Model considering Regular and Irregular Trends</p><p>PLOS ONE</p><p>Dear Mr. Murayama,</p><p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE&#x02019;s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p><p>We would appreciate receiving your revised manuscript by Mar 16 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p><p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p><p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p><p>Please include the following items when submitting your revised manuscript:</p><p><list list-type="bullet"><list-item><p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p></list-item><list-item><p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p></list-item><list-item><p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p></list-item></list></p><p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p><p>We look forward to receiving your revised manuscript.</p><p>Kind regards,</p><p>Tzai-Hung Wen, Ph.D.</p><p>Academic Editor</p><p>PLOS ONE</p><p>Journal Requirements:</p><p>When submitting your revision, we need you to address these additional requirements:</p><p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/attachments/PLOSOne_formatting_sample_main_body.pdf">http://www.plosone.org/attachments/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/attachments/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.plosone.org/attachments/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p><p>2. In your Methods section, please include additional information about your dataset and ensure that you have included a statement specifying whether the collection method complied with the terms and conditions for the website.</p><p>3. Thank you for stating the following financial disclosure:</p><p>"This study was supported in part by JSPS KAKENHI Grant Number JP19K20279, Health and Labor Sciences Research Grant Number H30-shinkougyousei-shitei-004, and Yahoo! Japan.</p><p>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript."</p><p>We note that one or more of the authors is affiliated with the funding organization, indicating the funder may have had some role in the design, data collection, analysis or preparation of your manuscript for publication; in other words, the funder played an indirect role through the participation of the co-authors. If the funding organization did not play a role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript and only provided financial support in the form of authors' salaries and/or research materials, please do the following:</p><p><list list-type="order"><list-item><p>Review your statements relating to the author contributions, and ensure you have specifically and accurately indicated the role(s) that these authors had in your study. These amendments should be made in the online form.</p></list-item><list-item><p>Confirm in your cover letter that you agree with the following statement, and we will change the online submission form on your behalf:</p></list-item></list></p><p>&#x0201c;The funder provided support in the form of salaries for authors [insert relevant initials], but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the &#x02018;author contributions&#x02019; section.&#x0201d;</p><p>3. Thank you for stating the following in the Financial Disclosure section:</p><p>"This study was supported in part by JSPS KAKENHI Grant Number JP19K20279, Health and Labor Sciences Research Grant Number H30-shinkougyousei-shitei-004, and Yahoo! Japan.</p><p>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript."</p><p>We note that you received funding from a commercial source: Yahoo Japan Corporation</p><p>Please provide an amended Competing Interests Statement that explicitly states this commercial funder, along with any other <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/competing.action">relevant declarations</ext-link> relating to employment, consultancy, patents, products in development, marketed products, etc.</p><p>Within this Competing Interests Statement, please confirm that this does not alter your adherence to all PLOS ONE policies on sharing data and materials by including the following statement: "This does not alter our adherence to PLOS ONE policies on sharing data and materials.&#x0201d; (as detailed online in our guide for authors <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/competing-interests">http://journals.plos.org/plosone/s/competing-interests</ext-link>). &#x000a0;If there are restrictions on sharing of data and/or materials, please state these. Please note that we cannot proceed with consideration of your article until this information has been declared.</p><p>Please include your amended Competing Interests Statement within your cover letter. We will change the online submission form on your behalf.</p><p>[Note: HTML markup is below. Please do not edit.]</p><p>Reviewers' comments:</p><p>Reviewer's Responses to Questions</p><p>5. Review Comments to the Author</p><p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p><p>Reviewer #1: The manuscript entitled &#x0201c;Robust Two-stage Influenza Prediction Model considering Regular and Irregular Trends&#x0201d; attempt to integrate time-series analysis and machine learning approaches to capture both regular trend and irregular patterns of influenza outbreaks. This is a well-written article and the result shows a promising direction for outbreak prediction of influenza.</p><p>Below are major issues</p><p>1. Page 5, Lines 131. Is there any reason to support the selection of AR(26)?</p><p>2. Figure 4. When comparing the difference values of each model, ARGO demonstrated a different direction of the deviance comparing to two-stage model and Random Forest approach. Is there any interpretation for the phenomena?</p><p>3. The result and discussion mainly focus on the performance comparison of different models. The content of discussion seems missed in this part. It&#x02019;s better to add more detail discussion with previous literature in the manuscript.</p><p>Reviewer #2: The manuscript entitled &#x0201d;Robust Two-stage influenza Prediction Model considering Regular and Irregular Trends&#x0201d; constructed a new Two-stage model to make real-time influenza forecasts based on the surveillance data and the google trend data in US and Japan. The manuscript is well organized, and the purpose of the work is clearly defined. Although the rationale of the approach presented is generally understandable, some points should be further clarified and described well.</p><p>My major concern is about the methods. Methods section lacks enough description of the main procedures of the Two-stage model. Very few words were used to describe the model. Author said &#x0201c;We designate the combination of the 1st Model and the 2nd Model as the Two-stage Model&#x0201d;, but how were these 2 models combined isn&#x02019;t described. More details are needed to illustrate how to combine the two model&#x02019;s results to obtain the final prediction value. Does the proposed approach only add the two models&#x02019; results? Or with any weights?</p><p>Also, how model 2 works with model 1&#x02019;s outcome is not described. Eq(2) is not enough to understand how ILI rate from model 1 outcome can be used for model 2. Although &#x0201c;xt and ot-1 denote a current input and previous output vectors&#x02026;&#x0201d; is described, what actual data are x and o, and how these variables correspond to ILI rate results from model 1.</p><p>Other minor comments are</p><p>- for Introduction</p><p>The introduction section should look like a concise summary of the research topic. I suggest the authors could show some previous studies' outstanding achievements based on the hospital surveillance data and UGC data (e.g. the quantity comparison of forecasting results based on the historical data and UGC data) rather than only explain the datasets.</p><p>On Page2, Ln 19, cite some particle filtering approaches done by Yang W and Shaman J for influenza forecasting.</p><p>On page 2, Ln 42, &#x0201c;We also think that our model is strong against noise and outliers in data&#x0201d;. Please change the work &#x0201c;think&#x0201d; to other words and describe your analytical results to support your statement. People think is not enough to support this conclusion.</p><p>- for Methods</p><p>What are the search queries used? Letting readers know these, e.g., by including it in supplementary materials, would be good.</p><p>Additionally, the merits of choosing ILI rate for US data and ILI patients for JPN data is not very clear to me.</p><p>Some variables in eq(2) are not expounded and need to be so.</p><p>- for Results</p><p>The mechanism shown as Figure 2 should be described in more details. I assume the solid black line represent the previous historical data. Then author should describe all the remaining dots (2 blue dots, one black, one red) following the order of the steps. For example, does left blue dot (prediction from the 1st model) occur before the above black dot. How is the 2nd blue dot predicted? And how is the red dot predicted? Why there is not red dot above the 1st left blue dot? Please describe the scenario more.</p><p>In Table 1, why the periods in training using Model1 and Model2 are different. Should both models use the same periods for training?</p><p>- for Robustness</p><p>The values given in parentheses are the difference of accuracy scores between the original data and processed data with outliers processed data. Please describe more details what is processed data and how did author process the data.</p><p>- for Conclusions</p><p>- on the sentence "The model presented herein might not work well in some countries": if the authors decide to include this sentence, they should preferably give clear reasons why and how the model can be made to work in such countries.</p><p>**********</p><p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p><p>If you choose &#x0201c;no&#x0201d;, your identity will remain anonymous but your review may still be made public.</p><p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p><p>Reviewer #1: No</p><p>Reviewer #2: No</p><p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p><p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p></body></sub-article><sub-article id="pone.0233126.r002" article-type="author-comment"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0233126.r002</article-id><title-group><article-title>Author response to Decision Letter 0</article-title></title-group><related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0233126" related-article-type="editor-report"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>1</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="author-response-date">18 Mar 2020</named-content>
</p><p>To the reviewr and editors:</p><p>Please check our Response to Reviewers file (rebuttal letter), in which we described responses to the editor and review's comments in detail.</p><p>Add the detailed comments about backing revisions to cover letter.</p><supplementary-material content-type="local-data" id="pone.0233126.s003"><label>Attachment</label><caption><p>Submitted filename: <named-content content-type="submitted-filename">rebuttal_letter_plos_one2020.pdf</named-content></p></caption><media xlink:href="pone.0233126.s003.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></body></sub-article><sub-article id="pone.0233126.r003" article-type="aggregated-review-documents"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0233126.r003</article-id><title-group><article-title>Decision Letter 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wen</surname><given-names>Tzai-Hung</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2020 Tzai-Hung Wen</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Tzai-Hung Wen</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0233126" related-article-type="reviewed-article"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>1</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="letter-date">29 Apr 2020</named-content>
</p><p>Robust Two-stage Influenza Prediction Model considering Regular and Irregular Trends</p><p>PONE-D-19-34966R1</p><p>Dear Dr. Murayama,</p><p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p><p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p><p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p><p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p><p>With kind regards,</p><p>Tzai-Hung Wen, Ph.D.</p><p>Academic Editor</p><p>PLOS ONE</p><p>Additional Editor Comments (optional):</p><p>Reviewers' comments:</p><p>Reviewer's Responses to Questions</p><p><bold>Comments to the Author</bold></p><p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the &#x0201c;Comments to the Author&#x0201d; section, enter your conflict of interest statement in the &#x0201c;Confidential to Editor&#x0201d; section, and submit your "Accept" recommendation.</p><p>Reviewer #1: All comments have been addressed</p><p>Reviewer #2: All comments have been addressed</p><p>**********</p><p>2. Is the manuscript technically sound, and do the data support the conclusions?</p><p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p><p>Reviewer #1: Yes</p><p>Reviewer #2: Yes</p><p>**********</p><p>3. Has the statistical analysis been performed appropriately and rigorously? </p><p>Reviewer #1: Yes</p><p>Reviewer #2: Yes</p><p>**********</p><p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p><p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#x02014;e.g. participant privacy or use of data from a third party&#x02014;those must be specified.</p><p>Reviewer #1: Yes</p><p>Reviewer #2: Yes</p><p>**********</p><p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p><p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p><p>Reviewer #1: Yes</p><p>Reviewer #2: Yes</p><p>**********</p><p>6. Review Comments to the Author</p><p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p><p>Reviewer #1: (No Response)</p><p>Reviewer #2: (No Response)</p><p>**********</p><p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p><p>If you choose &#x0201c;no&#x0201d;, your identity will remain anonymous but your review may still be made public.</p><p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p><p>Reviewer #1: No</p><p>Reviewer #2: Yes: Hsiang-Yu Yuan</p></body></sub-article><sub-article id="pone.0233126.r004" article-type="editor-report"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0233126.r004</article-id><title-group><article-title>Acceptance letter</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wen</surname><given-names>Tzai-Hung</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2020 Tzai-Hung Wen</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Tzai-Hung Wen</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0233126" related-article-type="reviewed-article"/></front-stub><body><p>
<named-content content-type="letter-date">5 May 2020</named-content>
</p><p>PONE-D-19-34966R1 </p><p>Robust Two-stage Influenza Prediction Model considering Regular and Irregular Trends </p><p>Dear Dr. Murayama:</p><p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p><p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p><p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p><p>Thank you for submitting your work to PLOS ONE.</p><p>With kind regards,</p><p>PLOS ONE Editorial Office Staff</p><p>on behalf of</p><p>Dr. Tzai-Hung Wen </p><p>Academic Editor</p><p>PLOS ONE</p></body></sub-article></article>