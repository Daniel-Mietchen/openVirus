<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue http://null/schema/dtds/document/fulltext/xcr/xocs-article.xsd?><?DTDIdentifier.IdentifierType schema?><?SourceDTD.DTDName xocs-article.xsd?><?SourceDTD.Version 1.0?><?ConverterInfo.XSLTName ftrr2jats.xsl?><?ConverterInfo.Version 1?><?origin publisher?><front><journal-meta><journal-id journal-id-type="nlm-ta">Commun Nonlinear Sci Numer Simul</journal-id><journal-id journal-id-type="iso-abbrev">Commun Nonlinear Sci Numer Simul</journal-id><journal-title-group><journal-title>Communications in Nonlinear Science &#x00026; Numerical Simulation</journal-title></journal-title-group><issn pub-type="ppub">1007-5704</issn><issn pub-type="epub">1878-7274</issn><publisher><publisher-name>Elsevier B.V.</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">7129978</article-id><article-id pub-id-type="publisher-id">S1007-5704(20)30062-9</article-id><article-id pub-id-type="doi">10.1016/j.cnsns.2020.105228</article-id><article-id pub-id-type="publisher-id">105228</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Topological data analysis to model the shape of immune responses during co-infections</article-title></title-group><contrib-group><contrib contrib-type="author" id="au0001"><name><surname>Sasaki</surname><given-names>Karin</given-names></name><xref rid="aff0001" ref-type="aff">a</xref></contrib><contrib contrib-type="author" id="au0002"><name><surname>Bruder</surname><given-names>Dunja</given-names></name><xref rid="aff0004" ref-type="aff">d</xref><xref rid="aff0005" ref-type="aff">e</xref></contrib><contrib contrib-type="author" id="au0003"><name><surname>Hernandez-Vargas</surname><given-names>Esteban A.</given-names></name><email>esteban@im.unam.mx</email><xref rid="cor0001" ref-type="corresp">&#x0204e;</xref><xref rid="aff0001" ref-type="aff">a</xref><xref rid="aff0002" ref-type="aff">b</xref><xref rid="aff0003" ref-type="aff">c</xref></contrib><aff id="aff0001"><label>a</label>Frankfurt Institute for Advanced Studies, Frankfurt am Main 60438, Germany</aff><aff id="aff0002"><label>b</label>Instituto de Matematicas, UNAM, Unidad Juriquilla, Blvd. Juriquilla 3001, Queretaro C.P. 76230, Mexico</aff><aff id="aff0003"><label>c</label>Xidian-FIAS Joint Research Center, Germany-China</aff><aff id="aff0004"><label>d</label>Infection Immunology Group, Institute of Medical Microbiology, Infection Prevention and Control, Health Campus Immunology, Infectiology and Inflammation Otto-von-Guericke University Magdeburg, Germany</aff><aff id="aff0005"><label>e</label>Immune Regulation Group, Helmholtz Centre for Infection Research, Braunschweig, Germany</aff></contrib-group><author-notes><corresp id="cor0001"><label>&#x0204e;</label>Corresponding author at: Frankfurt Institute for Advanced Studies, 60438 Frankfurt am Main, Germany. <email>esteban@im.unam.mx</email></corresp></author-notes><pub-date pub-type="pmc-release"><day>15</day><month>2</month><year>2020</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.--><pub-date pub-type="ppub"><month>6</month><year>2020</year></pub-date><pub-date pub-type="epub"><day>15</day><month>2</month><year>2020</year></pub-date><volume>85</volume><fpage>105228</fpage><lpage>105228</lpage><history><date date-type="received"><day>7</day><month>10</month><year>2019</year></date><date date-type="rev-recd"><day>17</day><month>1</month><year>2020</year></date><date date-type="accepted"><day>11</day><month>2</month><year>2020</year></date></history><permissions><copyright-statement>&#x000a9; 2020 Elsevier B.V. All rights reserved.</copyright-statement><copyright-year>2020</copyright-year><copyright-holder/><license><license-p>Since January 2020 Elsevier has created a COVID-19 resource centre with free information in English and Mandarin on the novel coronavirus COVID-19. The COVID-19 resource centre is hosted on Elsevier Connect, the company's public news and information website. Elsevier hereby grants permission to make all its COVID-19-related research that is available on the COVID-19 resource centre - including this research content - immediately available in PubMed Central and other publicly funded repositories, such as the WHO COVID database with rights for unrestricted research re-use and analyses in any form or by any means with acknowledgement of the original source. These permissions are granted for free by Elsevier for as long as the COVID-19 resource centre remains active.</license-p></license></permissions><abstract abstract-type="author-highlights" id="absh001"><title>Highlights</title><p><list list-type="simple" id="lst0003"><list-item id="lstitem0001"><label>&#x02022;</label><p id="p0001">The mapper algorithm is a topological data analysis technique used for the qualitative analysis of biological data.</p></list-item><list-item id="lstitem0002"><label>&#x02022;</label><p id="p0002">Simplification and visualisation of high dimensional data sets and nonlinearities.</p></list-item><list-item id="lstitem0003"><label>&#x02022;</label><p id="p0003">We find persistent shapes of the data in the three infection scenarios.</p></list-item></list></p></abstract><abstract id="abs0001"><p>Co-infections by multiple pathogens have important implications in many aspects of health, epidemiology and evolution. However, how to disentangle the non-linear dynamics of the immune response when two infections take place at the same time is largely unexplored. Using data sets of the immune response during influenza-pneumococcal co-infection in mice, we employ here topological data analysis to simplify and visualise high dimensional data sets.</p><p>We identified persistent shapes of the simplicial complexes of the data in the three infection scenarios: single viral infection, single bacterial infection, and co-infection. The immune response was found to be distinct for each of the infection scenarios and we uncovered that the immune response during the co-infection has three phases and two transition points. During the first phase, its dynamics is inherited from its response to the primary (viral) infection. The immune response has an early shift (few hours post co-infection) and then modulates its response to react against the secondary (bacterial) infection. Between 18 and 26&#x000a0;h post co-infection the nature of the immune response changes again and does no longer resembles either of the single infection scenarios.</p></abstract><kwd-group id="keys0001"><title>Keywords</title><kwd>Topological data analysis</kwd><kwd>Immune system dynamics</kwd><kwd>Influenza infections</kwd><kwd>Complex data analysis</kwd></kwd-group></article-meta></front><body><sec id="sec0001"><label>1</label><title>Introduction</title><p id="p0004">Epidemics by infectious pathogens are a major threat to humankind. Viruses such as coronavirus, HIV, influenza, and ebola have caused the largest pandemics in the 20th century. A major problem is the simultaneous infection of a host by two or more pathogens (co-infection). We are continuously exposed to multiple potential pathogens; many people are chronically (e.g. HIV) or latently (e.g. herpes viruses) infected, and we all carry potential pathogens in our colonising microbial flora. This means that nearly every new infection is some sort of co-infection, and globally, co-infections are the norm rather than the exception <xref rid="bib0001" ref-type="bibr">[1]</xref>.</p><p id="p0005">There is an impressive number of combinations of pathogens that derive synergy from contemporaneous infection of a host. These include viral-bacterial (e.g. influenza with pneumococcus or HIV with Mycobacterium tuberculosis), viral-viral (e.g. Hepatitis B with Hepatitis C), bacterial-bacterial (e.g. Borrelia burgdorferi with Anaplasma phagocytophila in Tick-borne illnesses) and pathogen-pathogen (e.g. Malaria with Dengue, Chikungunya, Filaria or Helminth) co-infections, to name a few. Although most studies to date have been focused on co-infections between two pathogens, infections with multiple pathogens are now becoming active topics of research <xref rid="bib0002" ref-type="bibr">[2]</xref>.</p><p id="p0006">Co-infections have effects on health at multiple levels: Co-infections can increase or decrease the rate of transmission of other infections <xref rid="bib0003" ref-type="bibr">[3]</xref>, modulate the host immune response <xref rid="bib0004" ref-type="bibr">[4]</xref>, create protection and resilience or susceptibility to further infections <xref rid="bib0005" ref-type="bibr">[5]</xref>, <xref rid="bib0006" ref-type="bibr">[6]</xref>, alter the performance of diagnostic tests and antimicrobial chemotherapy <xref rid="bib0007" ref-type="bibr">[7]</xref>, <xref rid="bib0008" ref-type="bibr">[8]</xref>, and even create opportunities for the emergence of new pathogens <xref rid="bib0009" ref-type="bibr">[9]</xref>, <xref rid="bib0010" ref-type="bibr">[10]</xref>. In other words, some co-infections can have detrimental, or even beneficial, outcomes.</p><p id="p0007">The harmful effects of chronic co-infections, such as tuberculosis or Hepatitis B and C in association with HIV for example, are well established. However, generally and especially in acute infections, the mechanisms of co-pathogens with the host immune system and the possible consequences, ranging from insignificant, harmful or beneficial, are still largely unknown and difficult to dissect. The development of mathematical approaches that characterise the immune responses in the host have offered important steps for studying pathogen - pathogen interactions <xref rid="bib0011" ref-type="bibr">[11]</xref>. Interpretation of data sets with modern mathematical and machine-learning strategies can provide a comprehensive understanding of co-infections and their relevance/significance.</p><p id="p0008">Topological Data Analysis (TDA) is a collection of computational tools derived from the mathematical subject of Algebraic Topology, that can help in identifying the behaviour of a biological system from a global perspective, guide detailed quantitative investigations and aid tailor further experimental settings. In fact, algorithms from topological data analysis have started to play important roles in novel interdisciplinary fields in biomedical sciences, including cancer genomics <xref rid="bib0012" ref-type="bibr">[12]</xref>, diabetes <xref rid="bib0013" ref-type="bibr">[13]</xref>, neuroscience <xref rid="bib0014" ref-type="bibr">[14]</xref>, infectious diseases <xref rid="bib0015" ref-type="bibr">[15]</xref>, <xref rid="bib0016" ref-type="bibr">[16]</xref>, and in biology in general <xref rid="bib0017" ref-type="bibr">[17]</xref>, <xref rid="bib0018" ref-type="bibr">[18]</xref>.</p><p id="p0009">Among the different TDA techniques for the qualitative analysis, the mapper algorithm <xref rid="bib0019" ref-type="bibr">[19]</xref> has shown a potential to simplify and visualize high dimensional data sets. It generates a simple description of the data in the form of a combinatorial object called a <italic>simplicial complex</italic>, that captures topological and geometric information of the point cloud in high dimensional space. The algorithm uses a (combination of) function(s) that map the data to a metric space, and builds an informative representation based on the clustering of subsets (which are associated to the values of the function(s)) of the data set. In the simplest case, this method reduces high dimensional data sets to a network whose nodes correspond to clusters in the data and edges to the existence of points in common between clusters. The aim of this algorithm is not to obtain a fully accurate representation of a data set, but rather a low-dimensional image which can highlight areas of interest, possibly for further analysis and quantification.</p><p id="p0010">Motivated by the obvious potential of topological investigations in biomedical sciences, in the present study we seek to understand the evolution of the immune system as it responds to co-infection between virus and bacteria. Mathematical modeling research in influenza-pneumococcal co-infections has been a growing field within last years <xref rid="bib0004" ref-type="bibr">[4]</xref>, <xref rid="bib0020" ref-type="bibr">[20]</xref>, <xref rid="bib0021" ref-type="bibr">[21]</xref>, <xref rid="bib0022" ref-type="bibr">[22]</xref>, <xref rid="bib0023" ref-type="bibr">[23]</xref>. These previous approaches are based on differential equations constructed based on biological reasoning. While they are suitable tools to test different hypothesis, and have helped elucidate many of the details of the mechanisms of these intricate systems, these models are susceptible to bias by the designer and model complexity rapidly limits the reliability in the parameter fitting procedures <xref rid="bib0024" ref-type="bibr">[24]</xref>. In contrast, TDA is a tool that detects true patterns in the data, without imposing artificial assumptions.</p><p id="p0011">Here, we use the co-infection data sets from <xref rid="bib0004" ref-type="bibr">[4]</xref> where we investigated the hierarchical effects of pro-inflammatory cytokines on the post-influenza susceptibility to pneumococcal co-infection by assessing the early and late kinetics of pro-inflammatory cytokines in the respiratory tract. In the experimental part of this study mice were divided into three groups and given either a single viral infection (with IAV strain A/PR8/34), a single bacterial infection (S. pneumoniae strain T4) or a co-infection (IAV + T4). The experimental readouts were the bacterial burden, viral titers and cytokine concentrations in the lung. Our previous work <xref rid="bib0004" ref-type="bibr">[4]</xref> used mathematical modelling that suggested a detrimental role of IFN-<italic>&#x003b3;</italic> alone and in synergism with IL-6 and TNF-<italic>&#x003b1;</italic> in impaired bacterial clearance. We now use the mapper algorithm to investigate the global shape of the immune response under the three above infection scenarios, illustrated in <xref rid="fig0001" ref-type="fig">Fig.&#x000a0;1</xref>
.<fig id="fig0001"><label>Fig. 1</label><caption><p><bold>Predictions about the behaviour of the immune system in response to co-pathogenesis in the lung.</bold> Topological data analysis and nearest neighbour analysis reveal that initially the immune system inherits its behaviour from its response to the primary infection; it goes through a swift transition early in the co-infection (i.e. soon after the onset of the secondary infection) and it is consequently and temporarily driven mainly by its response to the secondary infection. There is a second transition point in the behaviour of the immune system and from there, it no longer resembles a standard response associated to either of the two single infections, but rather it shapes its behaviour to respond to the co-infection itself.</p></caption><alt-text id="at0001">Fig. 1</alt-text><graphic xlink:href="gr1_lrg"/></fig><fig id="fig0002"><label>Fig. 2</label><caption><p><bold>Visualisation of the steps of the mapper algorithm being applied to a set of points sampled from the 2-dimensional circle.</bold> Parameter <italic>p</italic> in the function used as a lens is the leftmost point in the data. Example adapted from <xref rid="bib0019" ref-type="bibr">[19]</xref>.</p></caption><alt-text id="at0002">Fig. 2</alt-text><graphic xlink:href="gr2_lrg"/></fig></p></sec><sec id="sec0002"><label>2</label><title>Topological data analysis</title><p id="p0012">In this section we give a brief and intuitive introduction to the mapper algorithm and the algebraic topology concepts behind it. We also present in detail our methodology for using the mapper algorithm to investigate influenza in co-infection with bacteria. For further details, we refer the reader to the following resources: the original paper of the mapper algorithm is <xref rid="bib0019" ref-type="bibr">[19]</xref>; the paper presenting the Kepler-Mapper Python Library that we used to implement the mapper algorithm computationally is <xref rid="bib0025" ref-type="bibr">[25]</xref>; we also recommend <xref rid="bib0026" ref-type="bibr">[26]</xref> as an introductory book to computational algebraic topology (albeit it does not include the mapper algorithm) and <xref rid="bib0027" ref-type="bibr">[27]</xref> for a thorough treatment of the mathematical subject of algebraic topology.</p><sec id="sec0003"><label>2.1</label><title>The mapper algorithm</title><p id="p0013">The mapper algorithm is a method of replacing a topological space by a simpler one, known as a <italic>simplicial complex</italic>, which captures topological and geometric features of the original space. The purpose of doing this is not only to obtain a visualization of high dimensional data sets in 3-d, but also because mathematical properties of simplicial complexes allow for the implementation of algebraic calculations that facilitate the classification of the topological features of the complex, and by extension, of the original topological space.</p><p id="p0014">The algorithm begins with a data set of interest that consists of a point cloud <italic>X</italic> containing <italic>N</italic> points <italic>x</italic>&#x000a0;&#x02208;&#x000a0;<italic>M</italic> sampled from a space <italic>M</italic> whose topology we want to elucidate. We define a real valued function <italic>f: X</italic>&#x000a0;&#x02192;&#x000a0;<italic>R</italic> (<italic>f</italic> is referred in the literature as a <italic>lens</italic> or <italic>filter</italic>) whose value is known for the <italic>N</italic> data points. Next, we find the range <italic>I</italic> of the function <italic>f</italic> that is restricted to the points in <italic>X</italic>. We divide this range into a set <italic>S</italic> of smaller intervals of the same size, that overlap. This results in two parameters that can be used to control how detailed a representation of the data, i.e. the &#x0201c;resolution&#x0201d;, namely the number <italic>l</italic> of the smaller intervals and the percentage overlap <italic>q</italic> between successive intervals.</p><p id="p0015">For each interval <italic>I<sub>j</sub></italic>&#x000a0;&#x02208;&#x000a0;<italic>S</italic>, we find the set <inline-formula><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> i.e. the points in X that form its domain. For each set <italic>X<sub>j</sub></italic> we form clusters {<italic>X<sub>jk</sub></italic>}, where <italic>x<sub>k</sub></italic>&#x000a0;&#x02208;&#x000a0;<italic>X<sub>j</sub></italic> and <inline-formula><mml:math id="M2" altimg="si2.svg"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak">&#x0003e;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We treat each cluster as a vertex in the resulting simplicial complex and draw an edge between vertices whenever <italic>X<sub>jk</sub></italic>&#x02009;&#x02229;&#x02009;<italic>X<sub>lm</sub></italic>&#x000a0;&#x02260;&#x000a0;&#x02205;, for <italic>X<sub>jk</sub></italic>&#x000a0;&#x02260;&#x000a0;<italic>X<sub>lm</sub></italic> (i.e. when different clusters have non-empty intersection). <xref rid="fig0002" ref-type="fig">Fig.&#x000a0;2</xref> illustrates these steps for the construction of a topological network from data sampled from a 2-dimensional circle. The steps are implemented computationally using the Kepler mapper python library <xref rid="bib0025" ref-type="bibr">[25]</xref>.</p></sec><sec id="sec0004"><label>2.2</label><title>Simplicial complexes</title><p id="p0016">To arrive at a precise definition of a simplicial complex and to understand it is not required for the context of this paper. Instead, here it is sufficient to think of simplicial complexes as a generalisation of networks that include higher dimensional elements. That is, simplicial complexes can be thought of as combinatorial objects consisting of vertices (0-d), edges (1-d), triangles (2-d), tetrahedra (&#x0201c;triangular pyramid&#x0201d;) (3-d) and higher-dimensional (<italic>n</italic>-d for <inline-formula><mml:math id="M3" altimg="si3.svg"><mml:mrow><mml:mi>n</mml:mi><mml:mo linebreak="goodbreak">&#x0003e;</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) convex polyhedra. <xref rid="fig0003" ref-type="fig">Fig.&#x000a0;3</xref>
illustrates this visually with a simple example. In practical terms, as described in <xref rid="bib0019" ref-type="bibr">[19]</xref>, &#x0201c;using a single function as a filter we get as output a complex in which the highest dimension of simplices is 1 (edges in a graph). Qualitatively, the only information we get out of this is the number of components, the number of loops and knowledge about&#x0201d; local and global component structure. &#x0201c;One natural way of building higher dimensional complexes is to associate many functions with each data point instead of just one.&#x0201d; In particular, &#x0201c;the dimension of simplices which we use to construct the complex&#x0201d; associated to two lenses &#x0201c;will be 4 or less&#x0201d; (depending on the covering of choice).<fig id="fig0003"><label>Fig. 3</label><caption><p><bold>A simple simplicial complex.</bold> A simplicial complex can be thought of as a generalisation of a network, that also includes triangles, tetrahedra and higher dimensional convex polyhedra.</p></caption><alt-text id="at0003">Fig. 3</alt-text><graphic xlink:href="gr3_lrg"/></fig></p><p id="p0017">In practical terms regarding the mapper algorithm, when we use one lens to construct a simplicial complex, the maximum dimension of the simplices is 1, i.e. the complex is made up of vertices and edges and is thus a standard network. When we use two lenses to construct a simplicial complex, the maximum possible dimension of the simplices is 4, meaning it is made of vertices, edges, triangles and tetrahedra. <xref rid="sec0015" ref-type="sec">Section&#x000a0;3.2</xref> in the original paper of the mapper algorithm <xref rid="bib0019" ref-type="bibr">[19]</xref> describes explicitly how simplicial complexes are built with 2 lenses and how this can be generalised to more lenses and higher dimensional simplicial complexes.</p></sec><sec id="sec0005"><label>2.3</label><title>Choosing the metric space(s)</title><p id="p0018">The important aspect about the choice of metric for the purposes of the mapper algorithm is to have a notion of distance between two data points.</p><p id="p0019">Although the mapper algorithm is less sensitive to the choice of metric than other methods that aim at creating simpler representative objects of spaces in high dimensions (e.g. dimensionality reduction algorithms) <xref rid="bib0019" ref-type="bibr">[19]</xref> we still wanted to make sure that our investigation was not biased by the choice of metric. Therefore we tested three metrics that &#x0201c;appeared suitable&#x0201d; for our data sets. These were the Euclidean, cosine and correlation metrics. We chose the Euclidean metric as it is the most intuitive to work with. Next, we wanted to investigate whether looping is a recurrent property in our data sets. In <xref rid="bib0015" ref-type="bibr">[15]</xref>, where looping was indeed found to be a motif in their data set (of an infection from which patients can recover, such as in our study), the cosine metric was used, so we also decided to test this metric. Finally, we regarded the correlation metric to make the most biological sense. So we also tested this one.</p><p id="p0020">Specifically, the distance is defined as follows for the three metrics we work with:</p><p id="p0021">
<bold>Euclidean:</bold> if <inline-formula><mml:math id="M4" altimg="si4.svg"><mml:mrow><mml:mi>x</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M5" altimg="si5.svg"><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> are two points in Euclidean <italic>n</italic>-space, then the Euclidean distance between them is given by the Pythagorean formula:<disp-formula id="ueq0001"><mml:math id="M6" altimg="si6.svg"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula>
</p><p id="p0022">Computationally, this is done using the sklearn.metrics.pairwise.euclidean_distances function from Scikit-learn.</p><p id="p0023">
<bold>Cosine:</bold> if <inline-formula><mml:math id="M7" altimg="si4.svg"><mml:mrow><mml:mi>x</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M8" altimg="si5.svg"><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> are two points in Euclidean <italic>n</italic>-space, we use the following bespoke distance definition:<disp-formula id="ueq0002"><mml:math id="M9" altimg="si7.svg"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>.</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02225;</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mo>&#x02225;</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo linebreak="badbreak">&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
</p><p id="p0024">Where <italic>x.y</italic> is the dot product between <italic>x</italic> and <italic>y</italic> and ||<italic>u</italic>||<sub>2</sub> is the L2-norm (Euclidean norm) of <italic>u</italic>. This definition is of the absolute value of the normalised dot product of <italic>x</italic> and <italic>y</italic> minus 1. The reason we take this definition and, not simply the normalised dot product, is the following: The normalised dot product of any two points takes values between +1 and &#x02212;1. We want to cluster points whose vectors from the origin are almost parallel and point almost in the same direction. Two such points have a normalised dot product value that is close to +1. However, DBSCAN clusters two points whenever they are a distance less than or equal to the eps parameter. (The eps parameter is the maximum distance between two samples for them to be considered as in the same neighbourhood). Therefore, what we need is a distance formula that outputs small values for points that are &#x0201c;close&#x0201d; to each other (i.e. whose vectors from the origin point in roughly the same direction). The above bespoke distance formula achieves this. In order to implement this computationally, we precompute the distance matrix of the data using the normalised dot product with the sklearn.metrics.pairwise.cosine_similarity function of sklearn, next, we preprocess the distance matrix such that it fits our bespoke distance criterion:</p><p id="p0025">
X_cosine_similarity&#x000a0;=&#x000a0;sklearn.metrics.pairwise.cosine_similarity(X)
</p><p id="p0026">
X_dist&#x000a0;=&#x000a0;np.abs(X_cosine_similarity&#x000a0;-&#x000a0;1)
</p><p id="p0027">Finally, we pass the precomputed distance matrix to the clusterer, setting the metric parameter of DBSCAN to be equal to &#x02018;precomputed&#x02019;.</p><p id="p0028">
<bold>Correlation:</bold> if <inline-formula><mml:math id="M10" altimg="si4.svg"><mml:mrow><mml:mi>x</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M11" altimg="si5.svg"><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> are two points in Euclidean <italic>n</italic>-space, then the correlation distance between them is given by the following formula:<disp-formula id="ueq0003"><mml:math id="M12" altimg="si8.svg"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="goodbreak">&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>&#x02225;</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02225;</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
</p><p id="p0029">Where <italic>u.v</italic> is the dot product between <italic>u</italic> and <italic>v</italic>, <inline-formula><mml:math id="M13" altimg="si9.svg"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> is the mean of the elements of <italic>u</italic> and ||<italic>u</italic>||<sub>2</sub> is the L2-norm (the Euclidean norm) of <italic>u</italic>. Computationally, this is done using the sklearn.metrics.pairwise_distances function from Scikit-learn, setting the parameter metric to &#x02018;correlation&#x02019;.</p><p id="p0031">In the main part of this study we only reported the results obtained with the correlation metric. We observed the same results with the correlation and cosine metrics and we could not make concrete observations about the result obtained with the Euclidean metric. The questions of why the cosine and correlation metrics create the same simplicial complexes and how they differ from those created with the Euclidean metric require further investigations that were not done as part of this study.</p></sec><sec id="sec0006"><label>2.4</label><title>Selection of lenses</title><p id="p0032">The outcome of the mapper algorithm is highly dependent on the lens(es) chosen. For the purposes of our study, we categorised the lenses we used according to the information about the data they extract:<list list-type="simple" id="lst0004"><list-item id="lstitem0004"><p id="p0033">
<bold>Features.</bold> These lenses are simply the values at each data point of a particular feature of interest. These were calculated using the fit_transform function of the Kepler mapper.</p></list-item><list-item id="lstitem0005"><p id="p0034">
<bold>Distances to closest neighbours.</bold> These lenses report the distance of each data point to its <italic>n</italic> closest neighbours, or the sum of the distances to the <italic>n</italic> closest neighbours, under the metric of choice. These were calculated using the sklearn.metrics.pairwise_distances function from Scikit-learn, specifying the metric to be one of the three described above.</p></list-item><list-item id="lstitem0006"><p id="p0035">
<bold>Dimensionality Reduction.</bold> These are projections of the data, usually, to the first (and possibly also the second) dimension(s) of various dimensionality reduction algorithms. These were calculated using the <ext-link ext-link-type="uri" xlink:href="https://scikit-learn.org/stable/modules/manifold.html" id="intrrf0001">Manifold Learning algorithms</ext-link> from the Scikit-learn Python library and the sklearn.decomposition.PCA and sklearn.decomposition.TruncatedSVD functions of Scikit-learn. See <xref rid="sec0007" ref-type="sec">Section&#x000a0;2.4.1</xref> for a brief description of the methods used here.</p></list-item><list-item id="lstitem0007"><p id="p0036">
<bold>Geometric properties.</bold> These report geometric properties. Specifically, we tested:<list list-type="simple" id="lst0005"><list-item id="lstitem0008"><p id="p0037">&#x02013; The density using the sklearn.neighbors.KernelDensity function with Gaussian kernel and calculated the bandwidth using Scott&#x02019;s Rule <xref rid="bib0028" ref-type="bibr">[28]</xref>.</p></list-item><list-item id="lstitem0009"><p id="p0038">&#x02013; The eccentricity which is defined as follows:</p><p id="p0039">Given <italic>p</italic> with <inline-formula><mml:math id="M14" altimg="si10.svg"><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak">&#x0003c;</mml:mo><mml:mo>+</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> define<disp-formula id="ueq0004"><mml:math id="M15" altimg="si11.svg"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi></mml:msup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac></mml:msup></mml:mrow></mml:math></disp-formula>where <italic>x, y</italic>&#x000a0;&#x02208;&#x000a0;<italic>X</italic>. (Recall that we denote the data set of <italic>N</italic> points by <italic>X</italic> and <italic>d</italic>(<italic>x, y</italic>) denotes the distance between <italic>x, y</italic>&#x000a0;&#x02208;&#x000a0;<italic>X</italic>, which is dependent on the metric of choice.)</p></list-item><list-item id="lstitem0010"><p id="p0040">&#x02013; The infinite centrality which is a generalisation of the eccentricity above, for when <inline-formula><mml:math id="M16" altimg="si12.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>+</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> then <inline-formula><mml:math id="M17" altimg="si13.svg"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>&#x0221e;</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item></list>
</p></list-item><list-item id="lstitem0011"><p id="p0041">
<bold>Statistical properties.</bold> These report on statistical properties about the data points, such as the sum of the values of all the features for each data point, the average value of the features for each data point, etc. These were calculated using the fit_transform function of the Kepler mapper.</p></list-item></list>
</p><sec id="sec0007"><label>2.4.1</label><title>Dimensionality reduction algorithms</title><p id="p0042">Here we provide short explanations about each of the dimensionality reduction algorithms used, (some of which have been adapted from the documentation of Scikit-learn <xref rid="bib0029" ref-type="bibr">[29]</xref>).</p><p id="p0043">Singular value decomposition (SVD) and Principal Component Analysis (PCA) are two methods used to perform linear dimensionality reduction of high-dimensional data set.</p><p id="p0044">PCA reduces the data into linearly uncorrelated variables (called <italic>principal components</italic>) such that the first component accounts for as much of the variability in the data as possible, and each succeeding component in turn accounts for the next highest variance possible and is orthogonal to the preceding components. When used in dimensionality reduction, one can take the first few principal components as the new set of features of the data set. To implement this, we used sklearn.decomposition.PCA.</p><p id="p0045">SVD is a matrix decomposition method for reducing a matrix <italic>A</italic> to the product of its constituent parts (<inline-formula><mml:math id="M18" altimg="si14.svg"><mml:mrow><mml:mi>A</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>U</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>U, V</italic> are unitary matrices and &#x003a3; is a rectangular diagonal matrix of singular values). When applied in dimensionality reduction, one can select the top <italic>k</italic> largest singular values in &#x003a3; and use the <italic>k</italic> affiliated columns in &#x003a3; and rows in <italic>V<sup>T</sup></italic> to generate an approximation <inline-formula><mml:math id="M19" altimg="si15.svg"><mml:mrow><mml:mi>B</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>U</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mstyle mathvariant="normal"><mml:mi>&#x003a3;</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> to <italic>A</italic>. We used the TruncatedSVD class of Scikit-learn to implement this.</p><p id="p0046">LLE, Isomap, MDS and Spectral Embedding are algorithms that belong to a framework called Manifold Learning, which are an attempt to generalize linear frameworks like PCA, to be sensitive to non-linear structure in data. These approaches learn the high-dimensional structure of the data from the data itself, in an unsupervised manner, i.e. without the use of predetermined classifications.</p><p id="p0047">The Isomap seeks a lower-dimensional embedding which maintains geodesic distances between all points. LLE seeks a lower-dimensional projection of the data which preserves distances within local neighborhoods, and it can be thought of as a series of local Principal Component Analyses which are globally compared to find the best non-linear embedding. For the Isomap and the LLE one needs to make a choice on the number of neighbors; since in our data set each time point should have between two and five data points corresponding to individually analyzed mice, we chose the value of three neighbors for these algorithms.</p><p id="p0048">Multidimensional scaling (MDS) seeks a low-dimensional representation of the data in which either the distances between the two output points are set to be as close as possible to the similarity or dissimilarity of the original data (the metric approach) or the algorithm seeks a monotonic relationship between the distances in the embedded space and the similarities/dissimilarities of the original data (the non-metric approach).</p><p id="p0049">For spectral embedding Laplacian Eigenmaps are implemented, which find a low dimensional representation of the data using a spectral decomposition of the graph Laplacian. The graph generated can be considered as a discrete approximation of the low dimensional manifold in the high dimensional space. Points close to each other on the manifold are mapped close to each other in the low dimensional space, preserving local distances.</p></sec></sec><sec id="sec0008"><label>2.5</label><title>On the number of intervals and percentage overlap for each lens</title><p id="p0050">The choice of number of intervals and percentage overlap defines how detailed or coarse a topological network representation of the data we want to create is, in other words, the &#x0201c;resolution&#x0201d; of the representation. The number of intervals can be any number starting from 1 and, as the name indicates, the percentage overlap can be anything in the range [0.0,1.0]. Thus, choosing a higher number of intervals translates to increasing the number of vertices of the graph. Increasing the percentage overlap allows the algorithm to find more data points in common between two intervals, thus roughly translating to an increased possibility of connecting two vertices. (Note that increasing the number of lenses also increases the number of vertices, since it increases the number of intervals that the data is partitioned into). <xref rid="fig0004" ref-type="fig">Fig.&#x000a0;4</xref>
shows topological networks of data sampled from a 2-dimensional circle, at different resolutions.<fig id="fig0004"><label>Fig. 4</label><caption><p><bold>Resolution of simplicial complexes and persistence of the shape of the data</bold>. Three simplicial complexes of data sampled from an unknown 3-dimensional space of different resolution are generated using the mapper algorithm <xref rid="bib0019" ref-type="bibr">[19]</xref>, implemented computationally using the Kepler mapper Python library <xref rid="bib0025" ref-type="bibr">[25]</xref>. One lens is used for all simplicial complexes, namely a projection on the x-axis. The number of intervals and percentage overlap for the lens at each resolution are indicated. Observation 1: the three simplicial complexes consist of one connected component. Observation 2: the three simplicial complexes have a &#x0201c;big hole&#x0201d; in the middle. Conclusion: The data set is sampled from a topological space that consists of one component and that has a hole in the middle. Since we know it is a 3-dimensional space, we can say it is a torus.</p></caption><alt-text id="at0004">Fig. 4</alt-text><graphic xlink:href="gr4_lrg"/></fig></p><sec id="sec0009"><label>2.5.1</label><title>Scaling of the data</title><p id="p0051">PCA gives different results when the scales of the features are different. Additionally, manifold learning methods are based on a nearest-neighbor search, therefore, such algorithm may perform poorly if the features of the data are on different scales. Therefore, we normalise the data before applying the dimensionality reduction algorithms. (Note that the clustering algorithm is run on the original data, which we do not normalise.)</p></sec><sec id="sec0010"><label>2.5.2</label><title>Choice of clustering algorithm</title><p id="p0052">Finding a good clustering of the points is a fundamental issue in computing representative topological networks. Currently there is no automated or principled method of making a choice. The mapper algorithm does not have any limitations on the cluster used and in particular, according to <xref rid="bib0019" ref-type="bibr">[19]</xref> desired characteristics when choosing a clustering are that it:<list list-type="simple" id="lst0001"><list-item id="lstitem0012"><label>1.</label><p id="p0053">is able to take an interpoint distance matrix as an input, not restricted to the Euclidean distance,</p></list-item><list-item id="lstitem0013"><label>2.</label><p id="p0054">does not require specifying the number of clusters.</p></list-item></list>
</p><p id="p0055">We chose the Density-Based Spatial Clustering of Applications with Noise (DBSCAN) <xref rid="bib0029" ref-type="bibr">[29]</xref> because we can specify what metric to use, the thresholds for the number of points needed to create a cluster (min_samples) and the value of the distance below which two points are considered to belong to the same cluster (eps).</p></sec></sec><sec id="sec0011"><label>2.6</label><title>Grid search analysis of parameter values for the mapper algorithm</title><p id="p0056">As described in the previous section, the outcome of the mapper algorithm is highly dependent on the choice of values for the following parameters: the number of lenses, the type of lenses, the number of intervals for each lens, the percentage overlap for the intervals, the choice of metric space and the clustering algorithm.</p><p id="p0057">We wrote a semi-unsupervised algorithm that built all simplicial complexes for various metrics, lenses and ranges of values for the lens intervals, percentage overlap and epsilon values of the DBSCAN clusterer from sklearn, and which &#x0201c;chose appropriate&#x0201d; simplicial complexes to represent the data. More specifically, below we list all the values we tested.</p><p id="p0058">
<bold>Metrics:</bold> cosine, euclidean and correlation</p><p id="p0059">
<bold>Number of lenses:</bold> 2</p><p id="p0060">To start with, we constructed simplicial complexes of the data sets with between 1 and 4 lenses. However, when we visually inspected the result of using a three or four lenses, we observed many more clusters corresponding to the same points, because of oversampling by the larger number of intervals introduced by the third and fourth lenses. In addition, using more that two lenses can make the calculations take over 20 hours to complete, compared to 3-5 hours for two lenses (ran on a standard laptop). Therefore we limited ourselves to using two lenses.</p><p id="p0061">
<bold>Combinations of lenses:</bold>
<list list-type="simple" id="lst0002"><list-item id="lstitem0014"><label>1.</label><p id="p0062">Lens 1 = Distance to the first neighbour with Lens 2 = Distance to the second neighbour</p></list-item><list-item id="lstitem0015"><label>2.</label><p id="p0063">Lens 1 = Distance to the first neighbour with Lens 2 = Projections to features</p></list-item><list-item id="lstitem0016"><label>3.</label><p id="p0064">Lens 1 = Sum of the distances to the first and second neighbours with Lens 2 = Projections to features</p></list-item><list-item id="lstitem0017"><label>4.</label><p id="p0065">Lens 1 = First dimension of a dimensionality reduction algorithm with Lens 2 = Projections to features</p></list-item><list-item id="lstitem0018"><label>5.</label><p id="p0066">Lens 1 = First dimension of a dimensionality reduction algorithm with Lens 2 = Second dimension of the same dimensionality reduction algorithm</p></list-item><list-item id="lstitem0019"><label>6.</label><p id="p0067">Lens 1 = Geometric or statistical information with Lens2 = Projections to features</p></list-item></list>
</p><p id="p0068">The projections to features lenses are a projection to each of the nine features of the data sets (the two pathogen loads and the seven cytokine concentrations). The distance to the closest neighbours and the geometric and statistical lenses depend on the metric chosen.</p><p id="p0069">
<bold>Number of intervals:</bold> between 2 and 30.</p><p id="p0070">
<bold>Percentage overlap:</bold> between 0.1 and 0.9.</p><p id="p0071">
<bold>Clusterer:</bold> DBSCAN from scikit-learn <xref rid="bib0029" ref-type="bibr">[29]</xref>. For the min_samples parameter we chosed the value of 1, i.e. a cluster can be formed with 1 or more data points. For the eps parameter we tested values between the minimum and maximum distances in the data sets for each metric. More specifically, the distances between the data points in the three infection groups range between [0,520002] in the Euclidean metric; between [0,1] in the cosine metric; and between [0,2] in the correlation metric. So for the Euclidean metric we tested 5000 values between 0 and 520002; and for the cosine and correlation metrics we tested 10 values between 0 and 1 and 0 and 2, respectively.</p><p id="p0072">Taking all these together, there are 18 different pairs of lenses; 28 different intervals and 10 percentage overlap values to test for each lens; 10 values for the epsilon parameter for the clusterer for the cosine and correlation metric and 5000 for the Euclidean metric. Therefore, in total this parameter grid search exercise generated almost 1 billion simplicial complexes (<inline-formula><mml:math id="M20" altimg="si16.svg"><mml:mrow><mml:mn>15</mml:mn><mml:mo linebreak="goodbreak">*</mml:mo><mml:msup><mml:mn>28</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo linebreak="goodbreak">*</mml:mo><mml:msup><mml:mn>9</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo linebreak="goodbreak">*</mml:mo><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak">+</mml:mo><mml:mn>3</mml:mn><mml:mo linebreak="goodbreak">*</mml:mo><mml:msup><mml:mn>28</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo linebreak="goodbreak">*</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo linebreak="goodbreak">*</mml:mo><mml:mn>5000</mml:mn><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>962</mml:mn><mml:mo>,</mml:mo><mml:mn>085</mml:mn><mml:mo>,</mml:mo><mml:mn>600</mml:mn></mml:mrow></mml:math></inline-formula>).</p><p id="p0073">From all the simplicial complexes generated, the algorithm chooses those that have a user-specified number of connected components. Biologically it makes sense that the simplicial complexes for the three infection groups have only one connected component. From the resulting list of simplicial complexes with one connected component, we ordered the simplexes in ascending order of epsilon value for the clusterer and the percentage overlap for the intervals for both lenses; choosing the smaller rather than the larger values for these parameters makes the simplicial complexes, as models of the system, simpler, which is desirable when working with models. Next, we chose simplicial complexes that had number of vertices at least half of the number of data points in the data set (for example, if the data set for the IAV infection group has 30 data points then we favour simplicial complexes that consist of only one connected component and at least 15 vertices); choosing this number gives a good resolution, not too simple, but also prevents the user from choosing simplicial complexes that have oversampling of data points. Finally, we visually inspected the simplest (in terms of small values for the parameters) 10, 20 or 30 simplicial complexes in that list. The visual inspection has two purposes: First, to give the user an idea of whether there is persistence in the global and local structures of the simplicial complexes generated. Second, to choose a representative structure for the data set.</p></sec><sec id="sec0012"><label>2.7</label><title>Co-infection experimental data</title><p id="p0074">We consider the murine data that we first presented in <xref rid="bib0004" ref-type="bibr">[4]</xref>. Three groups were considered: single viral infection (IAV), single bacterial infection (T4) and co-infection (IAV + T4). All experiments were performed in groups of 4&#x02013;7 WT C57BL/6 J mice. The mice were anesthetized and intranasally infected with either a sublethal dose of IAV (A/PR8/34) or a bacterial infection with the <italic>S. pneumoniae</italic> strain T4 on day 7, or both, depending on the infection group. Following infection, mice were monitored daily for morbidity and mortality. Bronchoalveolar lavage (BAL), post-lavage lung and blood were collected at 1.5, 6, 18, 26 and 31 hours post bacterial infection (hpi) or post bacterial co-infection (hpc). Lungs were homogenized, and the supernatants were used to determine virus titers, immune cell populations, and cytokine and chemokine concentrations. Kinetic measurements for viral titers (mRNA by real-time PCR), bacterial counts (colony forming units (CFU)) as well as the following cytokines were considered: IFN-<italic>&#x003b3;</italic>, TNF-<italic>&#x003b1;</italic>, IL-6, IFN-<italic>&#x003b2;</italic>, IL-22 and the chemokines MCP-1 and GM-CSF. The experiments are described in detail in <xref rid="bib0004" ref-type="bibr">[4]</xref>.</p><p id="p0075">For the analysis done in this study we took the measurements collected from the post-lavage lung. For the T4 and AIV + T4 infection groups, at 18 hpi and 18 hpc, respectively, the measurements had to be repeated. As it is a cross-sectional study (each measurement is coming from a mouse), to impute corresponding values, we allocate high values of bacterial burden to rows that contain high values of cytokines. Since mice were naive, we replaced any N/A values (under level of detection) in the bacterial burden (in the single IAV infection group) and viral load (in the single T4 infection group) with the value 0. For each infection group, for time points that have less than five missing values in one feature, we replaced the missing values with the average value of the feature for that specific time point. For infection groups that have missing values at one single time point for one particular feature, we performed a linear interpolation between the mean values of the previous and the next time points and replaced the missing values with the predicted value for that time point.</p><p id="p0076">Nodes in the simplicial complex represent clusters of infected mice, and edges connect nodes that contain samples in common. Nodes are colored by the average value of their samples for the variables listed in the Figs&#x02019; legends and color maps. Three types of parameters are needed to generate a topological model: First is a notion of similarity, called a metric, which measures the distance between two points in some space (in our case, the points are the rows in the data and the space is a multidimensional space that can be plotted using the quantitative measurements of disease symptoms as axes, such as the pathogen load or cytokine concentration, i.e. the features of the data set). The metric we used is the correlation distance. Second are lenses, which are functions that describe the distribution of data in a space. A lens is a mathematical mapping (function) that converts a data set into a vector, in which each row in the original data set contributes to a real number in the vector; i.e. a lens operation turns every row into a single number. Metrics are used with lenses to construct the simplicial complex output. Multiple lenses can be used in each analysis. In this case, Keppler-Mapper handles them mathematically by considering the Cartesian product. Third is the resolution, which controls the number of bin partitions that will be created within the range of selected lens values, known as the number of intervals, and the amount of oversampling between bins, known as the percentage overlap. Clustering then takes place within the bins, forming the final vertices of the simplicial complex; and clusters are connected with an edge whenever they share data points within the region that are over-sampled according to the percentage overlap. Therefore increasing the number of bins increases the number of vertices and increasing the percentage overlap results in an increased number of edges. The metric, lenses, resolution, and clusterer used to generate the topological graphs in <xref rid="fig0005" ref-type="fig">Figs.&#x000a0;5</xref>
and <xref rid="fig0006" ref-type="fig">6</xref>
are as indicated in <xref rid="tbl0001" ref-type="table">Table&#x000a0;1</xref>
. K-Nearest Neighbour Analysis was implemented using the KNeighborsClassifier from the Scikit Learn Python library <xref rid="bib0029" ref-type="bibr">[29]</xref>, with the correlation metric. T-tests were done using the ttest_ind function from the SciPy Python library.<fig id="fig0005"><label>Fig. 5</label><caption><p><bold>Simplicial complexes of data set consisting of all infection groups.</bold> The vertices of the simplicial complexes are color coded according to the infection group of the data points in the clusters. The legend shows which colors correspond to which infection group. Clusters that contain data points belonging to more than one infection group are colored by the average color value for members in that node.</p></caption><alt-text id="at0005">Fig. 5</alt-text><graphic xlink:href="gr5_lrg"/></fig><fig id="fig0006"><label>Fig. 6</label><caption><p><bold>Decoupling simplicial complexes of the immune response to virus, bacteria and co-infection.</bold> Five simplicial complexes are generated for the single viral (top row) and single bacterial (middle row) infection groups and six simplicial complexes are generated for the co-infection group (bottom row). The vertices of the simplicial complexes are color (see legends) coded according to the hour post infection or co-infection in the clusters. Clusters that contain data subsets belonging to more than one time point are colored by the average color value for members in that node.</p></caption><alt-text id="at0006">Fig. 6</alt-text><graphic xlink:href="gr6_lrg"/></fig><fig id="fig0007"><label>Fig. 7</label><caption><p><bold>Box plots of data points that belong to the two distinct regions revealed by TDA.</bold><italic>g</italic>1 denotes the data points belonging to vertices in the yellow group in <xref rid="fig0005" ref-type="fig">Fig. 5</xref>. <italic>g</italic>2 denotes the data points belonging to vertices in the teal/purple group in <xref rid="fig0005" ref-type="fig">Fig. 5</xref>.</p></caption><alt-text id="at0007">Fig. 7</alt-text><graphic xlink:href="gr7_lrg"/></fig><table-wrap position="float" id="tbl0001"><label>Table 1</label><caption><p>Parameter values for the Kepler mapper to generate the simplicial complexes of <xref rid="fig0005" ref-type="fig">Fig. 5</xref> and <xref rid="fig0006" ref-type="fig">6</xref> in the main script. The metric used was correlation.</p></caption><alt-text id="at0009">Table 1</alt-text><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Lens 1</th><th align="left" valign="top">Lens 2</th><th align="left" valign="top">Num. intervals Lens 1</th><th align="left" valign="top">Num. intervals Lens</th><th align="left" valign="top">Percentage overlap Lens 1</th><th align="left" valign="top">Percentage overlap Lens 2</th><th align="left" valign="top">Clusterer eps</th></tr></thead><tbody><tr><td valign="top">All infection groups</td><td/><td/><td/><td/><td/><td/></tr><tr><td valign="top">Dist. 1st Neighbour</td><td valign="top">Projection viral load lung</td><td valign="top">1</td><td valign="top">13</td><td valign="top">0.3</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st Neighbour</td><td valign="top">Projection bacterial burden lung</td><td valign="top">3</td><td valign="top">7</td><td valign="top">0.8</td><td valign="top">0.7</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st Neighbour</td><td valign="top">Projection IFN-<italic>&#x003b3;</italic></td><td valign="top">5</td><td valign="top">3</td><td valign="top">0.8</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st Neighbour</td><td valign="top">Projection TNF-<italic>&#x003b1;</italic></td><td valign="top">1</td><td valign="top">9</td><td valign="top">0.2</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st Neighbour</td><td valign="top">Projection MCP-1</td><td valign="top">5</td><td valign="top">3</td><td valign="top">0.8</td><td valign="top">0.4</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st Neighbour</td><td valign="top">Projection IL-6</td><td valign="top">1</td><td valign="top">13</td><td valign="top">0.3</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">IAV</td><td/><td/><td/><td/><td/><td/></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection viral load lung</td><td valign="top">1</td><td valign="top">13</td><td valign="top">0.2</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection IFN-<italic>&#x003b3;</italic></td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.6</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection TNF-<italic>&#x003b1;</italic></td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.8</td><td valign="top">0.7</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection MCP-1</td><td valign="top">1</td><td valign="top">9</td><td valign="top">0.2</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection IL-6</td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.6</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">T4</td><td/><td/><td/><td/><td/><td/></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection bacterial burden lung</td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.7</td><td valign="top">0.8</td><td valign="top">1.1</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection IFN-<italic>&#x003b3;</italic></td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.7</td><td valign="top">0.8</td><td valign="top">1.1</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection TNF-<italic>&#x003b1;</italic></td><td valign="top">1</td><td valign="top">13</td><td valign="top">0.2</td><td valign="top">0.8</td><td valign="top">1.1</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection MCP-1</td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.7</td><td valign="top">0.8</td><td valign="top">1.1</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection IL-6</td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.7</td><td valign="top">0.8</td><td valign="top">1.1</td></tr><tr><td valign="top">IAV&#x000a0;+&#x000a0;T4</td><td/><td/><td/><td/><td/><td/></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection viral load lung</td><td valign="top">1</td><td valign="top">13</td><td valign="top">0.3</td><td valign="top">0.8</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection bacterial burden lung</td><td valign="top">3</td><td valign="top">7</td><td valign="top">0.7</td><td valign="top">0.7</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection IFN-<italic>&#x003b3;</italic></td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.8</td><td valign="top">0.7</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection TNF-<italic>&#x003b1;</italic></td><td valign="top">5</td><td valign="top">3</td><td valign="top">0.8</td><td valign="top">0.6</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection MCP-1</td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.8</td><td valign="top">0.4</td><td valign="top">0.5</td></tr><tr><td valign="top">Dist. 1st neighbour</td><td valign="top">Projection IL-6</td><td valign="top">3</td><td valign="top">3</td><td valign="top">0.8</td><td valign="top">0.5</td><td valign="top">0.7</td></tr></tbody></table></table-wrap></p><p id="p0077">
<xref rid="tbl0001" ref-type="table">Table&#x000a0;1</xref> shows the parameter values used with the Kepler mapper to generate the simplicial complexes of <xref rid="fig0005" ref-type="fig">Fig. 5</xref> and <xref rid="fig0006" ref-type="fig">6</xref> in the main script.</p></sec></sec><sec id="sec0013"><label>3</label><title>Results</title><p id="p0078">In the context of infectious diseases from which hosts can recover (e.g. malaria, influenza, pneumococci, etc), disease maps that form loops are representative of the trajectory from health, through infection and sickness and back to recovery or death <xref rid="bib0015" ref-type="bibr">[15]</xref>. In particular, disease space with looping behaviour and disease maps that are circular can be used to, for example: 1.) describe the in-host dynamics of infections; 2.) identify where data of patients lie along the infection timeline, regardless of whether the stage of the infection is known (for example, from cross-sectional studies or from data of patients coming clinics to be treated, at different (and unknown) stages of the infection); and 3.) distinguish between more and less resilient individuals, from a relatively early stage of the infection course. This methodology was applied in <xref rid="bib0015" ref-type="bibr">[15]</xref> to investigate malaria. Motivated from this approach, we investigated if looping curves are a common motif in influenza or influenza in co-infection with bacteria. To that end, we also generated phase plots of pairs of features of our data sets and used K-nearest neighbour analysis, as is explained below.</p><p id="p0079">
<bold>Definition 3.1:</bold>
<italic>Disease space</italic> is the multidimensional space that can be plotted using quantitative measurements of disease symptoms as axes.</p><p id="p0080">
<bold>Definition 3.2:</bold> Parameters of a data set that oscillate, partially overlap and have a time lag between them are called <italic>hysterectic parameters</italic>
<xref rid="bib0015" ref-type="bibr">[15]</xref>.</p><p id="p0081">
<bold>Definition 3.3:</bold> When pairs of hysterectic parameters are plotted against each other in their phase plot they create loops <xref rid="bib0015" ref-type="bibr">[15]</xref>. These can be considered two dimensional projections of the higher dimensional looping behaviour of the data set and are referred to as <italic>disease maps</italic>.</p><sec id="sec0014"><label>3.1</label><title>Persistent shape of the data in the three infection groups</title><p id="p0082">We used the mapper algorithm to study four data sets: The first consisted of the data for the three infection groups put together, and the other three were the individual separate infection scenarios. The Kepler Mapper <xref rid="bib0025" ref-type="bibr">[25]</xref>, a library implementing the mapper algorithm in Python, was employed. Additionally, we wrote a semi-unsupervised algorithm that built all simplicial complexes for various metrics, lenses and ranges of values for the lens intervals and percentage overlap, and which chose simplicial complexes to represent the data. More specifically, using our semi-unsupervised algorithm, we tested the cosine, euclidean and correlation metrics, along with different epsilon values for the clusterer. Furthermore, all analysis was done using two lenses and we tested different combinations of the following: projections to the features of the data sets (i.e. the values of the pathogen load or the concentrations of the cytokines), the distance to the two nearest neighbours, the first two dimensions of various linear and non-linear dimensionality reduction algorithms and projections to (the image of) functions that reveal interesting geometric and statistical information about the data, such as density, eccentricity or centrality. We tested between 2 and 30 intervals for each lens and 10 different values for the percentage overlap of the lens&#x02019; intervals and the epsilon parameter of the clusterer. This resulted in almost 1 billion simplicial complexes being generated, from which, using properties of graphs such as the number of connected components, the algorithm chose complexes that were persistent in shape and that showcased important information about the immune response.</p><p id="p0083">A detailed presentation of our semi-unsupervised algorithm and a discussion on how the representative simplicial complexes are chosen and how we came to the conclusion that those (simplicial complexes) are persistent in their shape is included in <xref rid="sec0002" ref-type="sec">Section&#x000a0;2</xref>. Of note, during the parameter value search we obtained consistent results to those presented here with the same lenses and metric (correlation) and different parameter values for the number of intervals and percentage overlap. We also obtained similar results with the same metric but other pairs of lenses that included also linear and non-linear dimensionality reduction algorithms. Finally, we obtained similar results also with the cosine metric.</p><p id="p0084">For the sake of clarity, we discuss only the results obtained by using the correlation metric with the following two types of lenses: lens 1 is the distance to the first neighbour and lens 2 is a projection to one of the features. <xref rid="fig0005" ref-type="fig">Figs.&#x000a0;5</xref> and <xref rid="fig0006" ref-type="fig">6</xref> illustrate the representative simplicial complexes that we discuss in more detail here (<xref rid="tbl0001" ref-type="table">Table&#x000a0;1</xref> lists the parameter values specific for these simplicial complexes). <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref> corresponds to the data set that consists of all infection groups together, and <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref> shows the simplicial complexes for the individual infection groups separately. The columns in both figures indicate the projection for lens 2.</p><p id="p0085">These analyses revealed persistence in the shape of the data. For example, in <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref> all the simplicial complexes generated with the different projections for lens 2 can be divided into three regions, two in yellow and one in purple/teal, where the circles (or vertices) in the yellow regions belong to time points 26 and 31&#x000a0;h post co-infection (hpc) in the IAV + T4 infection group, and the circles in purple/teal belong to the IAV, T4 single-infection groups and early (1.5, 6, 18 hpc) time points in the IAV + T4 co-infection group. This is illustrated more explicitly in the simplicial complex generated by lens 2 = IL-6. The fact that the same shape is generated regardless of the projection used indicates that the shape is likely to represent the data.</p><p id="p0086">Similar observations can be made for the simplicial complexes of the individual infection groups in <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref>. For example, the simplicial complexes of the IAV infection group (second row) generated with the cytokines can all be divided into two regions, green vertices versus blue vertices. The simplicial complexes of the single bacterial infection (T4 infection group) generated with the bacterial burden and the cytokines IL-6, MCP-1 and IFN-<italic>&#x003b3;</italic> are also all persistent in shape and, unlike the simplicial complexes for the other data sets, these ones do not highlight particular groups of nodes. The bottom row of <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref> corresponds to the simplicial complexes of the co-infection group (IAV + T4) alone. The time course can be clearly distinguished by the simplicial complexes generated with lens 2 being the two pathogens burden and the concentration of the cytokines IL-6 and MCP-1, as is indicated by the gray arrow (from early to later time points).</p><p id="p0087">The simplicial complexes reveal different persistent shapes for the three infection groups - in IAV the later time points are segregated from the earlier time points; in T4 the simplicial complexes are homogeneous and do not reveal special areas; in IAV + T4 the time course of the infection is elucidated. Together this indicates that the immune system behaves differently in the three infection scenarios.</p></sec><sec id="sec0015"><label>3.2</label><title>Transition points in the immune response</title><p id="p0088">We originally applied the mapper algorithm to all infection groups together in order to see whether the three infection groups would be clearly separated. However, the result illustrated in <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref> contains far more information. Taking the complex generated with the projection to IL-6 as the representative shape of the data, we observe that it has three regions: two in yellow and one in purple/teal.</p><p id="p0089">The data points that have been clustered (by the Mapper Algorithm) into the yellow vertices of the simplicial complex correspond exclusively to all the late (26 and 31 hpc) time points of the co-infection group (IAV + T4); the rest of the data points (all other time points in the co-infection and all the data in the single viral (IAV) and single bacterial (T4) infection groups) have been grouped together by the mapper algorithm and clustered into the vertices colored teal/purple. In other words, the Mapper Algorithm has segregated those specific points (26hpc and 31hpc in the co-infection) away from all other points, indicating that the data behaves differently at and after 26hpc in the co-infection scenario, compared to the other points. This, we interpret as the immune system undergoing a shift in its behaviour in the co-infection, sometime between 18 and 26&#x000a0;h post co-infection. From this observation we conclude that the topological data analysis has highlighted a transition in the nature of the immune response during a co-infection sometime between 18 and 26 hours post co-infection.</p><p id="p0090">In order to interpret more precisely why the mapper algorithm is highlighting the specific regions illustrated inside the yellow circles, we calculated the p-values between groups of data points at consecutive time points, for each feature of the data (<xref rid="tbl0002" ref-type="table">Table&#x000a0;2</xref>
); we also made box plots to compare the data belonging to the two groups separated by the simplicial complex in <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref> corresponding to lens 2 = IL-6 (<xref rid="fig0007" ref-type="fig">Fig.&#x000a0;7</xref>). The p-values show that, in the co-infection scenario, there is a strong change in the concentration of the cytokines TNF-<italic>&#x003b1;</italic>, MCP-1 and IL-6 (as well as in the viral load) between 18 and 26 hpc. The boxplots clearly revealed that data points of IAV + T4 from 26 and 31&#x000a0;h post co-infection are separated by the simplicial complex from the earlier data points and that 18 and 26 hpc represent a transition point for the system, since at both time points there are data subsets that belong to both groups in the simplicial complex (the yellow and the teal/purple). It is possible that the shape of the simplicial complexes in <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref> is exactly mirrowing the dramatic change in the concentration of the cytokines (and possibly the viral load) that is revealed by the <italic>p</italic>-values.<table-wrap position="float" id="tbl0002"><label>Table 2</label><caption><p><bold>Statistical study to data sets belonging to consecutive time points (columns) for each feature (row).</bold> p-values below 0.05 (*), 0.01 (**) and 0.005 (***) are indicated.</p></caption><alt-text id="at0010">Table 2</alt-text><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top">Infection group</th><th align="left" valign="top">Feature</th><th align="left" valign="top">1.5&#x02013;6</th><th align="left" valign="top">6&#x02013;18</th><th align="left" valign="top">18&#x02013;26</th><th align="left" valign="top">26&#x02013;31</th></tr></thead><tbody><tr><td valign="top">IAV&#x000a0;+&#x000a0;T4</td><td valign="top">Viral load lung</td><td valign="top">0.113336</td><td valign="top">0.202011</td><td valign="top">0.000101***</td><td valign="top">0.200436</td></tr><tr><td/><td valign="top">Bacterial burden lung</td><td valign="top">0.009209**</td><td valign="top">0.006859**</td><td valign="top">0.104765</td><td valign="top">0.958299</td></tr><tr><td/><td valign="top">IFN-<italic>&#x003b3;</italic></td><td valign="top">0.748814</td><td valign="top">0.269034</td><td valign="top">0.161643</td><td valign="top">0.320453</td></tr><tr><td/><td valign="top">TNF-<italic>&#x003b1;</italic></td><td valign="top">0.520351</td><td valign="top">0.120874</td><td valign="top">0.016524*</td><td valign="top">0.766774</td></tr><tr><td/><td valign="top">MCP-1</td><td valign="top">0.411175</td><td valign="top">0.353125</td><td valign="top">0.000691***</td><td valign="top">0.859898</td></tr><tr><td/><td valign="top">IL-6</td><td valign="top">0.879291</td><td valign="top">0.425412</td><td valign="top">0.019389*</td><td valign="top">0.994039</td></tr></tbody></table></table-wrap></p><p id="p0091">
<xref rid="fig0008" ref-type="fig">Fig.&#x000a0;8</xref>
A shows the k-nearest neighbours for the data sets in the three infection groups, with metric correlation and 30 neighbours. The rows and columns indicate each data points and dark regions indicate the 30 closest neighbours of each data point. The labels show which points belong to which infection group and time point. The bottom right panel, inside the orange dotted box, corresponds specifically to the data points of the co-infection group (IAV + T4). The data sets in this region can be divided into three groups: the early period (1.5 hpc), the transition period (6 hpc) and the later period (between 18 and 31 hpc). This is illustrated by the fact that within the orange dotted box, the data sets at 1.5 hpc are neighbours with only data sets at 1.5 and 6.0 hpc, the data sets in 6 hcp have neighbours in both the early and the later groups and data sets at 18, 26 and 31 hpc have neighbours only at 6 hpc and late time points. This can be seen more clearly in <xref rid="fig0008" ref-type="fig">Fig.&#x000a0;8</xref>B which shows the correlation coefficients between data points in the co-infection data set. Data sets at 1.5 hpc are closely correlated to themselves, data sets at 6 hpc have close correlation to points in both the early and later periods, the later data sets (18, 26 and 31 hpc) are closely correlated to themselves only. Data sets between the early and later groups are not correlated.<fig id="fig0008"><label>Fig. 8</label><caption><p><bold>K-nearest neighbour analysis of co-infection.</bold> A) 30-nearest neighbours of all data sets in the three infection scenarios, with the correlation as metric. The infection groups and the time points for each infection group are indicated on the axes. The dark regions indicate the 30 neighbours of each data point. Inside the orange dotted box are the neighbours of co-infection data within the co-infection scenario. Inside the green dotted boxes are the neighbours of the co-infection data in the IAV single infection and T4 single infection groups. B) Correlation distance matrix of the co-infection group. The color-bar on the right indicates the correlation distance values between data sets.</p></caption><alt-text id="at0008">Fig. 8</alt-text><graphic xlink:href="gr8_lrg"/></fig></p><p id="p0092">In <xref rid="fig0008" ref-type="fig">Fig.&#x000a0;8</xref>A, now looking at the neighbours of the co-infection data subsets outside of the orange dotted box and inside the green dotted boxes (i.e. along the rows), we can see that co-infection data sets at early times also have neighbours exclusively in the IAV single infection group and co-infection data sets at late times also have neighbours exclusively in the T4 single infection group. In other words, the early co-infection data sets are closely correlated with the data sets in the IAV single infection group and the late co-infection data sets are closely correlated with the data sets in the T4 single infection group. Putting these three observations together, we can conclude that the immune response in the co-infection inherits its early response from the primary viral infection but at 6 hpc it undergoes a shift and quickly shapes its response to defend against the secondary bacterial infection.</p><p id="p0093">In the simplicial complexes illustrated in <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref> in both the T4 single infection and co-infection (IAV + T4) groups the simplicial complexes generated with the TNF-<italic>&#x003b1;</italic> projection draw attention to the later time points in both infection scenarios. Specifically, for T4, the points correspond to time 26 hpc and in IAV + T4 the data sets correspond to times 26 and 31 hpc. <xref rid="tbl0002" ref-type="table">Table&#x000a0;2</xref> highlights that in both the single bacterial infection and in the co-infection, the concentration of the TNF-<italic>&#x003b1;</italic> cytokine changes significantly between 18 and 26 hours post the onset of the bacterial infection. Our previous analysis <xref rid="bib0004" ref-type="bibr">[4]</xref> of experimental results for TNF-<italic>&#x003b1;</italic> showed levels were increasingly and significantly elevated in co-infected mice from 18 hpi on. Therefore the simplicial complexes in <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref> of the single bacterial infection and the co-infection generated by the projection to TNF-<italic>&#x003b1;</italic> are exactly revealing this dramatic change in the concentration of this cytokine at this late stage in the course of the co-infection.</p></sec></sec><sec id="sec0016"><label>4</label><title>Discussion</title><p id="p0094">The relative contributions of the immune system during co-infections and how they can help in laying out the evolution of the immune system in response to co-infections are largely fragmented. The complexity of multi-pathogen infections makes detailed dissection of contributing mechanisms and stages of the immune response, which may be non-linear and occur on different time scales, challenging. Recently, in conjunction with experimental data, theoretical approaches have been able to uncover infection control mechanisms, establish regulatory feedback, connect mechanisms across time scales, and determine the processes that dictate different disease outcomes <xref rid="bib0030" ref-type="bibr">[30]</xref>. In this study we aimed at continuing this effort and we used TDA and data of co-infection experiments <xref rid="bib0004" ref-type="bibr">[4]</xref> to investigate how the immune system evolves between different infections.</p><p id="p0095">Using the Mapper Algorithm (<xref rid="fig0005" ref-type="fig">Figs.&#x000a0;5</xref> and <xref rid="fig0006" ref-type="fig">6</xref>) in combination with nearest neighbour analysis (<xref rid="fig0008" ref-type="fig">Fig.&#x000a0;8</xref>) we have shown that the immune response during influenza-pneumococcal co-infection consists of three stages (<xref rid="fig0001" ref-type="fig">Fig.&#x000a0;1</xref>): It is initially shaped by the inherited response to the primary influenza infection. We call this phase 1 of the immune response. Subsequently, the system undergoes an abrupt transition at 6 hours post onset of the secondary bacterial infection as it quickly modulates itself and starts responding predominantly to the bacterial infection; this is phase 2 of the immune response. There is a second transition stage between 18 and 26&#x000a0;h post co-infection after which the immune response does no longer resemble the behaviour under a single viral or bacterial infection, but presumably shapes its response to the co-infection itself; this stage we call phase 3.</p><p id="p0096">In <xref rid="bib0004" ref-type="bibr">[4]</xref>, kinetics of bacterial growth and clearance in the respiratory tract and blood following IAV-<italic>S. pneumoniae</italic> co-infection revealed a turning-point between 6 and 18&#x000a0;h post onset of the secondary bacterial infection. In this study we have narrowed down the time of the turning point specifically to 6 hours post co-infection.</p><p id="p0097">Experimental results <xref rid="bib0004" ref-type="bibr">[4]</xref> for IFN-<italic>&#x003b3;</italic> showed that the co-infection led to an increase as early as 1.5 hpc and 6 hpc compared to the single IAV infection. The levels of IFN-<italic>&#x003b3;</italic> remained constant compared to the underlying IAV infection for the later time points, but a significant increase was observed when compared to the single T4 infection. Finally, overshooting concentrations of IL-6 in the co-infected mice were also detected experimentally at 26 hpc and 31 hpc compared to the single T4 infection. The chemokine MCP-1 was experimentally found to be significantly increased in the IAV + T4 group compared to the single T4 infected group and marginally increased to the IAV only group at 26 hpi and 31 hpi.</p><p id="p0098">The simplicial complexes illustrated in <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref> perfectly matches these observations. More specifically, the experimental observations made in <xref rid="bib0004" ref-type="bibr">[4]</xref> regarding the temporal changes in concentrations of the cytokines throughout the co-infection coincide with the special regions highlighted by the simplicial complexes. We observe that the simplicial complexes generated by the mapper algorithm with a projection to the features could be representing exactly those dramatic changes in the values of the features and that the algorithm is able to separate data points with high relative concentrations of cytokines away from other data points. In the simplicial complexes illustrated in <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref> in both the T4 and IAV + T4 infection groups the simplicial complexes generated with the TNF-<italic>&#x003b1;</italic> projection draw attention to the later time points in both infection scenarios. Specifically, for T4, the data sets correspond to time 26 and in IAV + T4 the data correspond to times 26 and 31. We could further interpret these results as further supporting evidence that the immune response at this stage of the co-infection is primarily responding in a way that is similar to its response in the single bacterial infection.</p><p id="p0099">The simplicial complex of the co-infection generated with the projection to IFN-<italic>&#x003b3;</italic> in <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref> segregates data points at early times 1.5 and 6 hpc (in purple) away from the clusters of the other data sets, resembling the experimental observations regarding the concentration of IFN-<italic>&#x003b3;</italic> in the co-infection compared with the single viral and bacterial infections. The simplicial complexes of the co-infection scenario generated by the projections to IL-6 and MCP-1 (and to the viral load and bacterial burden) reproduced the timeline of the infection course. It is interesting to contemplate the possibility that the simplicial complexes of the co-infection imply that the cytokines IL-6 and MCP-1 play a consistent role through the whole infection course in the co-infection scenario.</p><p id="p0100">Looking in more detail at the simplicial complex corresponding to the projection to IL-6 on the top row of <xref rid="fig0005" ref-type="fig">Fig.&#x000a0;5</xref>, we can see that the two groups of yellow circles are sprouting from different regions in the complex; one yellow group sprouts from vertices in purple and the other from vertices in teal. Recall that the vertices of the simplicial complex represent clusters of points of the data set and edges between vertices indicate that there are data in common between clusters. Therefore, after further analysis of the data sets that are in common between the purple and yellow vertices (clusters) and teal and yellow vertices, we could elucidate that, in fact, the purple vertices have data sets exclusively in the single viral infection at early time points and vertices in teal have all the data sets in the single bacterial infection and some data sets in the late stages of the single viral infection. In other words, the yellow region emanating from the purple vertices is connected exclusively to early time points in the single viral infection and the other yellow region to the single bacterial infection and late time points in the viral infection.</p><p id="p0101">We may speculate the connections between the late-stage co-infection data and the early-stage single viral infection data are hinting at a rebound in viral titre after bacterial infection is established, which is a property of the co-infection that was been observed in other studies (for example) <xref rid="bib0031" ref-type="bibr">[31]</xref>.</p><p id="p0102">In <xref rid="bib0004" ref-type="bibr">[4]</xref> mathematical modelling, we proposed IFN-<italic>&#x003b3;</italic> as a key and sufficient modulator in the impairment of bacterial clearance and other detrimental effects specifically for IL-6 and TNF-<italic>&#x003b1;</italic> in bacterial clearance. At the current stage of application of the mapper algorithm for this particular data set, we are not able to draw specific conclusions regarding causal roles of the cytokines in the co-infection. We can only allude to possible involvement of cytokines at specific stages in the infection course (as we have done, for example, with TNF-<italic>&#x003b1;</italic>, IL-6 and MCP-1.) In other words, TDA can dissect the potential of the different cytokines to represent the whole data set during co-infections, however, it can not point out or reject a key role of a specific cytokine for the susceptibility to bacterial co-infections.</p><p id="p0103">The simplicial complexes generated for T4 single infection with projections to all the features show a homogenous structure where no specific group of data points are segregated or highlighted. We believe this is due to a trichotomy of pneumococcal outcomes discovered using stability and bifurcation analysis in <xref rid="bib0023" ref-type="bibr">[23]</xref>. Additionally, the immune response has been found to go through three stages during its response to single pneumococcal lung infections <xref rid="bib0032" ref-type="bibr">[32]</xref>.</p><p id="p0104">In <xref rid="bib0015" ref-type="bibr">[15]</xref> the simplicial complex of the stages a host infected with malaria goes through is circular and serves as a map of the loop an individual goes through on its way from health, through sickness and recovery and back to health. It is to be expected that a topological approach to study infectious diseases where hosts recover would also reveal circular topological simplicial complexes. This is not the case for the data set we have used. For the three infection groups, the data sets do not contain information for the full course of the infections. More specifically, the data set of the single IAV infected group is based on data starting from day 7 post the onset of the viral infection. The data set for the co-infected groups is incomplete towards the end of the infection course because for ethical reasons the mice that developed a high morbidity had to be euthanized before the bacterial infection is resolved naturally. Nevertheless, we found hints of looping behaviour in the co-infection, as discussed in <xref rid="sec0014" ref-type="sec">Section&#x000a0;3.1</xref>.</p><p id="p0105">In some cases, it has been difficult to uncover the implications in the biological context with certainty, with respect to the structures of the simplicial complexes. For example, we speculate that the segregation of specific data sets represents striking changes in feature values - i.e. changes in concentration of cytokine of pathogen load from one time point to the others. This seems indeed to be the case as explained earlier in this discussion. However, for example, striking changes in bacterial burden and viral load in the co-infection are shown in <xref rid="tbl0002" ref-type="table">Table&#x000a0;2</xref>, where the bacterial burden changes significantly between 1.5 and 6 hpc and between 6 and 18 hpc and the viral load changes significantly between 18 and 26 hpc. In this case, it is not clear exactly how these changes are represented in the simplicial complexes of <xref rid="fig0006" ref-type="fig">Fig.&#x000a0;6</xref>. Therefore further quantification is required in order to understand in more detail the information that the choice of lenses provide in the biological context.</p><p id="p0106">Mechanistic modeling studies investigating stages of the immune system in response to co-infections have been done previously <xref rid="bib0004" ref-type="bibr">[4]</xref>, <xref rid="bib0020" ref-type="bibr">[20]</xref>, <xref rid="bib0021" ref-type="bibr">[21]</xref>, <xref rid="bib0032" ref-type="bibr">[32]</xref>. While under specific assumptions these models can highlight relevant mechanism, the design of mechanistic models and the abstraction complexity remain largely debatable. Here, TDA is presented as an additional tool to abstract high dimension data sets during co-infections, thereby significantly extending current knowledge and building a basis for translating improved mathematical models into potential therapies.</p></sec><sec id="sec0016a"><title>CRediT authorship contribution statement</title><p id="p0106a">
<bold>Karin Sasaki:</bold> Writing - original draft. <bold>Dunja Bruder:</bold> Writing - review &#x00026; editing. <bold>Esteban A. Hernandez-Vargas:</bold> Conceptualization, Resources, Supervision, Writing - review &#x00026; editing.</p></sec><sec sec-type="COI-statement"><title>Declaration of Competing Interest</title><p id="p0107">The authors declare no conflict of interest. The funders had no role in the design of the study; in the collection, analyses, or interpretation of the data; in the writing of the manuscript; and in the decision to publish the results.</p></sec></body><back><ref-list id="bib001"><title>References</title><ref id="bib0001"><label>1</label><element-citation publication-type="journal" id="sbref0001"><person-group person-group-type="author"><name><surname>McArdle</surname><given-names>A.J.</given-names></name><name><surname>Turkova</surname><given-names>A.</given-names></name><name><surname>Cunnington</surname><given-names>A.J.</given-names></name></person-group><article-title>When do co-infections matter?</article-title><source>Currentopinion ininfectiousdiseases</source><volume>31</volume><issue>3</issue><year>2018</year><fpage>209</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1097/QCO.0000000000000447</pub-id></element-citation><note><p>29698255[pmid].</p></note></ref><ref id="bib0002"><label>2</label><element-citation publication-type="journal" id="sbref0002"><person-group person-group-type="author"><name><surname>Sofonea</surname><given-names>M.T.</given-names></name><name><surname>Alizon</surname><given-names>S.</given-names></name><name><surname>Michalakis</surname><given-names>Y.</given-names></name></person-group><article-title>Exposing the diversity of multiple infection patterns</article-title><source>J Theor Biol</source><volume>419</volume><year>2017</year><fpage>278</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2017.02.011</pub-id><pub-id pub-id-type="pmid">28193485</pub-id></element-citation></ref><ref id="bib0003"><label>3</label><element-citation publication-type="journal" id="sbref0003"><person-group person-group-type="author"><name><surname>Graham</surname><given-names>A.L.</given-names></name><name><surname>Cattadori</surname><given-names>I.M.</given-names></name><name><surname>Lloyd-Smith</surname><given-names>J.O.</given-names></name><name><surname>Ferrari</surname><given-names>M.J.</given-names></name><name><surname>Bj&#x000f8;rnstad</surname><given-names>O.N.</given-names></name></person-group><article-title>Transmission consequences of coinfection: cytokines writ large?</article-title><source>Trends Parasitol</source><volume>23</volume><issue>6</issue><year>2007</year><fpage>284</fpage><lpage>291</lpage><pub-id pub-id-type="doi">10.1016/j.pt.2007.04.005</pub-id><pub-id pub-id-type="pmid">17466597</pub-id></element-citation></ref><ref id="bib0004"><label>4</label><element-citation publication-type="journal" id="sbref0004"><person-group person-group-type="author"><name><surname>Duvigneau</surname><given-names>S.</given-names></name><name><surname>Sharma-Chawla</surname><given-names>N.</given-names></name><name><surname>Boianelli</surname><given-names>A.</given-names></name><name><surname>Stegemann-Koniszewski</surname><given-names>S.</given-names></name><name><surname>Nguyen</surname><given-names>V.K.</given-names></name><name><surname>Bruder</surname><given-names>D.</given-names></name></person-group><article-title>Hierarchical effects of pro-inflammatory cytokines on the post-influenza susceptibility to pneumococcal coinfection</article-title><source>Scientific Reports</source><volume>6</volume><year>2016</year></element-citation><note><p>37045 EP.</p></note></ref><ref id="bib0005"><label>5</label><element-citation publication-type="journal" id="sbref0005"><person-group person-group-type="author"><name><surname>Gartlehner</surname><given-names>G.</given-names></name><name><surname>Stepper</surname><given-names>K.</given-names></name></person-group><article-title>Julius Wagner-Jauregg: pyrotherapy, simultanmethode, and &#x02019;racial hygiene&#x02019;</article-title><source>J R Soc Med</source><volume>105</volume><issue>8</issue><year>2012</year><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1258/jrsm.2012.12k0049</pub-id><pub-id pub-id-type="pmid">22907553</pub-id></element-citation></ref><ref id="bib0006"><label>6</label><element-citation publication-type="journal" id="sbref0006"><person-group person-group-type="author"><name><surname>Nacher</surname><given-names>M.</given-names></name></person-group><article-title>Interactions between worms and malaria: good worms or bad worms?</article-title><source>Malaria journal</source><volume>10</volume><year>2011</year><pub-id pub-id-type="doi">10.1186/1475-2875-10-259</pub-id></element-citation><note><p>259&#x02013;259.</p></note></ref><ref id="bib0007"><label>7</label><element-citation publication-type="journal" id="sbref0007"><person-group person-group-type="author"><name><surname>Babu</surname><given-names>S.</given-names></name><name><surname>Nutman</surname><given-names>T.B.</given-names></name></person-group><article-title>Helminth-tuberculosis co-infection: an immunologic perspective</article-title><source>Trends Immunol</source><volume>37</volume><issue>9</issue><year>2016</year><fpage>597</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1016/j.it.2016.07.005</pub-id><pub-id pub-id-type="pmid">27501916</pub-id></element-citation></ref><ref id="bib0008"><label>8</label><element-citation publication-type="journal" id="sbref0008"><person-group person-group-type="author"><name><surname>Birger</surname><given-names>R.B.</given-names></name><name><surname>Kouyos</surname><given-names>R.D.</given-names></name><name><surname>Cohen</surname><given-names>T.</given-names></name><name><surname>Griffiths</surname><given-names>E.C.</given-names></name><name><surname>Huijben</surname><given-names>S.</given-names></name><name><surname>Mina</surname><given-names>M.J.</given-names></name></person-group><article-title>The potential impact of coinfection on antimicrobial chemotherapy and drug resistance</article-title><source>Trends Microbiol</source><volume>23</volume><issue>9</issue><year>2015</year><fpage>537</fpage><lpage>544</lpage><pub-id pub-id-type="doi">10.1016/j.tim.2015.05.002</pub-id><pub-id pub-id-type="pmid">26028590</pub-id></element-citation></ref><ref id="bib0009"><label>9</label><element-citation publication-type="journal" id="sbref0009"><person-group person-group-type="author"><name><surname>Mark</surname><given-names>E.J.</given-names></name><name><surname>Woolhouse</surname><given-names>R.A.</given-names></name><name><surname>Haydon</surname><given-names>D.T.</given-names></name></person-group><article-title>Emerging pathogens: the epidemiology and evolution of species jumps</article-title><source>Trends Ecol Evol</source><volume>20</volume><issue>5</issue><year>2005</year></element-citation></ref><ref id="bib0010"><label>10</label><element-citation publication-type="book" id="sbref0010"><person-group person-group-type="author"><name><surname>Hudson SECIM</surname><given-names>P.J.</given-names></name><name><surname>Perkins</surname></name></person-group><chapter-title>The emergence of wildlife disease and the application of ecology.</chapter-title><year>2008</year><publisher-name>Princeton University Press Princeton</publisher-name><publisher-loc>USA</publisher-loc><isbn>9780691124858</isbn></element-citation></ref><ref id="bib0011"><label>11</label><element-citation publication-type="book" id="sbref0011"><person-group person-group-type="author"><name><surname>Hernandez-Vargas</surname><given-names>E.A.</given-names></name></person-group><chapter-title>Modeling and Control of Infectious Diseases: With MATLAB and R</chapter-title><edition>1st ed</edition><year>2019</year><publisher-name>Elsevier Academic Press</publisher-name></element-citation></ref><ref id="bib0012"><label>12</label><element-citation publication-type="journal" id="sbref0012"><person-group person-group-type="author"><name><surname>Nicolau</surname><given-names>M.</given-names></name><name><surname>Levine</surname><given-names>A.J.</given-names></name><name><surname>Carlsson</surname><given-names>G.</given-names></name></person-group><article-title>Topology based data analysis identifies a subgroup of breast cancers with a unique mutational profile and excellent survival</article-title><source>Proc Natl Acad Sci</source><volume>108</volume><issue>17</issue><year>2011</year><fpage>7265</fpage><lpage>7270</lpage><pub-id pub-id-type="doi">10.1073/pnas.1102826108</pub-id><pub-id pub-id-type="pmid">21482760</pub-id></element-citation></ref><ref id="bib0013"><label>13</label><element-citation publication-type="journal" id="sbref0013"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L.</given-names></name><name><surname>Cheng</surname><given-names>W.-Y.</given-names></name><name><surname>Glicksberg</surname><given-names>B.S.</given-names></name><name><surname>Gottesman</surname><given-names>O.</given-names></name><name><surname>Tamler</surname><given-names>R.</given-names></name><name><surname>Chen</surname><given-names>R.</given-names></name></person-group><article-title>Identification of type 2 diabetes subgroups through topological analysis of patient similarity</article-title><source>Science Translational Medicine</source><volume>7</volume><issue>311</issue><year>2015</year><pub-id pub-id-type="doi">10.1126/scitranslmed.aaa9364</pub-id></element-citation><note><p>311ra174&#x02013;311ra174.</p></note></ref><ref id="bib0014"><label>14</label><element-citation publication-type="journal" id="sbref0014"><person-group person-group-type="author"><name><surname>Bassett</surname><given-names>D.S.</given-names></name><name><surname>Sporns</surname><given-names>O.</given-names></name></person-group><article-title>Network neuroscience</article-title><source>Nature Neuroscience</source><volume>20</volume><year>2017</year></element-citation><note><p>353 EP.</p></note></ref><ref id="bib0015"><label>15</label><element-citation publication-type="journal" id="sbref0015"><person-group person-group-type="author"><name><surname>Torres</surname><given-names>B.Y.</given-names></name><name><surname>Oliveira</surname><given-names>J.H.M.</given-names></name><name><surname>Thomas Tate</surname><given-names>A.</given-names></name><name><surname>Rath</surname><given-names>P.</given-names></name><name><surname>Cumnock</surname><given-names>K.</given-names></name><name><surname>Schneider</surname><given-names>D.S.</given-names></name></person-group><article-title>Tracking resilience to infections by mapping disease space</article-title><source>PLoS Biol</source><volume>14</volume><issue>4</issue><year>2016</year><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1002436</pub-id></element-citation></ref><ref id="bib0016"><label>16</label><element-citation publication-type="journal" id="sbref0016"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>D.</given-names></name><name><surname>Klimm</surname><given-names>F.</given-names></name><name><surname>Harrington</surname><given-names>H.A.</given-names></name><name><surname>Kram&#x000e1;r</surname><given-names>M.</given-names></name><name><surname>Mischaikow</surname><given-names>K.</given-names></name><name><surname>Porter</surname><given-names>M.A.</given-names></name></person-group><article-title>Topological data analysis of contagion maps for examining spreading processes on networks</article-title><source>Nature Communications</source><volume>6</volume><year>2015</year></element-citation><note><p>7723 EP.</p></note></ref><ref id="bib0017"><label>17</label><element-citation publication-type="journal" id="sbref0017"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>J.M.</given-names></name><name><surname>Carlsson</surname><given-names>G.</given-names></name><name><surname>Rabadan</surname><given-names>R.</given-names></name></person-group><article-title>Topology of viral evolution</article-title><source>Proc Natl Acad Sci</source><volume>110</volume><issue>46</issue><year>2013</year><fpage>18566</fpage><lpage>18571</lpage><pub-id pub-id-type="doi">10.1073/pnas.1313480110</pub-id><pub-id pub-id-type="pmid">24170857</pub-id></element-citation></ref><ref id="bib0018"><label>18</label><element-citation publication-type="journal" id="sbref0018"><person-group person-group-type="author"><name><surname>C&#x000e1;mara</surname><given-names>P.G.</given-names></name><name><surname>Levine</surname><given-names>A.J.</given-names></name><name><surname>Rabad&#x000e1;n</surname><given-names>R.</given-names></name></person-group><article-title>Inference of ancestral recombination graphs through topological data analysis</article-title><source>PLoS computationalbiology</source><volume>12</volume><issue>8</issue><year>2016</year><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005071</pub-id></element-citation><note><p>e1005071&#x02013;e1005071.</p></note></ref><ref id="bib0019"><label>19</label><element-citation publication-type="book" id="sbref0019"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>G.</given-names></name><name><surname>Memoli</surname><given-names>F.</given-names></name><name><surname>Carlsson</surname><given-names>G.</given-names></name></person-group><chapter-title>Topological methods for the analysis of high dimensional data sets and 3D object recognition</chapter-title><person-group person-group-type="editor"><name><surname>Botsch</surname><given-names>M</given-names></name><name><surname>Pajarola</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>B</given-names></name><name><surname>Zwicker</surname><given-names>M</given-names></name></person-group><source>Eurographics symposium on point-based graphics</source><year>2007</year><publisher-name>The Eurographics Association</publisher-name><pub-id pub-id-type="doi">10.2312/SPBG/SPBG07/091-100</pub-id></element-citation></ref><ref id="bib0020"><label>20</label><element-citation publication-type="journal" id="sbref0020"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>A.M.</given-names></name><name><surname>Adler</surname><given-names>F.R.</given-names></name><name><surname>Ribeiro</surname><given-names>R.M.</given-names></name><name><surname>Gutenkunst</surname><given-names>R.N.</given-names></name><name><surname>McAuley</surname><given-names>J.L.</given-names></name><name><surname>McCullers</surname><given-names>J.A.</given-names></name></person-group><article-title>Kinetics of coinfection with influenza A virus and Streptococcus pneumoniae.</article-title><source>PLoS Pathogens</source><volume>9</volume><issue>3</issue><year>2013</year><fpage>e1003238</fpage><pub-id pub-id-type="pmid">23555251</pub-id></element-citation></ref><ref id="bib0021"><label>21</label><element-citation publication-type="journal" id="sbref0021"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>A.M.</given-names></name><name><surname>Smith</surname><given-names>A.P.</given-names></name></person-group><article-title>A critical, nonlinear threshold dictates bacterial invasion and initial kinetics during influenza</article-title><source>Scientific Reports</source><volume>6</volume><year>2016</year></element-citation><note><p>38703 EP.</p></note></ref><ref id="bib0022"><label>22</label><element-citation publication-type="journal" id="sbref0022"><person-group person-group-type="author"><name><surname>Hernandez-Vargas</surname><given-names>E.A.</given-names></name><name><surname>Boianelli</surname><given-names>A.</given-names></name><name><surname>Hernandez-Mejia</surname><given-names>G.</given-names></name></person-group><article-title>Bacterial pneumonia fate decisions</article-title><source>IFAC-PapersOnLine</source><volume>51</volume><issue>27</issue><year>2018</year><fpage>390</fpage><lpage>395</lpage><pub-id pub-id-type="doi">10.1016/j.ifacol.2019.02.001</pub-id></element-citation></ref><ref id="bib0023"><label>23</label><element-citation publication-type="journal" id="sbref0023"><person-group person-group-type="author"><name><surname>Almocera</surname><given-names>A.E.S.</given-names></name><name><surname>Hernandez-Mejia</surname><given-names>G.</given-names></name><name><surname>Parra-Rojas</surname><given-names>C.</given-names></name><name><surname>Hernandez-Vargas</surname><given-names>E.A.</given-names></name></person-group><article-title>The trichotomy of pneumococcal infection outcomes in the host</article-title><source>Commun Nonlinear Sci Numer Simul</source><volume>73</volume><year>2019</year><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1016/j.cnsns.2019.01.025</pub-id></element-citation></ref><ref id="bib0024"><label>24</label><element-citation publication-type="journal" id="sbref0024"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>V.K.</given-names></name><name><surname>Klawonn</surname><given-names>F.</given-names></name><name><surname>Mikolajczyk</surname><given-names>R.</given-names></name><name><surname>Hernandez-Vargas</surname><given-names>E.A.</given-names></name></person-group><article-title>Analysis of practical identifiability of a viral infection model</article-title><source>PLoS One</source><year>2016</year><fpage>e0167568</fpage><pub-id pub-id-type="pmid">28036339</pub-id></element-citation></ref><ref id="bib0025"><label>25</label><mixed-citation publication-type="other" id="othref0001">Saul N., van Veen H.J.. MLWave/Kepler-Mapper: 186f (Version 1.0.1). Zenodo. <pub-id pub-id-type="doi">10.5281/zenodo.1054444</pub-id>; 2017.</mixed-citation></ref><ref id="bib0026"><label>26</label><element-citation publication-type="book" id="sbref0025"><person-group person-group-type="author"><name><surname>Edelsbrunner</surname><given-names>H.</given-names></name><name><surname>Harer</surname><given-names>J.</given-names></name></person-group><chapter-title>Computational Topology - an Introduction.</chapter-title><year>2010</year><publisher-name>Am Math Soc</publisher-name></element-citation></ref><ref id="bib0027"><label>27</label><element-citation publication-type="book" id="sbref0026"><person-group person-group-type="author"><name><surname>Hatcher</surname><given-names>A.</given-names></name></person-group><chapter-title>Algebraic topology</chapter-title><year>2000</year><publisher-name>Cambridge Univ. Press</publisher-name><publisher-loc>Cambridge</publisher-loc></element-citation></ref><ref id="bib0028"><label>28</label><element-citation publication-type="journal" id="sbref0027"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>D.</given-names></name></person-group><article-title>Multivariate density estimation: theory, practice, and visualization</article-title><source>John Wiley and Sons</source><year>1992</year></element-citation></ref><ref id="bib0029"><label>29</label><element-citation publication-type="journal" id="sbref0028"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F.</given-names></name><name><surname>Varoquaux</surname><given-names>G.</given-names></name><name><surname>Gramfort</surname><given-names>A.</given-names></name><name><surname>Michel</surname><given-names>V.</given-names></name><name><surname>Thirion</surname><given-names>B.</given-names></name><name><surname>Grisel</surname><given-names>O.</given-names></name></person-group><article-title>Scikit-learn: machine learning in Python</article-title><source>J Mach Learn Res</source><volume>12</volume><year>2011</year><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib0030"><label>30</label><element-citation publication-type="journal" id="sbref0029"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>A.M.</given-names></name></person-group><article-title>Host-pathogen kinetics during influenza infection and coinfection: insights from predictive modeling</article-title><source>Immunol Rev</source><volume>285</volume><issue>1</issue><year>2018</year><fpage>97</fpage><lpage>112</lpage><pub-id pub-id-type="doi">10.1111/imr.12692</pub-id><pub-id pub-id-type="pmid">30129197</pub-id></element-citation></ref><ref id="bib0031"><label>31</label><element-citation publication-type="journal" id="sbref0030"><person-group person-group-type="author"><name><surname>McCullers</surname><given-names>J.A.</given-names></name></person-group><article-title>Insights into the interaction between influenza virus and pneumococcus</article-title><source>Clin Microbiol Rev</source><volume>19</volume><issue>3</issue><year>2006</year><fpage>571</fpage><lpage>582</lpage><pub-id pub-id-type="doi">10.1128/CMR.00058-05</pub-id><pub-id pub-id-type="pmid">16847087</pub-id></element-citation></ref><ref id="bib0032"><label>32</label><element-citation publication-type="journal" id="sbref0031"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>A.M.</given-names></name><name><surname>McCullers</surname><given-names>J.A.</given-names></name><name><surname>Adler</surname><given-names>F.R.</given-names></name></person-group><article-title>Mathematical model of a three-stage innate immune response to a pneumococcal lung infection</article-title><source>JTheorBiol</source><volume>276</volume><issue>1</issue><year>2011</year><fpage>106</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2011.01.052</pub-id></element-citation></ref></ref-list><ack id="ack0001"><title>Acknowledgments</title><p>This research was funded by the <funding-source id="gs00001"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source> (HE-7707/5-1, BR2221/6-1), and the Alfons und Gertrud Kassel-Stiftung. This work was also supported by the Universidad Nacional Autonoma de Mexico (UNAM) and by the LOEWE CMMS at FIAS. We are also grateful to the authors of the Keppler Mapper Python library who diligently answered our questions on the use of the library.</p></ack></back></article>