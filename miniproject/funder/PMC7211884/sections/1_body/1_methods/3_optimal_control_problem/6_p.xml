<?xml version="1.0" encoding="UTF-8"?>
<p>As with all optimal control problems, we begin by formulating the Hamiltonian, 
 <italic>H</italic> = 
 <italic>F</italic>(
 <italic>t</italic>, 
 <italic>x</italic>, 
 <italic>u</italic>) + 
 <italic>λ</italic>(
 <italic>t</italic>)
 <italic>f</italic>(
 <italic>t</italic>, 
 <italic>x</italic>, 
 <italic>u</italic>), where 
 <italic>F</italic>(
 <italic>t</italic>, 
 <italic>x</italic>, 
 <italic>u</italic>) is our cost function (equation (2.15)), 
 <italic>λ</italic>(
 <italic>t</italic>) our adjoint functions and 
 <italic>f</italic>(
 <italic>t</italic>, 
 <italic>x</italic>, 
 <italic>u</italic>) our governing ODEs (equations (
 <xref ref-type="disp-formula" rid="RSOS181843M2x1">2.1</xref>)–(
 <xref ref-type="disp-formula" rid="RSOS181843M2x14">2.14</xref>) above). We give our specific Hamiltonian in full in the electronic supplementary material, S2 appendix. Adjoint equations are defined as d
 <italic>λ</italic>/d
 <italic>t</italic> = −∂
 <italic>H</italic>(
 <italic>t</italic>, 
 <italic>x</italic>*(
 <italic>t</italic>), 
 <italic>u</italic>*(
 <italic>t</italic>), 
 <italic>λ</italic>(
 <italic>t</italic>))/∂
 <italic>x</italic>. The adjoint equations represent the costs that would be incurred by breaking the constraints of the minimization problem. For notational ease, our adjoint functions will be written as 
 <inline-formula>
  <math id="IM29">
   <msubsup>
    <mi>λ</mi>
    <mrow>
     <mo> </mo>
     <mi>j</mi>
    </mrow>
    <mi>i</mi>
   </msubsup>
  </math>
 </inline-formula>, where 
 <italic>i</italic> refers to the settlement of the associated state variable, and 
 <italic>j</italic> to which of the 14 state variables it is associated with. For example, 
 <inline-formula>
  <math id="IM30">
   <msubsup>
    <mi>λ</mi>
    <mrow>
     <mn>2</mn>
    </mrow>
    <mi>i</mi>
   </msubsup>
  </math>
 </inline-formula> is the adjoint function associated with 
 <inline-formula>
  <math id="IM31">
   <msubsup>
    <mi>I</mi>
    <mrow>
     <mi>i</mi>
    </mrow>
    <mi>A</mi>
   </msubsup>
  </math>
 </inline-formula>. As such we will have 14
 <italic>n</italic> adjoint terms in total, 
 <italic>n</italic> being the number of settlements. By using the optimality condition, ∂
 <italic>H</italic>/∂
 <italic>u</italic> = 0, at the optimal state, we can acquire an expression for our control variables in terms of our adjoints and state variables. Namely,
 <disp-formula id="RSOS181843UM2">
  <math id="DM17">
   <mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace">
    <mtr>
     <mtd>
      <msubsup>
       <mi>u</mi>
       <mrow>
        <mn>1</mn>
       </mrow>
       <mi>i</mi>
      </msubsup>
     </mtd>
     <mtd>
      <mo>=</mo>
      <mrow>
       <mfrac>
        <msub>
         <mi>S</mi>
         <mrow>
          <mi>i</mi>
         </mrow>
        </msub>
        <mrow>
         <mn>2</mn>
         <msub>
          <mi>C</mi>
          <mrow>
           <mn>2</mn>
          </mrow>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mi>λ</mi>
       <mrow>
        <mn>1</mn>
       </mrow>
       <mi>i</mi>
      </msubsup>
      <mo>−</mo>
      <msubsup>
       <mi>λ</mi>
       <mrow>
        <mn>7</mn>
       </mrow>
       <mi>i</mi>
      </msubsup>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo>−</mo>
      <mi>ϵ</mi>
      <mo stretchy="false">)</mo>
      <mo>−</mo>
      <msubsup>
       <mi>λ</mi>
       <mrow>
        <mn>10</mn>
       </mrow>
       <mi>i</mi>
      </msubsup>
      <mi>ξ</mi>
      <mo stretchy="false">)</mo>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mtext>and</mtext>
      <mspace width="2em"/>
      <mspace width="2em"/>
      <mspace width="2em"/>
      <msubsup>
       <mi>u</mi>
       <mrow>
        <mn>2</mn>
       </mrow>
       <mi>i</mi>
      </msubsup>
     </mtd>
     <mtd>
      <mo>=</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>3</mn>
       </mfrac>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mrow>
          <mo>−</mo>
          <mn>2</mn>
          <msub>
           <mi>Z</mi>
           <mrow>
            <mi>i</mi>
           </mrow>
          </msub>
         </mrow>
         <msub>
          <mi>ψ</mi>
          <mrow>
           <mi>i</mi>
          </mrow>
         </msub>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mfrac>
           <msubsup>
            <mi>Z</mi>
            <mrow>
             <mi>i</mi>
            </mrow>
            <mn>3</mn>
           </msubsup>
           <msubsup>
            <mi>ψ</mi>
            <mrow>
             <mi>i</mi>
            </mrow>
            <mn>3</mn>
           </msubsup>
          </mfrac>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mn>27</mn>
            <msubsup>
             <mi>λ</mi>
             <mrow>
              <mn>11</mn>
             </mrow>
             <mi>i</mi>
            </msubsup>
            <mi>ϵ</mi>
            <mi>g</mi>
            <msubsup>
             <mi>Z</mi>
             <mrow>
              <mi>i</mi>
             </mrow>
             <mn>2</mn>
            </msubsup>
           </mrow>
           <mrow>
            <mn>4</mn>
            <msub>
             <mi>C</mi>
             <mrow>
              <mn>3</mn>
             </mrow>
            </msub>
            <msub>
             <mi>ψ</mi>
             <mrow>
              <mi>i</mi>
             </mrow>
            </msub>
           </mrow>
          </mfrac>
         </mrow>
         <mo>+</mo>
         <msqrt>
          <mrow>
           <mfrac>
            <mrow>
             <mn>27</mn>
             <msubsup>
              <mi>λ</mi>
              <mrow>
               <mn>11</mn>
              </mrow>
              <mi>i</mi>
             </msubsup>
             <mi>ϵ</mi>
             <mi>g</mi>
             <msubsup>
              <mi>Z</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>5</mn>
             </msubsup>
            </mrow>
            <mrow>
             <mn>2</mn>
             <msub>
              <mi>C</mi>
              <mrow>
               <mn>3</mn>
              </mrow>
             </msub>
             <msubsup>
              <mi>ψ</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>4</mn>
             </msubsup>
            </mrow>
           </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mfrac>
            <mrow>
             <mn>729</mn>
             <msup>
              <mrow>
               <mo stretchy="false">(</mo>
               <msubsup>
                <mi>λ</mi>
                <mrow>
                 <mn>11</mn>
                </mrow>
                <mi>i</mi>
               </msubsup>
               <mi>ϵ</mi>
               <mi>g</mi>
               <mo stretchy="false">)</mo>
              </mrow>
              <mn>2</mn>
             </msup>
             <msubsup>
              <mi>Z</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>4</mn>
             </msubsup>
            </mrow>
            <mrow>
             <mn>16</mn>
             <msup>
              <mrow>
               <msub>
                <mi>C</mi>
                <mrow>
                 <mn>3</mn>
                </mrow>
               </msub>
              </mrow>
              <mn>2</mn>
             </msup>
             <msubsup>
              <mi>ψ</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
            </mrow>
           </mfrac>
          </mrow>
         </msqrt>
         <mo>)</mo>
        </mrow>
        <mrow>
         <mrow>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mo>/</mo>
         </mrow>
         <mrow>
          <mn>3</mn>
         </mrow>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow>
       <mo> </mo>
      </mrow>
     </mtd>
     <mtd>
      <mspace width="1em"/>
      <mo>+</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msubsup>
          <mi>Z</mi>
          <mrow>
           <mi>i</mi>
          </mrow>
          <mn>2</mn>
         </msubsup>
         <mrow>
          <mn>3</mn>
          <msubsup>
           <mi>ψ</mi>
           <mrow>
            <mi>i</mi>
           </mrow>
           <mn>2</mn>
          </msubsup>
         </mrow>
        </mfrac>
       </mrow>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mfrac>
           <msubsup>
            <mi>Z</mi>
            <mrow>
             <mi>i</mi>
            </mrow>
            <mn>3</mn>
           </msubsup>
           <msubsup>
            <mi>ψ</mi>
            <mrow>
             <mi>i</mi>
            </mrow>
            <mn>3</mn>
           </msubsup>
          </mfrac>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mfrac>
           <mrow>
            <mn>27</mn>
            <msubsup>
             <mi>λ</mi>
             <mrow>
              <mn>11</mn>
             </mrow>
             <mi>i</mi>
            </msubsup>
            <mi>ϵ</mi>
            <mi>g</mi>
            <msubsup>
             <mi>Z</mi>
             <mrow>
              <mi>i</mi>
             </mrow>
             <mn>2</mn>
            </msubsup>
           </mrow>
           <mrow>
            <mn>4</mn>
            <msub>
             <mi>C</mi>
             <mrow>
              <mn>3</mn>
             </mrow>
            </msub>
            <msub>
             <mi>ψ</mi>
             <mrow>
              <mi>i</mi>
             </mrow>
            </msub>
           </mrow>
          </mfrac>
         </mrow>
         <mo>+</mo>
         <msqrt>
          <mrow>
           <mfrac>
            <mrow>
             <mn>27</mn>
             <msubsup>
              <mi>λ</mi>
              <mrow>
               <mn>11</mn>
              </mrow>
              <mi>i</mi>
             </msubsup>
             <mi>ϵ</mi>
             <mi>g</mi>
             <msubsup>
              <mi>Z</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>5</mn>
             </msubsup>
            </mrow>
            <mrow>
             <mn>2</mn>
             <msub>
              <mi>C</mi>
              <mrow>
               <mn>3</mn>
              </mrow>
             </msub>
             <msubsup>
              <mi>ψ</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>4</mn>
             </msubsup>
            </mrow>
           </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mfrac>
            <mrow>
             <mn>729</mn>
             <msup>
              <mrow>
               <mo stretchy="false">(</mo>
               <msubsup>
                <mi>λ</mi>
                <mrow>
                 <mn>11</mn>
                </mrow>
                <mi>i</mi>
               </msubsup>
               <mi>ϵ</mi>
               <mi>g</mi>
               <mo stretchy="false">)</mo>
              </mrow>
              <mn>2</mn>
             </msup>
             <msubsup>
              <mi>Z</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>4</mn>
             </msubsup>
            </mrow>
            <mrow>
             <mn>16</mn>
             <msup>
              <mrow>
               <msub>
                <mi>C</mi>
                <mrow>
                 <mn>3</mn>
                </mrow>
               </msub>
              </mrow>
              <mn>2</mn>
             </msup>
             <msubsup>
              <mi>ψ</mi>
              <mrow>
               <mi>i</mi>
              </mrow>
              <mn>2</mn>
             </msubsup>
            </mrow>
           </mfrac>
          </mrow>
         </msqrt>
         <mo>)</mo>
        </mrow>
        <mrow>
         <mrow>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mo>/</mo>
         </mrow>
         <mrow>
          <mn>3</mn>
         </mrow>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo>.</mo>
     </mtd>
    </mtr>
   </mtable>
   <mspace width="2em"/>
  </math>
 </disp-formula>Finally, all that remains is to provide the adjoint equations. Owing to the large number of variables all interacting within the Hamiltonian, a key assumption was made to simplify the derivation of the adjoint equations. We always assume a 
 <italic>spoke-and-hub</italic> network, whereby a central settlement (
 <italic>the hub</italic>), which we shall always define as the settlement 
 <italic>i</italic> = 1, has hosts migrate into it from the other, satellite, settlements (
 <italic>the spokes</italic>). No hosts will migrate out from the central city settlement, and no hosts will migrate from the smaller, outside settlements to one another. Note however that this does not represent a permanent migration, instead just a temporary change in location. All hosts have a designated ‘home node’ which they always return to, but may migrate to another node, creating another opportunity to become infected in a different location. This is shown in 
 <xref ref-type="fig" rid="RSOS181843F2">figure 2</xref> and the adjoint equations are given in full in the electronic supplementary material, S3 appendix. 
</p>
