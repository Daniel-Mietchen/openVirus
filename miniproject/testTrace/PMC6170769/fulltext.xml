<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">J R Soc Interface</journal-id><journal-id journal-id-type="iso-abbrev">J R Soc Interface</journal-id><journal-id journal-id-type="publisher-id">RSIF</journal-id><journal-id journal-id-type="hwp">royinterface</journal-id><journal-title-group><journal-title>Journal of the Royal Society Interface</journal-title></journal-title-group><issn pub-type="ppub">1742-5689</issn><issn pub-type="epub">1742-5662</issn><publisher><publisher-name>The Royal Society</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">30185544</article-id><article-id pub-id-type="doi">10.1098/rsif.2018.0512</article-id><article-id pub-id-type="publisher-id">rsif20180512</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>1004</subject><subject>44</subject><subject>22</subject></subj-group><subj-group subj-group-type="heading"><subject>Life Sciences&#x02013;Mathematics interface</subject></subj-group><subj-group subj-group-type="leader"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Detection of HIV transmission clusters from phylogenetic trees using a multi-state birth&#x02013;death model</article-title><alt-title alt-title-type="short">Detection of HIV transmission clusters from phylogenetic trees using a multi-state birth&#x02013;death model</alt-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5220-5468</contrib-id><name><surname>Barido-Sottani</surname><given-names>Jo&#x000eb;lle</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="aff" rid="af2">2</xref><xref ref-type="corresp" rid="cor1"/></contrib><contrib contrib-type="author"><name><surname>Vaughan</surname><given-names>Timothy G.</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="aff" rid="af2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6431-535X</contrib-id><name><surname>Stadler</surname><given-names>Tanja</given-names></name><xref ref-type="aff" rid="af1">1</xref><xref ref-type="aff" rid="af2">2</xref></contrib></contrib-group><aff id="af1"><label>1</label><addr-line>Department of Biosystems Science and Engineering</addr-line>, <addr-line>ETH Z&#x000fc;rich</addr-line>, <addr-line>Basel</addr-line>, <country>Switzerland</country></aff><aff id="af2"><label>2</label><institution>Swiss Institute of Bioinformatics (SIB)</institution>, <country>Switzerland</country></aff><author-notes><corresp id="cor1">e-mail: <email>joelle.barido-sottani@m4x.org</email></corresp><fn fn-type="other"><p>Electronic supplementary material is available online at <uri xlink:href="https://dx.doi.org/10.6084/m9.figshare.c.4206257">https://dx.doi.org/10.6084/m9.figshare.c.4206257</uri>.</p></fn></author-notes><pub-date pub-type="ppub"><month>9</month><year>2018</year></pub-date><pub-date pub-type="epub"><day>5</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>5</day><month>9</month><year>2018</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>15</volume><issue>146</issue><elocation-id>20180512</elocation-id><history><date date-type="received"><day>6</day><month>7</month><year>2018</year></date><date date-type="accepted"><day>13</day><month>8</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; 2018 The Authors.</copyright-statement><copyright-year>2018</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>Published by the Royal Society under the terms of the Creative Commons Attribution License <uri xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>, which permits unrestricted use, provided the original author and source are credited.</license-p></license><?release-delay 0|0?></permissions><self-uri content-type="pdf" xlink:href="rsif20180512.pdf"/><abstract><p>HIV patients form clusters in HIV transmission networks. Accurate identification of these transmission clusters is essential to effectively target public health interventions. One reason for clustering is that the underlying contact network contains many local communities. We present a new maximum-likelihood method for identifying transmission clusters caused by community structure, based on phylogenetic trees. The method employs a multi-state birth&#x02013;death (MSBD) model which detects changes in transmission rate, which are interpreted as the introduction of the epidemic into a new susceptible community, i.e. the formation of a new cluster. We show that the MSBD method is able to reliably infer the clusters and the transmission parameters from a pathogen phylogeny based on our simulations. In contrast to existing cutpoint-based methods for cluster identification, our method does not require that clusters be monophyletic nor is it dependent on the selection of a difficult-to-interpret cutpoint parameter. We present an application of our method to data from the Swiss HIV Cohort Study. The method is available as an easy-to-use R package.</p></abstract><kwd-group><kwd>phylodynamics</kwd><kwd>multi-state birth&#x02013;death model</kwd><kwd>transmission clusters</kwd><kwd>maximum likelihood</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution>FP7 Ideas: European Research Council</institution><institution-id>http://dx.doi.org/10.13039/100011199</institution-id></institution-wrap></funding-source><award-id>PhyPD 335529</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>September, 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><label>1.</label><title>Background</title><p>Basic epidemiological models rely on the random mixing assumption [<xref rid="RSIF20180512C1" ref-type="bibr">1</xref>]. This requires that each individual in a population has an equal probability of coming into contact with any other individual, which can lead to rapid epidemic spread. The random mixing assumption may be appropriate for airborne diseases in small communities. For sexually transmitted infections (STIs) such as HIV-1 however, this hypothesis does not hold: STIs spread within sexual contact networks that limit the propagation to a specific subset of individuals. Identifying the structure of the sexual contact network has multiple applications, for instance, allowing public health officials to target the populations most vulnerable to infection.</p><p>Previous studies have shown that the spread of HIV among men who have sex with men is driven by quick transmission chains, i.e. groups of infected individuals with genetically similar viruses [<xref rid="RSIF20180512C2" ref-type="bibr">2</xref>,<xref rid="RSIF20180512C3" ref-type="bibr">3</xref>]. We say that patients of such a quick transmission chain form a cluster. A cluster is the result of series of infection events very close in time, and their role in spreading the epidemic affects the efficacy of public health policies: the effectiveness of Treatment as Prevention, a policy currently advocated by the WHO [<xref rid="RSIF20180512C4" ref-type="bibr">4</xref>], will be limited if most of the transmission happens early after infection, before HIV is diagnosed.</p><p>One reason for individuals belonging to a quick transmission chain, i.e. for individuals to form a cluster, is that they are part of the same community in the sexual contact network. A community is defined as a set of nodes in the sexual contact network such that most or all nodes are connected within a community, but few links exist between communities [<xref rid="RSIF20180512C5" ref-type="bibr">5</xref>]. Communities influence the dynamics of an epidemic: at first, the infection spreads quickly in the community where it has been introduced. The rate of transmission then decreases as the population of susceptibles in the community is progressively exhausted [<xref rid="RSIF20180512C6" ref-type="bibr">6</xref>]. Eventually, a new introduction event may occur, where an individual from a previously uninfected community is infected through one of the inter-community connections. As the newly infected community is completely susceptible, the rate of transmission then goes up suddenly as new transmission routes open. Thus, the community structure of the sexual contact network shapes transmission dynamics and, in turn, leaves a footprint in the phylogeny reconstructed from pathogen genetic sequences of different infected individuals within an epidemic. In particular, the community structure induces clusters of individuals in the phylogeny.</p><p>Previous studies have found varying degrees of influence of the contact network on the phylogeny. Welch [<xref rid="RSIF20180512C7" ref-type="bibr">7</xref>] found almost no influence of the clustering coefficient of a network on the shape of transmission trees when the degree distribution of the network was kept constant, and Robinson <italic>et al</italic>. [<xref rid="RSIF20180512C8" ref-type="bibr">8</xref>] found a modest effect of the degree distribution in the network on the shape of phylogenies reconstructed from simulated genetic data. On the other hand, Leventhal <italic>et al</italic>. [<xref rid="RSIF20180512C9" ref-type="bibr">9</xref>] and Bohme [<xref rid="RSIF20180512C10" ref-type="bibr">10</xref>] found that the shapes of phylogenies could be significantly affected by variance in degree distribution and mean path length [<xref rid="RSIF20180512C9" ref-type="bibr">9</xref>] or in degree correlation and clustering coefficient [<xref rid="RSIF20180512C10" ref-type="bibr">10</xref>] of the contact network. The link between network structures and phylogenies is also affected by viral characteristics such as within-host evolution [<xref rid="RSIF20180512C11" ref-type="bibr">11</xref>] and recombination [<xref rid="RSIF20180512C12" ref-type="bibr">12</xref>]. Several methods have been proposed to identify structural characteristics, such as connectivity and clustering coefficient, of the population network from a viral phylogeny [<xref rid="RSIF20180512C13" ref-type="bibr">13</xref>,<xref rid="RSIF20180512C14" ref-type="bibr">14</xref>].</p><p>Phylogenetic clustering methods aim to find transmission clusters within phylogenies, exploiting the effects that, e.g. contact networks have on phylogenies. To this end, a transmission cluster is defined to be a set of individuals belonging to the same transmission chain within a particular community in the contact network. We do not investigate other reasons for clustering beyond the contact network. Phylogenetic clustering methods, which we will refer to as &#x02018;cutpoint-based&#x02019; methods, were evaluated in [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>], also under the assumption that clustering is caused by the contact network. These cutpoint-based methods differ in how they define the distance between tips of the tree, but they have two major features in common: first, they require a difficult-to-interpret cutpoint parameter to be specified by the user; second, they assume that the clusters are monophyletic in the phylogeny or monophyletic in a tree obtained from hierarchical clustering (Def. 4 in [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>]), i.e. that the most recent common ancestor of all tips belonging to a given cluster has no other descending tips. Villandre <italic>et al</italic>. [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>] simulated epidemics and built phylogenetic trees on simulated contact networks, and evaluated the performance of cutpoint-based methods which defined a transmission cluster with cutpoint <italic>x</italic> as either (i) a clade whose tips are separated by a fixed tree distance of at most <italic>x</italic>, where tree distance is the sum of branch lengths, (ii) a clade whose elements are separated by a fixed distance of at most <italic>x</italic>, where distance is the standardized number of different nucleotides between tip sequences, (iii) a clade whose elements are separated by a median pairwise tree distance below <italic>x</italic>, (with <italic>x</italic> an arbitrary percentile of the tree's between-tip distance distribution), where tree distance again corresponds to the sum of branch lengths or (iv) a clade in a dendrogram, i.e. an ultrametric tree obtained from the matrix of between-tip tree distances, cut at height <italic>x</italic>, where the dendrogram was obtained using one of three methods: average linkage, complete linkage or weighted pair-group method of analysis. [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>] found that the presence of nested, non-monophyletic, clusters in the tree as well as the choice of the cutpoint have a strong impact on the quality of the recovered clusters. It also established that the cutpoint values giving the best results for cluster recovery are dependent not only on the distance used but also on the structure of the underlying network. Thus, there is a need for a method that does not have these limitations.</p><p>Multi-state birth&#x02013;death (MSBD) models have been widely used to model population structure and analyse phylogenies built from individuals in a structured population [<xref rid="RSIF20180512C16" ref-type="bibr">16</xref>&#x02013;<xref rid="RSIF20180512C19" ref-type="bibr">19</xref>], in phylogeny epidemiological and macroevolutionary applications. Thus, in principle, such a model may be used to study the phylogeny produced by a sexual contact network and to infer which tips in a phylogeny belong to which transmission cluster, with birth rates being transmission rates and death rates being removal rates. The rationale of the inference is to associate each cluster to a state in the MSBD model, with clusters differing in their transmission dynamics through time.</p><p>The Binary State Speciation and Extinction [<xref rid="RSIF20180512C16" ref-type="bibr">16</xref>] and its extension to multiple states MuSSE, included in the package Diversitree [<xref rid="RSIF20180512C17" ref-type="bibr">17</xref>], were the first efforts to infer state-specific birth and death rates from ultrametric phylogenies, i.e. trees with all tips sampled at the same point in time, where each tip is assigned to a state. In [<xref rid="RSIF20180512C18" ref-type="bibr">18</xref>], these approaches were extended to non-ultrametric trees. More recently, the Beast2 package BDMM [<xref rid="RSIF20180512C19" ref-type="bibr">19</xref>] allowed the joint reconstruction of a phylogeny and quantification of the parameters of an underlying MSBD model. These approaches require the user to specify how many states the model contains and to which state each tip of the phylogeny belongs. An exception to the latter is [<xref rid="RSIF20180512C18" ref-type="bibr">18</xref>], which can integrate over tip states, but does not assign states to tips.</p><p>None of the above approaches are directly applicable to the inference of transmission clusters, for two reasons. First, the state of tips, i.e. which cluster they belong to, is not known prior to the analysis. Second, integrating over the tip states instead of explicitly assigning states to tips means that the partition of tips into clusters cannot be inferred.</p><p>The method Bayesian analysis of macroevolutionary mixtures [<xref rid="RSIF20180512C20" ref-type="bibr">20</xref>] addresses these issues and is able to infer the number of states and to assign each tip to a state. Furthermore, the birth- and death-rate parameters associated with each cluster are estimated. However, it was designed to be used with macroevolutionary datasets, meaning at the time of writing it could only analyse ultrametric trees. For epidemiological datasets, we have non-ultrametric trees as samples are collected through time. Furthermore, its results have been called into question, as [<xref rid="RSIF20180512C21" ref-type="bibr">21</xref>] identified issues regarding the calculation of its likelihood function and its dependency on the user-defined prior for inference of the number of states.</p><p>In this paper, we present a new method to identify transmission clusters in a phylogeny built from viral sequences based on the MSBD model. We note that other authors [<xref rid="RSIF20180512C22" ref-type="bibr">22</xref>] conducted a similar clustering study, relying on pure birth models. McCloskey &#x00026; Poon [<xref rid="RSIF20180512C22" ref-type="bibr">22</xref>] highlight in their acknowledgements section that their study builds upon our ideas which we presented at a conference and outline in the following. We assume here that transmission clusters were induced through communities in sexual contact networks. When a pathogen spreads through such a contact network, the transmission rate typically increases upon the pathogen entering a new community, as the number of susceptible individuals in the new community is typically larger. Our method is designed to detect these &#x02018;jumps&#x02019; in transmission rate, which we associate with the formation of a new cluster. The method assumes decreasing transmission rates within clusters to account for the depletion of susceptibles. In particular, it does not require prior knowledge on the number of clusters or the tip assignment into clusters. We evaluate the performance of this new method on the simulated dataset of [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>] and compare it to cutpoint-based methods. We then apply it to a published HIV phylogeny [<xref rid="RSIF20180512C14" ref-type="bibr">14</xref>] which was obtained based on 192 sequences from the Swiss HIV Cohort Study (SHCS). Finally, we discuss the limitations of the method and planned future work.</p></sec><sec sec-type="methods" id="s2"><label>2.</label><title>Methods</title><sec id="s2a"><label>2.1.</label><title>Model</title><p>We assume an MSBD model similar to the model used in the BDMM package [<xref rid="RSIF20180512C19" ref-type="bibr">19</xref>]. The birth&#x02013;death process starts with one infected individual at time <italic>&#x003c4;</italic> &#x0003e; 0 in the past in an ancestral state (i.e. cluster membership) and is stopped at present time 0. Thus, we measure time in the backward direction, increasing from the present to the root. Without loss of generality, we define the ancestral state to be state 1. State changes occur at a per-lineage rate <italic>&#x003b3;</italic>. Our MSBD model contains an unknown number of states <italic>n</italic>*. We assume identical transition rates between clusters, so that the rate <italic>m</italic><sub><italic>i</italic>,<italic>j</italic></sub> with which hosts in state <italic>i</italic> infect hosts in state <italic>j</italic> is as follows:
<disp-formula id="RSIF20180512UM1"><graphic xlink:href="rsif20180512-e1.jpg" position="float" orientation="portrait"/></disp-formula></p><p>Each individual produces an additional individual at the state- and time-dependent transmission rate <italic>&#x003bb;</italic><sub><italic>i</italic></sub>(<italic>t</italic>) (function of <italic>&#x003bb;</italic><sub>0,<italic>i</italic></sub>, <italic>z</italic><sub><italic>i</italic></sub> as defined below), and is removed with a state-dependent removal rate <italic>&#x003bc;</italic><sub><italic>i</italic></sub> corresponding to the removal rate or rate of &#x02018;becoming non-infectious&#x02019;.</p><p>The depletion of the susceptible population is modelled by the exponential decay of the transmission rates in the process. Each state is associated with a specific initial transmission rate <italic>&#x003bb;</italic><sub>0,<italic>i</italic></sub> and a transmission decay rate <italic>z</italic><sub><italic>i</italic></sub>. <italic>&#x003bb;</italic><sub><italic>i</italic></sub>(<italic>t</italic>) = <italic>&#x003bb;</italic><sub>0,<italic>i</italic></sub> &#x000d7; e<sup><italic>z</italic><sub><italic>i</italic></sub></sup><sup>(<italic>t</italic>&#x02212;<italic>t</italic><sub>0,<italic>i</italic></sub></sup><sup>)</sup> is the transmission rate of a lineage in state <italic>i</italic> at time <italic>t</italic> before the present, where <italic>t</italic><sub>0,<italic>i</italic></sub> is the time of the first introduction into state <italic>i</italic>. As <italic>t</italic> increases into the past, we impose <italic>z</italic><sub><italic>i</italic></sub> &#x02265; 0 so that the transmission rate decreases towards the present.</p><p>The infected individuals are sampled upon removal with a probability <italic>&#x003c3;</italic>. This birth&#x02013;death model produces a tree on all infected individuals together with position and times of state changes on the tree, and we obtain the phylogeny by considering the subtree spanned by the sampled infected individuals. The phylogeny contains information about the transmission and removal times of the sampled individuals, as well as the positions and times of the state changes, as shown in <xref ref-type="fig" rid="RSIF20180512F1">figure 1</xref>. We assume that the state changes correspond to introduction events in newly infected clusters, so that all tips inferred to be in the same state belong to the same transmission cluster.
<fig id="RSIF20180512F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>Visual representation of the phylogeny under an MSBD model. Each state is represented by a colour: the ancestral state, in black, starts at the root and represent the first transmission cluster. The other states, in blue, red and green, start at change points along the tree. These states represent further transmission clusters in the course of the epidemic, and the state change points represent the introduction of the pathogen into a new community. Here <italic>t</italic><sub>c</sub>, <italic>t</italic><sub>t</sub> and <italic>t</italic><sub>s</sub> are the times of, respectively, a state change, transmission and sampling event, as they appear in equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x2">2.2</xref>).</p></caption><graphic xlink:href="rsif20180512-g1"/></fig></p><p>We refer to a node in the phylogeny being either a branching event, a tip, or a state change event. Edges in the phylogeny connect any two nodes, so any edge belongs to only one state.</p></sec><sec id="s2b"><label>2.2.</label><title>Likelihood function</title><p>We now derive the probability density of a phylogeny (including the state changes) given the MSBD parameters, i.e. we derive the likelihood of the parameters given a phylogeny with state changes <italic>L</italic>(<italic>M</italic> | <italic>T</italic>): = pdf(<italic>T</italic> | <italic>M</italic>) with pdf being the probability density function. A full derivation of all equations can be found in the electronic supplementary material, text &#x000a7;1.</p><sec id="s2b1"><label>2.2.1.</label><title>Differential equations</title><p>Following [<xref rid="RSIF20180512C18" ref-type="bibr">18</xref>,<xref rid="RSIF20180512C19" ref-type="bibr">19</xref>], the likelihood of the model parameters given the phylogeny can be calculated from the differential equations below. Equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x1">2.1</xref>) describes the probability <italic>p</italic><sub><italic>i</italic></sub>(<italic>t</italic>) of a lineage in state <italic>i</italic> at time <italic>t</italic> not producing any sampled offspring until the present (referred to extinction probability below). Equation (<xref ref-type="disp-formula" rid="RSIF20180512M2x2">2.2</xref>) describes the probability density <italic>q</italic><sub><italic>i</italic>,<italic>N</italic></sub>(<italic>t</italic>) of an edge <italic>N</italic> in state <italic>i</italic> at time <italic>t</italic> evolving according to the phylogeny in time interval [<italic>t</italic>, 0].</p><p><disp-formula id="RSIF20180512M2x1"><label>2.1</label><graphic xlink:href="rsif20180512-e2.jpg" position="float" orientation="portrait"/></disp-formula>
<disp-formula id="RSIF20180512M2x2"><label>2.2</label><graphic xlink:href="rsif20180512-e3.jpg" position="float" orientation="portrait"/></disp-formula></p><p>The likelihood of the model parameter given a phylogeny starting at root time <italic>&#x003c4;</italic> with initial state <italic>I</italic> is <italic>q</italic><sub><italic>I</italic>,<italic>N</italic></sub>(<italic>&#x003c4;</italic>), meaning the full likelihood can be calculated from equation (<xref ref-type="disp-formula" rid="RSIF20180512M2x2">2.2</xref>). We can also obtain the likelihood per edge by defining the edge likelihood function <italic>f</italic><sub><italic>N</italic></sub> = <italic>q</italic><sub><italic>i</italic>,<italic>N</italic></sub>(<italic>t</italic><sub><italic>b</italic></sub>)/<italic>q</italic><sub><italic>i</italic>,<italic>N</italic></sub>(<italic>t</italic><sub><italic>e</italic></sub>) for an edge <italic>N</italic> in state <italic>i</italic> with start time <italic>t</italic><sub><italic>b</italic></sub> and end time <italic>t</italic><sub><italic>e</italic></sub>. <italic>f</italic><sub><italic>N</italic></sub> follows the differential equation in equation (<xref ref-type="disp-formula" rid="RSIF20180512M2x2">2.2</xref>) with initial condition <italic>f</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>e</italic></sub>) = 1. The full likelihood of the model <italic>M</italic> given the phylogeny <italic>T</italic> is then obtained by multiplying the likelihoods of all edges as shown in equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x3">2.3</xref>), where <italic>n</italic> is the number of states (including the root state) in the tree, <italic>N</italic><sub><italic>i</italic></sub> is the set of edges in state <italic>i</italic>, <italic>T</italic><sub><italic>i</italic></sub> the set of transmission events in state <italic>i</italic> and <italic>S</italic><sub><italic>i</italic></sub> the set of tips in state <italic>i</italic>.
<disp-formula id="RSIF20180512M2x3"><label>2.3</label><graphic xlink:href="rsif20180512-e4.jpg" position="float" orientation="portrait"/></disp-formula></p><p>This likelihood function can be applied to trees with or without a root edge, i.e. trees starting with one lineage or two at time <italic>&#x003c4;</italic>.</p></sec></sec><sec id="s2c"><label>2.3.</label><title>Approximations to the likelihood function</title><p>The model as described so far is mathematically rigorous; however, performing a maximum-likelihood (ML) inference on this model is computationally complex. As a result, we now introduce several approximations.</p><sec id="s2c1"><label>2.3.1.</label><title>Ignoring state changes in unsampled subtrees</title><p>The equations for <italic>p</italic> and <italic>f</italic><sub><italic>N</italic></sub> do not have an analytical solution. Numerical integration is computationally expensive and can be unstable for certain parameters. We thus make the assumption that no state changes happen in the unsampled parts of the tree, meaning all state changes occur on lineages that are observed in the final tree. With this assumption, the master equation for <italic>p</italic><sub><italic>i</italic></sub>(<italic>t</italic>) changes to equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x4">2.4</xref>).
<disp-formula id="RSIF20180512M2x4"><label>2.4</label><graphic xlink:href="rsif20180512-e5.jpg" position="float" orientation="portrait"/></disp-formula></p></sec><sec id="s2c2"><label>2.3.2.</label><title>Simplifying the number of states</title><p>As the real number of states in the underlying network <italic>n</italic>* is unknown, we need to estimate it. However, once the approximation described in the previous section is applied, this parameter only appears in the likelihood in the factor (<italic>&#x003b3;</italic>/(<italic>n</italic>* &#x02212;1))<sup><italic>n</italic>&#x02212;1</sup>, so maximizing the likelihood is equivalent to minimizing <italic>n</italic>*. We further assume that each migration enters a previously not visited state, i.e. <italic>n</italic>* &#x02265; <italic>n</italic>. Together, the ML estimate will always be <italic>n</italic>* = <italic>n</italic>. Thus, we fix <italic>n</italic>* = <italic>n</italic> in the inference.</p></sec><sec id="s2c3"><label>2.3.3.</label><title>Time discretization</title><p>Equations&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x4">2.4</xref>) and&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x2">2.2</xref>) have an analytical solution for constant transmission and removal rates, but not necessarily for time-dependent rates. To obtain a closed form solution, we use time discretization and assume that the transmission rates can be considered locally constant on small enough intervals. The grid size used for the discretization is fixed across the tree and needs to be specified by the user. A smaller size will improve the accuracy of the likelihood calculation but also increase the computational cost.</p><sec id="s2c3a"><label>2.3.3.1.</label><title>Time discretization for <italic>p</italic></title><p>A closed form of the extinction probability and the likelihood function can be obtained for piecewise constant transmission and removal rates. Assuming constant rates in equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x4">2.4</xref>), and a generic initial condition <italic>p</italic><sub><italic>i</italic></sub>(<italic>t</italic><sub>IC</sub>) = <italic>V</italic><sub>IC</sub> (rather than the initial condition <italic>p</italic><sub><italic>i</italic></sub>(0) = 1), we obtain an analytic solution of equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x4">2.4</xref>)
<disp-formula id="RSIF20180512M2x5"><label>2.5</label><graphic xlink:href="rsif20180512-e6.jpg" position="float" orientation="portrait"/></disp-formula>This solution can be verified by differentiating the solution and substituting the result into equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x4">2.4</xref>).</p><p>To obtain <italic>p</italic><sub><italic>i</italic></sub>(<italic>t</italic>) using this time discretization, we divide the time interval [<italic>&#x003c4;</italic>; 0] into a grid. Starting with <italic>p</italic><sub><italic>i</italic></sub>(0) = 1, we can then evaluate <italic>p</italic><sub><italic>i</italic></sub> using equation (<xref ref-type="disp-formula" rid="RSIF20180512M2x5">2.5</xref>) in each grid interval going backwards in time, using as initial value the solution of the previous grid interval.</p></sec><sec id="s2c3b"><label>2.3.3.2.</label><title>Time discretization for <italic>f</italic><sub><italic>N</italic></sub></title><p>A closed-form solution of the edge-likelihood function <italic>f</italic><sub><italic>N</italic></sub> can now be calculated, for a small time interval [<italic>t</italic><sub><italic>l</italic></sub>; <italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>] on an edge <italic>N</italic> in state <italic>i</italic>. This expression uses the value of <italic>p</italic><sub><italic>i</italic></sub>(<italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>), calculated as explained above. We define <italic>f</italic><sub><italic>N</italic></sub>(<italic>t</italic>, <italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>) = <italic>q</italic><sub><italic>i</italic>,<italic>N</italic></sub>(<italic>t</italic>)/<italic>q</italic><sub><italic>i</italic>,<italic>N</italic></sub>(<italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>), and obtain
<disp-formula id="RSIF20180512M2x6"><label>2.6</label><graphic xlink:href="rsif20180512-e7.jpg" position="float" orientation="portrait"/></disp-formula>with <italic>c</italic>, <italic>x</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic></sub> as defined in equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x5">2.5</xref>).</p><p>This expression for <italic>f</italic><sub><italic>N</italic></sub>(<italic>t</italic>, <italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>) is a solution of the differential equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x2">2.2</xref>) on the interval [<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>] with <italic>f</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>) = 1, assuming the rates &#x003bb;<sub><italic>i</italic></sub> are constant in this interval and using the approximate function <italic>p</italic><sub><italic>i</italic></sub>(<italic>t</italic>) from equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x5">2.5</xref>). This can be easily verified by differentiating equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x6">2.6</xref>) and substituting the resulting (d/d<italic>t</italic>)<italic>f</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>l</italic>&#x02212;1</sub>) into the differential equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x2">2.2</xref>). We then have <inline-formula><inline-graphic xlink:href="rsif20180512-i1.jpg"/></inline-formula>.</p><p>Equations&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x5">2.5</xref>) and&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x6">2.6</xref>) are identical in form to the expressions used in the birth&#x02013;death skyline model [<xref rid="RSIF20180512C23" ref-type="bibr">23</xref>], with the piecewise constant birth rate variation being governed by the exponential decay mechanism described earlier.</p></sec></sec></sec><sec id="s2d"><label>2.4.</label><title>Algorithm</title><p>We now present an algorithm which identifies the cluster configuration and associated parameters that maximize the likelihood in equation&#x000a0;(<xref ref-type="disp-formula" rid="RSIF20180512M2x3">2.3</xref>) for a particular phylogeny <italic>T</italic>. More details can be found in the electronic supplementary material, text &#x000a7;2.</p><sec id="s2d1"><label>2.4.1.</label><title>Maximum-likelihood search</title><p>We use a greedy approach to add state changes until no further improvement of the likelihood can be obtained. New ML estimates are obtained for all transmission, decay, removal and state change rates each time a new state change is added, but the positions and times of previous state changes are fixed.</p><p>Once a configuration has been found in which no more state changes can be added to improve the likelihood, we will attempt to recursively remove all the states from this configuration. This step is designed to compensate partly for the fact that the greedy approach never goes back on previous state change assignments, and so can end up in sub-optimal configurations.</p><p>Once no further improvements of the likelihood can be obtained by either adding or removing a state, the method will return the best fitting model found, including the state configuration and the ML estimates for all parameters.</p><p>The full algorithm is as follows:
<list list-type="simple"><list-item><label>(1)</label><p>Find the most likely parameters for a one-state birth&#x02013;death model (i.e. with identical birth and death rates across the tree).</p></list-item><list-item><label>(2)</label><p>For all edges in the tree:
<list list-type="simple"><list-item><label>(a)</label><p>add a state change on this edge, then</p></list-item><list-item><label>(b)</label><p>find the most likely parameters (i.e. transmission, removal and state change rates) for this state configuration, then</p></list-item><list-item><label>(c)</label><p>keep this configuration as candidate if its likelihood is higher than previously tested configurations with <italic>n</italic> + 1 states.</p></list-item></list></p></list-item><list-item><label>(3)</label><p>If a configuration with <italic>n</italic> + 1 states was found that is more likely than the configuration with <italic>n</italic> states, keep it and go back to step 2.</p></list-item><list-item><label>(4)</label><p>For each state change in the configuration:</p><list list-type="simple"><list-item><label>(a)</label><p>remove this state change.</p></list-item><list-item><label>(b)</label><p>find the most likely parameters for this state configuration, and</p></list-item><list-item><label>(c)</label><p>if the configuration without this state was more likely than the previous configuration, keep it.</p></list-item></list></list-item><list-item><label>(5)</label><p>If at least one state was removed, go back to step 4.</p></list-item><list-item><label>(6)</label><p>Otherwise, end and record the most likely model.</p></list-item></list></p></sec><sec id="s2d2"><label>2.4.2.</label><title>Time positions of state changes</title><p>The model and the likelihood function allow for state changes to be placed anywhere on an edge. However, comparing the likelihood values between configurations with different numbers of states is a problem in an ML framework, as the parameter spaces are of different sizes: indeed, the time of introduction into the <italic>n</italic> + 1th cluster is an additional continuous parameter. To allow an optimization across different numbers of states, we thus limit the positioning of state changes to predetermined discrete positions on edges: they can be positioned at either 10%, 50% or 90% of the length of the edge they are on. An intermediate option is also available, which will test all three predetermined options and keep the most likely.</p><p>In the actual epidemic, an introduction event is always simultaneous with a transmission event, which is not possible under our MSBD model. However, cluster introduction events can be placed close to transmission events in the tree, so this should not affect the accuracy of the inference. Furthermore, due to incomplete sampling, the introduction events may actually fall on branches.</p></sec></sec><sec id="s2e"><label>2.5.</label><title>Implementation</title><p>The likelihood calculation and ML inference are implemented as the publicly available R package <monospace>ML.MSBD</monospace>. The package takes as input a phylogenetic tree with branches in units of time, in the <monospace>phylo</monospace> format implemented by the package <monospace>APE</monospace> [<xref rid="RSIF20180512C24" ref-type="bibr">24</xref>]. Partial results of the inference are automatically saved after each optimization step, so that an interrupted run can be resumed at any point. The full results returned include the best estimates for the number and positions of cluster introductions, as well as all initial transmission rates, transmission decay rates and removal rates of each state. Furthermore, we return the ML values for each number of states <italic>n</italic> up to <inline-formula><inline-graphic xlink:href="rsif20180512-i2.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="rsif20180512-i3.jpg"/></inline-formula> is the ML inferred number of states. An evaluation of the performance of the package can be found in the electronic supplementary material, text &#x000a7;5.</p></sec></sec><sec id="s3"><label>3.</label><title>Results</title><sec id="s3a"><label>3.1.</label><title>Cluster inference on simulated data</title><sec id="s3a1"><label>3.1.1.</label><title>Dataset</title><p>We use a simulated dataset produced by Villandre <italic>et al</italic>. [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>], which contains simulated epidemics on three different types of networks, A, B and C. The network structure A is composed of 13 communities of 20 subjects each, with each community being a fully connected graph and one bridge linking any two communities.</p><p>The network structure B consists of one central community of size 60, representing a main sexual contact network, connected by single bridges to 25 communities of size 20. Each small community is a fully connected graph. These small communities represent disjoint sexual contact subnetworks in a population of interest.</p><p>The network structure C contains 100 communities, whose size was sampled from a distribution obtained from a phylogeny of the SHCS dataset (see [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>] for details). To ensure that all communities are accessible, they are first linked in a chain. Additional bridges are then created by connecting any two vertices belonging to different communities with probability 0.00075.</p><p>In all network types, edges between communities are weighted with a weight of 0.25, 0.5, 0.75 or 1, meaning that the rate of transmission on these edges is respectively 25%, 50%, 75% and 100% of the transmission rate on within-community edges.</p><p>Epidemics were simulated on these networks starting from one random introduction in A networks, one random introduction in the main community in B networks, and two random introductions in C networks. All infected individuals were sampled upon removal and a transmission tree was built from the sampled tips. Thus, there is no phylogenetic uncertainty in this dataset: the tree represents exactly the simulated epidemic. For each type of network (A,B,C) and each weighting scheme (<italic>w</italic> = 0.25, 0.5, 0.75 or 1), 300 epidemics were simulated, for a total dataset of 3600 trees.</p><p>Network structure B was designed to correspond best to the monophyletic assumption of the cutpoint-based clustering methods: the epidemic starts in the main cluster and the smaller communities are not connected with each other, so all infections originating from the same introduction will be grouped in a single clade. Network structure A, on the other hand, allows for the possibility of multiple introductions in the same community and onward transmission in further communities inducing nested clusters, thus breaking some of the assumptions of the cutpoint-based methods. More details about the networks are presented in the electronic supplementary material, text &#x000a7;3.</p></sec><sec id="s3a2"><label>3.1.2.</label><title>Comparison of our method with cutpoint-based methods</title><p>We ran our ML inference on the trees to assign states to tips, and interpret different states as different transmission clusters. In accordance with the simulation conditions, we set <italic>&#x003c3;</italic> = 1 in the inference. The removal rates <italic>&#x003bc;</italic><sub><italic>i</italic></sub> are assumed independent of the community, and so were set to the same value <italic>&#x003bc;</italic> for all states. The time positions of the state changes were fixed using the intermediate option of testing positions at 10%, 50% and 90% of the length of the edges.</p><p>The correspondence between the real network communities and the clusters inferred from the tree was assessed using the adjusted Rand index (ARI) [<xref rid="RSIF20180512C25" ref-type="bibr">25</xref>,<xref rid="RSIF20180512C26" ref-type="bibr">26</xref>]. This index measures the number of pairs of tips which are clustered identically in both clusterings, i.e. either in the same cluster or in two different clusters in both arrangements, compared to the number of pairs which are clustered differently. The ARI ranges from &#x02212;1 to 1: a value of 1 indicates a perfect match of the inferred clustering to the truth, a value of 0 indicates that the inferred clustering matches the truth no better than a clustering drawn at random, and negative values indicate that the inferred clustering is worse than would be expected by chance.</p><p>We compare the results from our method to the results obtained by Villandre <italic>et al</italic>. [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>] using cutpoint-based clustering methods.</p><p><xref ref-type="fig" rid="RSIF20180512F2">Figure 2</xref> and electronic supplementary material, figure S2 show the scores obtained by our MSBD method on the simulated A,B,C networks compared to the scores of the cutpoint-based clustering methods, respectively, for weights <italic>w</italic> = 0.25 and <italic>w</italic> = 1 and for weights <italic>w</italic> = 0.5 and <italic>w</italic> = 0.75. All methods used the same cutpoints values, except for the method based on Definition 3 (Def. 3). Data corresponding to this method were rescaled to fit in the same figure.
<fig id="RSIF20180512F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>Comparison of the average ARI obtained by the different clustering methods in function of the cutpoint on networks A (parts A1,A2), B (parts B1,B2) and C (parts C1,C2). For each network, the first column (part 1) shows the results for weight <italic>w</italic> = 0.25 and the second column (part 2) for <italic>w</italic> = 1. Our proposed MSBD method is not dependent on a cutpoint. The cutpoint for Definition 3. is shown on the top <italic>x</italic>-axis, the cutpoints for all other definitions are shown on the bottom <italic>x</italic>-axis.</p></caption><graphic xlink:href="rsif20180512-g2"/></fig></p><p>As shown in [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>], the results of the cutpoint-based methods are highly variable and good scores can only be obtained from a narrow range of cutpoints. In addition, the best cutpoint value is highly dependent on the underlying network structure: in methods other than Def. 3, the best scores are obtained for a cutpoint of <italic>c</italic> &#x02248; 0.15 for networks A, <italic>c</italic> &#x02248; 0.03 for networks B and <italic>c</italic> &#x02248; 0.02 for networks C. For Def. 3, the best score is obtained for <italic>c</italic> &#x02248; 0.05 for networks A, <italic>c</italic> &#x02248; 0.16 for networks B and <italic>c</italic> &#x02248; 0.04 for networks C. We define the &#x02018;peak range&#x02019; of cutpoints for each method, network structure and weighting scheme as the range of cutpoints which give a score that is at least 75% of the best score obtained for any cutpoint. With this definition, the peak ranges are very narrow, with an average length of, respectively, 0.008, 0.015 and 0.016 for networks A, B and C in methods other than Def. 3. The peak ranges obtained with Def. 3 are much wider, but a direct comparison is difficult due to the different definition used for the cutpoint. In all methods, the peak ranges for networks A and C on the one hand, and B on the other hand have very little overlap and the best cutpoint for B is never found in the peak range of either A or C, and vice versa. In conclusion, it is impossible to get good results from all network types with any single cutpoint value.</p><p>In addition, the cutpoint-based methods are sensitive to network features and in particular limited by the monophyletic assumption. In both the A and C networks, the best score obtained by any cutpoint-based method is &#x02248; 0.45 for the weighting scheme <italic>w</italic> = 0.25 and &#x02248; 0.55 for <italic>w</italic> = 1, whereas it goes up to &#x02248; 0.85 and &#x02248; 0.9, respectively, in networks B. An example of inference on a tree with nested cluster introductions is shown in electronic supplementary material, figure S3.</p><p>In comparison, the MSBD method performs less well on B networks, with an average score of 0.73 for <italic>w</italic> = 0.25 and 0.49 for <italic>w</italic> = 1. However, it performs much better on A networks, with an average score of 0.64 for <italic>w</italic> = 0.25 and 0.53 for <italic>w</italic> = 1. The worst results are obtained on the C networks, where the average score is &#x02248; 0.2 for all weights, less than half the best scores obtained by cutpoint-based methods.</p><p>The low scores obtained on the C networks point to a potential limitation of our method on the number of clusters that can be inferred from a tree. The trees simulated on the C networks contain clusters that have on average fewer elements and a higher proportion of very small clusters than the trees simulated on the A and B networks. These clusters may be harder to detect due to their low signal. This is supported by the number of inferred clusters shown in electronic supplementary material, table S1, which shows that the MSBD inference infers the correct number of clusters for networks A and B, but strongly underestimates it in networks C. To confirm this hypothesis, we calculated the scores obtained by the MSBD method when excluding all tips that belonged to a cluster with strictly less than eight tips. The results are shown in <xref ref-type="fig" rid="RSIF20180512F2">figure 2</xref> (dotted line). The proportion of tips excluded by applying this criterion is shown in <xref rid="RSIF20180512TB1" ref-type="table">table 1</xref>. The scores of all network structures and all weighting schemes improved when applying this criterion. The improvement increased with the proportion of tips belonging to the excluded clusters, supporting our hypothesis that the MSBD method has difficulty identifying them. In particular, the MSBD scores on the C network structure for weight &#x02265;0.5 increase to a level on par with the best scores obtained by cutpoint-based methods.
<table-wrap id="RSIF20180512TB1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Percentage (%) of tips belonging to clusters with strictly less than eight tips, per network structure and weighting scheme.</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead valign="bottom"><tr><th align="left" rowspan="1" colspan="1">network type</th><th align="left" rowspan="1" colspan="1">A</th><th align="left" rowspan="1" colspan="1">B</th><th align="left" rowspan="1" colspan="1">C</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><italic>w</italic> = 0.25</td><td rowspan="1" colspan="1">9.0</td><td rowspan="1" colspan="1">9.9</td><td rowspan="1" colspan="1">33.9</td></tr><tr><td rowspan="1" colspan="1"><italic>w</italic> = 0.5</td><td rowspan="1" colspan="1">15.3</td><td rowspan="1" colspan="1">16.0</td><td rowspan="1" colspan="1">44.6</td></tr><tr><td rowspan="1" colspan="1"><italic>w</italic> = 0.75</td><td rowspan="1" colspan="1">21.7</td><td rowspan="1" colspan="1">20.8</td><td rowspan="1" colspan="1">51.4</td></tr><tr><td rowspan="1" colspan="1"><italic>w</italic> = 1</td><td rowspan="1" colspan="1">25.1</td><td rowspan="1" colspan="1">22.2</td><td rowspan="1" colspan="1">55.5</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="s3b"><label>3.2.</label><title>Quality of the parameter inference</title><p>To evaluate the performance of our MSBD method beyond cluster identification, we simulated several datasets of 200 trees each under the MSBD process, with various parameter combinations. Simulations were done using Gillespie's algorithm [<xref rid="RSIF20180512C27" ref-type="bibr">27</xref>] for forward simulation of stochastic processes. Birth&#x02013;death trees were simulated to have either one state (<italic>&#x003b3;</italic> = 0) or multiple states sharing the same birth, birth decay and death rates (<italic>&#x003b3;</italic> &#x0003e; 0). Tips were sampled upon removal and the process was run until the tree reached 50 sampled tips. The MSBD method was then applied directly to the simulated trees. Because these trees were not built from network simulations, we did not try to assess the quality of the cluster inference, but we focused on the quality of the parameter inference and on whether our method can adequately distinguish between trees that contain several states and trees that do not.</p><p>The results are summarized in <xref rid="RSIF20180512TB2" ref-type="table">table 2</xref>. We can see that although the MSBD method is able to consistently infer multiple states when they are present, it will also wrongly detect one additional state in around 25% of the trees that only contain one state. This may be a problem of noise, where due to the stochasticity of the simulation one subtree is slightly more likely when attributed different rates than the rest of the tree. This problem can be alleviated by looking at the difference in the inferred transmission rates of each state, which are also estimated by our method: a smaller difference is more likely to be indicative of noise. As previously noted, the method also tends to underestimate the number of states in multi-state trees, mostly because it cannot detect states with only a few tips.
<table-wrap id="RSIF20180512TB2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Parameter inference on simulated datasets. Each dataset contains 200 trees of 50 tips each, simulated under an MSBD process using Gillespie's algorithm. Transmission rates are averaged over the entire tree.</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/><col align="left" span="1"/></colgroup><thead valign="bottom"><tr><th align="left" colspan="2" rowspan="1">dataset parameters<hr/></th><th align="left" rowspan="1" colspan="1"><italic>&#x003bb;</italic><sub>0</sub> = 25, <italic>z</italic> = 12, <italic>&#x003bc;</italic> = 1, <italic>&#x003b3;</italic> = 0</th><th align="left" rowspan="1" colspan="1"><italic>&#x003bb;</italic><sub>0</sub> = 25, <italic>z</italic> = 15, <italic>&#x003bc;</italic> = 1, <italic>&#x003b3;</italic> = 0</th><th align="left" rowspan="1" colspan="1"><italic>&#x003bb;</italic><sub>0</sub> = 10, <italic>z</italic> = 1, <italic>&#x003bc;</italic> = 5, <italic>&#x003b3;</italic> = 0.5</th><th align="left" rowspan="1" colspan="1"><italic>&#x003bb;</italic><sub>0</sub> = 10, <italic>z</italic> = 2, <italic>&#x003bc;</italic> = 5, <italic>&#x003b3;</italic> = 0.5</th></tr></thead><tbody><tr><td rowspan="3" colspan="1">average number of clusters</td><td rowspan="1" colspan="1">simulated</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">4.95</td><td rowspan="1" colspan="1">6.38</td></tr><tr><td rowspan="1" colspan="1">&#x0003e;5 individuals, simulated</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">1.92</td><td rowspan="1" colspan="1">2.49</td></tr><tr><td rowspan="1" colspan="1">inferred</td><td rowspan="1" colspan="1">1.22</td><td rowspan="1" colspan="1">1.25</td><td rowspan="1" colspan="1">2.43</td><td rowspan="1" colspan="1">2.65</td></tr><tr><td rowspan="3" colspan="1">average transmission rate</td><td rowspan="1" colspan="1">simulated</td><td rowspan="1" colspan="1">1.09</td><td rowspan="1" colspan="1">0.86</td><td rowspan="1" colspan="1">6.95</td><td rowspan="1" colspan="1">5.40</td></tr><tr><td rowspan="1" colspan="1">inferred</td><td rowspan="1" colspan="1">1.54</td><td rowspan="1" colspan="1">1.38</td><td rowspan="1" colspan="1">7.52</td><td rowspan="1" colspan="1">6.20</td></tr><tr><td rowspan="1" colspan="1">median absolute error</td><td rowspan="1" colspan="1">0.37</td><td rowspan="1" colspan="1">0.49</td><td rowspan="1" colspan="1">0.75</td><td rowspan="1" colspan="1">0.78</td></tr><tr><td rowspan="3" colspan="1">average removal rate</td><td rowspan="1" colspan="1">simulated</td><td rowspan="1" colspan="1">1.0</td><td rowspan="1" colspan="1">1.0</td><td rowspan="1" colspan="1">5.0</td><td rowspan="1" colspan="1">5.0</td></tr><tr><td rowspan="1" colspan="1">inferred</td><td rowspan="1" colspan="1">0.88</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">4.64</td><td rowspan="1" colspan="1">4.50</td></tr><tr><td rowspan="1" colspan="1">median absolute error</td><td rowspan="1" colspan="1">0.21</td><td rowspan="1" colspan="1">0.20</td><td rowspan="1" colspan="1">0.73</td><td rowspan="1" colspan="1">0.71</td></tr></tbody></table></table-wrap></p><p>Regarding the parameter inference, the method has a slight bias towards overestimating the transmission rate and underestimating the removal rate. This is potentially due to our simulation process being conditioned on reaching 50 tips, which could bias datasets in favour of trees showing apparent higher diversification rates [<xref rid="RSIF20180512C28" ref-type="bibr">28</xref>]. Overall, the absolute error on the inferred parameters remains low compared to the true values, both in datasets with one cluster and in datasets with multiple clusters.</p><p>We performed a similar analysis on datasets simulated with incomplete sampling <italic>&#x003c3;</italic> = 0.75 or <italic>&#x003c3;</italic> = 0.5, shown in electronic supplementary material, tables S4 and S5 (electronic supplementary material, text &#x000a7;6). The accuracy of the parameter inferences decreases with lower sampling proportions, in particular in the transmission rate estimates. However, the relative error remains low and the MSBD parameter estimates remain reliable even with lower sampling proportions.</p><p>In conclusion, the parameter inference from the MSBD method is reliable, although it suffers from noise when applied to trees which contain only one state.</p></sec><sec id="s3c"><label>3.3.</label><title>Cluster inference on HIV dataset</title><p>In this section, we analyse a tree used in another study of the correlation between sexual networks and tree features [<xref rid="RSIF20180512C14" ref-type="bibr">14</xref>]. HIV-1 subtype B pol sequences were obtained from the SHCS 192. While the Swiss epidemic includes a mixture of population risk groups including heterosexuals, injecting drug users and MSM, only viral samples from MSM were analysed. A large cluster including almost 200 sampled individuals who predominantly lived or sought treatment in the Z&#x000fc;rich area was identified from an ML phylogeny of the complete dataset. The phylogeny of this cluster was then obtained by fitting a SIR-type pairwise epidemic model to this sub-epidemic while simultaneously inferring the tree from the sequence data in BEAST2. We re-analyse the maximum clade credibility tree provided for that cluster in the supporting information of [<xref rid="RSIF20180512C14" ref-type="bibr">14</xref>].</p><p>The results of the MSBD analysis are shown in <xref ref-type="fig" rid="RSIF20180512F3">figure 3</xref><italic>a</italic>. Three sub-clusters are identified in the tree, one with a higher base transmission rate than in the backbone of the tree, and two with similar base transmission rates which are lower than in the backbone of the tree.
<fig id="RSIF20180512F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>Analysis of the empirical HIV tree. Comparison of the clusters obtained with MSBD (<italic>a</italic>) or with Cluster Picker with a bootstrap threshold of 0.0 and a genetic distance threshold of 1.5% (<italic>b</italic>), 4.5% (<italic>c</italic>) and 8% (<italic>d</italic>).</p></caption><graphic xlink:href="rsif20180512-g3"/></fig></p><p>We compare our results to results obtained using the software Cluster Picker [<xref rid="RSIF20180512C29" ref-type="bibr">29</xref>] and PhyloPart [<xref rid="RSIF20180512C30" ref-type="bibr">30</xref>], phylogenetic cutpoint-based method which detect clusters based on a combination of bootstrap support at the nodes and respectively genetic distance between tip sequences or patristic distances. Genetic sequences were generated for the tree using the software SeqGen [<xref rid="RSIF20180512C31" ref-type="bibr">31</xref>] (see electronic supplementary material, text &#x000a7;4 for more details).</p><p>The results of Cluster Picker are shown in <xref ref-type="fig" rid="RSIF20180512F3">figure 3</xref> and the results of PhyloPart in electronic supplementary material, figure S4. As both led to similar results, we will only discuss the results for Cluster Picker here. As with other cutpoint-based methods, the results depend strongly on the user-defined values. We used three different cutpoint values for the genetic distance: 1.5%, 4.5% and 8%. 4.5% is the default value proposed by Cluster Picker and is the higher bound of the range recommended by Cluster Picker for HIV data, whereas 1.5% is the lower bound of the recommended range. For the bootstrap support threshold, we used the value 0.0. With this value, the bootstrap support is disregarded entirely, which mimics the behaviour of the methods studied by [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>]. The results are shown in <xref ref-type="fig" rid="RSIF20180512F3">figure 3</xref>. We observe that the number of identified clusters is strongly dependent on the cutpoint values, in keeping with the results obtained by [<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>]. The size of the identified clusters varies also widely, even within the bounds of the recommended range of cutpoints.</p><p>One interesting thing to note is that the cluster pattern identified by MSBD cannot be obtained by Cluster Picker even when varying the threshold used. Cutpoint thresholds which include all of the (non-root) clusters detected by MSBD typically include additional small clusters which are not supported by the MSBD model. On the other hand, reducing the threshold to avoid these spurious clusters causes Cluster Picker to miss clusters supported by MSBD.</p></sec></sec><sec id="s4"><label>4.</label><title>Discussion</title><p>We have introduced a novel method of identifying transmission clusters from a phylogeny, based on an MSBD model. This model is designed to identify transmission clusters induced by a pathogen spreading in a contact network with communities. Transmission clusters are defined as all individuals belonging to a transmission chain within a single community. It will be an interesting future work to investigate the ability of the MSBD model to infer clusters formed due to other dynamics such as superspreading. Beyond HIV, our method is applicable to any epidemic where the transmission dynamics are governed by a contact network structure.</p><p>Our likelihood function makes two important assumptions: the first one is that each community is entered precisely once, and the second one is that unsampled subtrees, i.e. subtrees that do not appear in the reconstructed phylogeny, do not contain cluster introduction events. The implementation also relies on a time discretization which approximates all transmission rates as locally constant on small time intervals. A similar discretization can be applied to extend our method to time-dependent removal rates, which are not currently supported.</p><p>This new method has a few key differences compared to the cutpoint-based clustering methods. Firstly, it is not restricted to monophyletic clades and can thus find clusters that are nested within one another in the phylogeny. As a result, our method clearly outperformed the others on simulated networks which were designed specifically to violate the monophyletic assumption. This issue is particularly problematic in datasets that have been sampled over an extended period of time, as nested introduction events are more likely to appear there.</p><p>Secondly, as the MSBD method is model-based, it does not rely on an arbitrary cutpoint to be chosen by the user. Instead, we look for significant changes in transmission rates. While our method does involve approximations, our simulation studies show that these do not destroy the statistical signal for cluster detection. The use of a likelihood function also gives an estimate of the statistical significance of each detected cluster and allows us to easily score and compare different cluster partitions. Moreover, as the parameters of the model are biologically meaningful, they are therefore easier to potentially fix or interpret in an objective way.</p><p>The intuitive reason for these two key differences of MSBD to cutpoint-based methods is that the MSBD method looks at relative changes in branch lengths, while cutpoint-based methods cluster individuals up to a particular distance in absolute branch lengths. Thus, the cutpoint-based methods only find monophyletic clusters. Furthermore, branch lengths on a different scale (e.g. all distances are multiplied by 100) require a different cutpoint. On the other hand, the MSBD method uses likelihood statistics to determine if the relative branch length changes are significant, indicating a new cluster.</p><p>Avoidance of a cutpoint parameter is an important advantage. Villandre <italic>et al.</italic>&#x000a0;[<xref rid="RSIF20180512C15" ref-type="bibr">15</xref>] showed that the quality of the detection achieved by phylogenetic cutpoint-based clustering methods is highly sensitive to the value of this parameter, regardless of underlying contact network type. In particular, they showed that it is impossible to define a single cutpoint value as adequate for all network types, even for the same pathogen. Cluster Picker recommends cutpoints between 0.015 and 0.045 for HIV based on previous empirical studies of HIV. However, our results show that very different cluster partitions can be obtained at the two ends of this range. Cutpoint values will further be impacted by the evolutionary rate and other epidemiological dynamics, meaning these guidelines cannot be easily transferred to another pathogen. The chosen cutpoint value is strongly linked with the number of clusters inferred by cutpoint-based methods, thus obtaining the correct clusters requires prior knowledge of the true number of clusters.</p><p>Overall, while our method may not perform as well on certain types of network as phylogenetic cutpoint-based methods were we to know the optimal cutpoint in advance, it outperforms the cutpoint-based methods on a wide range of cutpoints on simulated datasets following our assumptions on pathogen spread. Furthermore, while there exist other non-phylogenetic clustering methods, such as HIV-TRACE [<xref rid="RSIF20180512C32" ref-type="bibr">32</xref>], which can detect non-monophyletic clusters, these methods still require specification of a cutpoint parameter and we expect that they suffer from the same issues as the phylogenetic cutpoint-based methods.</p><p>MSBD methods have a strong limitation on the size of clusters that can be inferred from a tree. This is seen from the low scores obtained on the fragmented type C networks and the improvements obtained when only investigating if clusters of a certain size are inferred. Contrary to the cutpoint-based methods, which can handle arbitrary numbers and sizes of clusters, our method can only add clusters when there is a strong signal for them and thus performs worse than cutpoint-based methods in datasets with many small clusters. Again, this comparison relies on knowing the optimal cutpoint, and as said above, this knowledge is typically not available.</p><p>Another limitation of the current implementation is its computational cost, which limits the size of the trees that can be analysed. (Current run time is on the order of CPU-days for a few hundred tips.) In contrast to cutpoint-based methods, the MSBD method thus cannot handle datasets containing tens of thousands of sequences. Future work will focus on implementing the algorithm in parallel and exploring other possible approximations, with the aim of increasing speed without lowering precision. Making use of the insight that the MSBD method employs the information on changes in relative branch lengths may be a future guide to fast but accurate methods.</p><p>In the future, we plan to implement our model in a Bayesian framework, which will allow us to explore the number and positions of clusters in a more rigorous way by using reversible jumps instead of multiple rounds of optimization. Some approximations could be removed in this framework, such as the assumption that <italic>n</italic> = <italic>n</italic>* or the fixed positions of state changes on edges. Moreover, estimating the uncertainty around the various estimated parameters is problematic in an ML framework, in particular for the positions and number of state changes.</p><p>This is compounded by the fact that the current method uses a timed phylogeny as input, and thus relies strongly on this phylogeny being inferred correctly. This also means that the uncertainty associated with the phylogenetic inference cannot be integrated in the cluster inference. Again, a Bayesian framework could solve this issue by allowing a joint inference of the phylogeny and the clusters, using the MSBD as a model-based prior on the transmission tree.</p><p>In summary, in spite of the limitations discussed, our results clearly show that an approach based on a statistical model for cluster detection can overcome some important deficiencies of previous approaches. In particular, the assumption of clusters being monophyletic can be dropped, and the sensitivity to non-biological cutpoint parameters can be completely avoided.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><caption><title>Supplementary text</title></caption><media mimetype="application" mime-subtype="pdf" xlink:href="rsif20180512supp1.pdf" orientation="portrait" id="d35e1884" position="anchor"/></supplementary-material></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD2"><caption><title>Code files</title></caption><media mimetype="application" mime-subtype="tar" xlink:href="rsif20180512si002.tar" orientation="portrait" id="d35e1892" position="anchor"/></supplementary-material></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD3"><caption><title>Data files</title></caption><media mimetype="application" mime-subtype="tar" xlink:href="rsif20180512si003.tar" orientation="portrait" id="d35e1900" position="anchor"/></supplementary-material></sec></body><back><ack><title>Acknowledgements</title><p>We thank Dr Luc Villandr&#x000e9; for his help with using the network simulation dataset.</p></ack><sec id="s5"><title>Data accessibility</title><p>All analyses, pre- and post-processing of the datasets were done using custom R scripts. These scripts and the datasets are included in the electronic supplementary material.</p></sec><sec id="s6"><title>Authors' contributions</title><p>J.B.S. implemented the model, performed the simulations, analysed the data and wrote the manuscript. T.V. analysed the data and wrote the manuscript. T.S. conceived of the study, designed the study, coordinated the study and wrote the manuscript.</p></sec><sec id="s7" sec-type="COI-statement"><title>Competing interests</title><p>We declare we have no competing interests.</p></sec><sec id="s8"><title>Funding</title><p>J.B.S. and T.S. are supported, in part, by the European Research Council under the Seventh Framework Programme of the European Commission (PhyPD: grant agreement no. 335529).</p></sec><ref-list><title>References</title><ref id="RSIF20180512C1"><label>1</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Allen</surname><given-names>LJS</given-names></name></person-group>
<year>2008</year> In <source>An introduction to stochastic epidemic models</source>. In <comment><italic>Mathematical epidemiology</italic>. Lecture Notes in Mathematics, vol. 1945</comment> (eds <person-group person-group-type="editor"><name name-style="western"><surname>Brauer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>van den Driessche</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>J</given-names></name></person-group>), pp.&#x000a0;<fpage>81</fpage>&#x02013;<lpage>130</lpage>. <publisher-loc>Berlin, Germany</publisher-loc>: <publisher-name>Springer</publisher-name>.</mixed-citation></ref><ref id="RSIF20180512C2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brenner</surname><given-names>BG</given-names></name></person-group>
<italic>et al.</italic>
<year>2007</year>
<article-title>High rates of forward transmission events after acute/early HIV-1 infection</article-title>. <source>J. Infect. Dis.</source>
<volume>195</volume>, <fpage>951</fpage>&#x02013;<lpage>959</lpage>. (<pub-id pub-id-type="doi">10.1086/512088</pub-id>)<pub-id pub-id-type="pmid">17330784</pub-id></mixed-citation></ref><ref id="RSIF20180512C3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brenne</surname><given-names>BG</given-names></name></person-group>
<italic>et al.</italic>
<year>2011</year>
<article-title>Transmission clustering drives the onward spread of the HIV epidemic among men who have sex with men in Quebec</article-title>. <source>J. Infect. Dis.</source>
<volume>204</volume>, <fpage>1115</fpage>&#x02013;<lpage>1119</lpage>. (<pub-id pub-id-type="doi">10.1093/infdis/jir468</pub-id>)<pub-id pub-id-type="pmid">21881127</pub-id></mixed-citation></ref><ref id="RSIF20180512C4"><label>4</label><mixed-citation publication-type="book"><collab>World Health Organization</collab>. <year>2012</year>
<source>Antiretroviral treatment as prevention (TASP) of HIV and TB</source>. <publisher-name>World Health Organization</publisher-name>.</mixed-citation></ref><ref id="RSIF20180512C5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Girvan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>MEJ</given-names></name></person-group>
<year>2002</year>
<article-title>Community structure in social and biological networks</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>99</volume>, <fpage>7821</fpage>&#x02013;<lpage>7826</lpage>. (<pub-id pub-id-type="doi">10.1073/pnas.122653799</pub-id>)<pub-id pub-id-type="pmid">12060727</pub-id></mixed-citation></ref><ref id="RSIF20180512C6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leventhal</surname><given-names>GE</given-names></name>, <name name-style="western"><surname>G&#x000fc;nthard</surname><given-names>HF</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name></person-group>
<year>2014</year>
<article-title>Using an epidemiological model for phylogenetic inference reveals density dependence in HIV transmission</article-title>. <source>Mol. Biol. Evol.</source>
<volume>31</volume>, <fpage>6</fpage>&#x02013;<lpage>17</lpage>. (<pub-id pub-id-type="doi">10.1093/molbev/mst172</pub-id>)<pub-id pub-id-type="pmid">24085839</pub-id></mixed-citation></ref><ref id="RSIF20180512C7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Welch</surname><given-names>D</given-names></name></person-group>
<year>2011</year>
<article-title>Is network clustering detectable in transmission trees?</article-title>
<source>Viruses</source>
<volume>3</volume>, <fpage>659</fpage>&#x02013;<lpage>676</lpage>. (<pub-id pub-id-type="doi">10.3390/v3060659</pub-id>)<pub-id pub-id-type="pmid">21731813</pub-id></mixed-citation></ref><ref id="RSIF20180512C8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Fyson</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Cohen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Colijn</surname><given-names>C</given-names></name></person-group>
<year>2013</year>
<article-title>How the dynamics and structure of sexual contact networks shape pathogen phylogenies</article-title>. <source>PLoS Comput. Biol.</source>
<volume>9</volume>, <fpage>1</fpage>&#x02013;<lpage>15</lpage>. (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1003105</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leventhal</surname><given-names>GE</given-names></name></person-group>
<italic>et al.</italic>
<year>2012</year>
<article-title>Inferring epidemic contact structure from phylogenetic trees</article-title>. <source>PLoS Comput. Biol.</source>
<volume>8</volume>, <fpage>1</fpage>&#x02013;<lpage>10</lpage>. (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002413</pub-id>)<pub-id pub-id-type="pmid">22629235</pub-id></mixed-citation></ref><ref id="RSIF20180512C10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bohme</surname><given-names>CN</given-names></name></person-group>
<year>2017</year>
<article-title>Effects of contact network structure on epidemic transmission trees: implications for data required to estimate network structure</article-title>. <source>Stat. Med.</source>
<volume>37</volume>, <fpage>236</fpage>&#x02013;<lpage>248</lpage>. (<pub-id pub-id-type="doi">10.1002/sim.7259</pub-id>)<pub-id pub-id-type="pmid">28192859</pub-id></mixed-citation></ref><ref id="RSIF20180512C11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Giardina</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Romero-Severson</surname><given-names>EO</given-names></name>, <name name-style="western"><surname>Albert</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Britton</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Leitner</surname><given-names>T</given-names></name></person-group>
<year>2017</year>
<article-title>Inference of transmission network structure from HIV phylogenetic trees</article-title>. <source>PLoS Comput. Biol.</source>
<volume>13</volume>, <fpage>1</fpage>&#x02013;<lpage>22</lpage>. (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1005316</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>H</given-names></name></person-group>
<italic>et al.</italic>
<year>2018</year>
<article-title>Tracking HIV-1 recombination to resolve its contribution to HIV-1 evolution in natural infection</article-title>. <source>Nat. Commun.</source>
<volume>9</volume>, <fpage>1928</fpage> (<pub-id pub-id-type="doi">10.1038/s41467-018-04217-5</pub-id>)<pub-id pub-id-type="pmid">29765018</pub-id></mixed-citation></ref><ref id="RSIF20180512C13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McCloskey</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Liang</surname><given-names>RH</given-names></name>, <name name-style="western"><surname>Poon</surname><given-names>AFY</given-names></name></person-group>
<year>2016</year>
<article-title>Reconstructing contact network parameters from viral phylogenies</article-title>. <source>Virus Evol.</source>
<volume>2</volume>, <fpage>vew029</fpage> (<pub-id pub-id-type="doi">10.1093/ve/vew029</pub-id>)<pub-id pub-id-type="pmid">27818787</pub-id></mixed-citation></ref><ref id="RSIF20180512C14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rasmussen</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Kouyos</surname><given-names>R</given-names></name>, <name name-style="western"><surname>G&#x000fc;nthard</surname><given-names>HF</given-names></name>, <name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name></person-group>
<year>2017</year>
<article-title>Phylodynamics on local sexual contact networks</article-title>. <source>PLoS Comput. Biol.</source>
<volume>13</volume>, <fpage>1</fpage>&#x02013;<lpage>23</lpage>. (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1005448</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Villandre</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Labbe</surname><given-names>A</given-names></name>, <name name-style="western"><surname>G&#x000fc;nthard</surname><given-names>HF</given-names></name>, <name name-style="western"><surname>Kouyos</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name></person-group>, <collab>Swiss HIV Cohort Study</collab>. <year>2016</year>
<article-title>Assessment of overlap of phylogenetic transmission clusters and communities in simple sexual contact networks: applications to HIV-1</article-title>. <source>PLoS ONE</source>
<volume>11</volume>, <fpage>e0148459</fpage> (<pub-id pub-id-type="doi">10.1371/journal.pone.0148459</pub-id>)<pub-id pub-id-type="pmid">26863322</pub-id></mixed-citation></ref><ref id="RSIF20180512C16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maddison</surname><given-names>WP</given-names></name>, <name name-style="western"><surname>Midford</surname><given-names>PE</given-names></name>, <name name-style="western"><surname>Otto</surname><given-names>SP</given-names></name></person-group>
<year>2007</year>
<article-title>Estimating a binary character's effect on speciation and extinction</article-title>. <source>Syst. Biol.</source>
<volume>56</volume>, <fpage>701</fpage>&#x02013;<lpage>710</lpage>. (<pub-id pub-id-type="doi">10.1080/10635150701607033</pub-id>)<pub-id pub-id-type="pmid">17849325</pub-id></mixed-citation></ref><ref id="RSIF20180512C17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>FitzJohn</surname><given-names>RG</given-names></name></person-group>
<year>2012</year>
<article-title>Diversitree: comparative phylogenetic analyses of diversification in R</article-title>. <source>Methods Ecol. Evol.</source>
<volume>3</volume>, <fpage>1084</fpage>&#x02013;<lpage>1092</lpage>. (<pub-id pub-id-type="doi">10.1111/j.2041-210X.2012.00234.x</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name></person-group>
<year>2013</year>
<article-title>Uncovering epidemiological dynamics in heterogeneous host populations using phylogenetic methods</article-title>. <source>Phil. Trans. R. Soc. B</source>
<volume>368</volume>, <elocation-id content-type="artnum">20120198</elocation-id> (<pub-id pub-id-type="doi">10.1098/rstb.2012.0198</pub-id>)<pub-id pub-id-type="pmid">23382421</pub-id></mixed-citation></ref><ref id="RSIF20180512C19"><label>19</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>K&#x000fc;hnert</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Vaughan</surname><given-names>TG</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name></person-group>
<year>2016</year>
<article-title>Phylodynamics with migration: a computational framework to quantify population structure from genomic data</article-title>. <source>Mol. Biol. Evol.</source>
<volume>33</volume>, <fpage>2102</fpage>&#x02013;<lpage>2116</lpage>. (<pub-id pub-id-type="doi">10.1093/molbev/msw064</pub-id>)<pub-id pub-id-type="pmid">27189573</pub-id></mixed-citation></ref><ref id="RSIF20180512C20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rabosky</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Santini</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Eastman</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Sidlauskas</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Alfaro</surname><given-names>ME</given-names></name></person-group>
<year>2013</year>
<article-title>Rates of speciation and morphological evolution are correlated across the largest vertebrate radiation</article-title>. <source>Nat. Commun.</source>
<volume>4</volume>, <fpage>1958</fpage> (<pub-id pub-id-type="doi">10.1038/ncomms2958</pub-id>)<pub-id pub-id-type="pmid">23739623</pub-id></mixed-citation></ref><ref id="RSIF20180512C21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Moore</surname><given-names>BR</given-names></name>, <name name-style="western"><surname>H&#x000f6;hna</surname><given-names>S</given-names></name>, <name name-style="western"><surname>May</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Rannala</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group>
<year>2016</year>
<article-title>Critically evaluating the theory and performance of Bayesian analysis of macroevolutionary mixtures</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>113</volume>, <fpage>9569</fpage>&#x02013;<lpage>9574</lpage>. (<pub-id pub-id-type="doi">10.1073/pnas.1518659113</pub-id>)<pub-id pub-id-type="pmid">27512038</pub-id></mixed-citation></ref><ref id="RSIF20180512C22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McCloskey</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Poon</surname><given-names>AF</given-names></name></person-group>
<year>2017</year>
<article-title>A model-based clustering method to detect infectious disease transmission outbreaks from sequence variation</article-title>. <source>PLoS Comput. Biol.</source>
<volume>13</volume>, <fpage>e1005868</fpage> (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1005868</pub-id>)<pub-id pub-id-type="pmid">29131825</pub-id></mixed-citation></ref><ref id="RSIF20180512C23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name>, <name name-style="western"><surname>K&#x000fc;hnert</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name></person-group>
<year>2013</year>
<article-title>Birth&#x02013;death skyline plot reveals temporal changes of epidemic spread in HIV and hepatitis C virus (HCV)</article-title>. <source>Proc. Natl Acad. Sci. USA</source>
<volume>110</volume>, <fpage>228</fpage>&#x02013;<lpage>233</lpage>. (<pub-id pub-id-type="doi">10.1073/pnas.1207965110</pub-id>)<pub-id pub-id-type="pmid">23248286</pub-id></mixed-citation></ref><ref id="RSIF20180512C24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Paradis</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Claude</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname><given-names>K</given-names></name></person-group>
<year>2004</year>
<article-title>APE: analyses of phylogenetics and evolution in R language</article-title>. <source>Bioinformatics</source>
<volume>20</volume>, <fpage>289</fpage>&#x02013;<lpage>290</lpage>. (<pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id>)<pub-id pub-id-type="pmid">14734327</pub-id></mixed-citation></ref><ref id="RSIF20180512C25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rand</surname><given-names>WM</given-names></name></person-group>
<year>1971</year>
<article-title>Objective criteria for the evaluation of clustering methods</article-title>. <source>J. Am. Stat. Assoc.</source>
<volume>66</volume>, <fpage>846</fpage>&#x02013;<lpage>850</lpage>. (<pub-id pub-id-type="doi">10.1080/01621459.1971.10482356</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hubert</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Arabie</surname><given-names>P</given-names></name></person-group>
<year>1985</year>
<article-title>Comparing partitions</article-title>. <source>J. Classif.</source>
<volume>2</volume>, <fpage>193</fpage>&#x02013;<lpage>218</lpage>. (<pub-id pub-id-type="doi">10.1007/bf01908075</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name></person-group>
<year>1977</year>
<article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>J. Phys. Chem.</source>
<volume>81</volume>, <fpage>2340</fpage>&#x02013;<lpage>2361</lpage>. (<pub-id pub-id-type="doi">10.1021/j100540a008</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name></person-group>
<year>2012</year>
<article-title>How can we improve accuracy of macroevolutionary rate estimates?</article-title>
<source>Syst. Biol.</source>
<volume>62</volume>, <fpage>321</fpage>&#x02013;<lpage>329</lpage>. (<pub-id pub-id-type="doi">10.1093/sysbio/sys073</pub-id>)<pub-id pub-id-type="pmid">22962038</pub-id></mixed-citation></ref><ref id="RSIF20180512C29"><label>29</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ragonnet-Cronin</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hodcroft</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hu&#x000e9;</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Fearnhill</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Delpech</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Lycett</surname><given-names>S</given-names></name></person-group>
<year>2013</year>
<article-title>Automated analysis of phylogenetic clusters</article-title>. <source>BMC Bioinform.</source>
<volume>14</volume>, <fpage>317</fpage> (<pub-id pub-id-type="doi">10.1186/1471-2105-14-317</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C30"><label>30</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Prosperi</surname><given-names>MCF</given-names></name></person-group>
<italic>et al.</italic><year>2011</year>
<article-title>A novel methodology for large-scale phylogeny partition</article-title>. <source>Nat. Commun.</source>
<volume>2</volume>, <fpage>321</fpage> (<pub-id pub-id-type="doi">10.1038/ncomms1325</pub-id>)<pub-id pub-id-type="pmid">21610724</pub-id></mixed-citation></ref><ref id="RSIF20180512C31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Grass</surname><given-names>NC</given-names></name></person-group>
<year>1997</year>
<article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>. <source>Bioinformatics</source>
<volume>13</volume>, <fpage>235</fpage> (<pub-id pub-id-type="doi">10.1093/bioinformatics/13.3.235</pub-id>)</mixed-citation></ref><ref id="RSIF20180512C32"><label>32</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Weaver</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Leigh Brown</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Wertheim</surname><given-names>JO</given-names></name></person-group>
<year>2018</year>
<article-title>HIV-TRACE (TRAnsmission Cluster Engine): a tool for large scale molecular epidemiology of HIV-1 and other rapidly evolving pathogens</article-title>. <source>Mol. Biol. Evol.</source>
<volume>35</volume>, <fpage>1812</fpage>&#x02013;<lpage>1819</lpage>. (<pub-id pub-id-type="doi">10.1093/molbev/msy016</pub-id>)<pub-id pub-id-type="pmid">29401317</pub-id></mixed-citation></ref></ref-list></back></article>