<?xml version="1.0" encoding="UTF-8"?>
<p>Note that matching subset trees were weighted in proportion to their size (number of nodes). Because a tree will match its own shape exactly, 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e053.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> can take overwhelmingly large values. This ‘large diagonal’ effect 
 <xref rid="pone.0078122-Weston1" ref-type="bibr">[27]</xref> can severely curtail the effectiveness of subsequent analyses of the kernel matrix (
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e054.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula>), which is a symmetric matrix that is obtained by applying the kernel function to all pairs of 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e055.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> trees, 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e056.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula>. Therefore, the constant decay factor 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e057.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> served to penalize larger subset trees because it declined exponentially with tree size 
 <xref rid="pone.0078122-Collins1" ref-type="bibr">[15]</xref>. The Gaussian radial basis function 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e058.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> further penalized subset trees by the discordance in branch lengths for pairs of branches originating from the matching nodes (
 <xref ref-type="fig" rid="pone-0078122-g002">Figure 2</xref>). Although this incorporation of branch lengths is a significant departure from the original tree kernel for natural language processing, we prove that 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e059.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> is a valid positive semi-definite kernel function (
 <xref ref-type="supplementary-material" rid="pone.0078122.s007">Text S1</xref>).
</p>
