<?xml version="1.0" encoding="UTF-8"?>
<p>Phylogenies were imported from the Newick tree strings produced by RAxML into Python using the Phylo module from the Biopython package 
 <xref rid="pone.0078122-Cock1" ref-type="bibr">[28]</xref>, 
 <xref rid="pone.0078122-Talevich1" ref-type="bibr">[29]</xref>. Branch lengths in each phylogeny were normalized by the mean branch length to facilitate comparisons between viruses with different overall rates of evolution. A kernel matrix was computed from this collection of phylogenies using a custom Python module, which we have made publicly available on our webserver (
 <ext-link ext-link-type="uri" xlink:href="http://bioinfo.cfenet.ubc.ca/pub/phylokernel" xmlns:xlink="http://www.w3.org/1999/xlink">http://bioinfo.cfenet.ubc.ca/pub/phylokernel</ext-link>). Although the kernel function can be computed quickly 
 <xref rid="pone.0078122-Moschitti1" ref-type="bibr">[16]</xref>, we needed to compute the kernel matrix for 4153 phylogenies (
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e060.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> replicates + 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e061.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> samples by collection year + 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e062.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula>) with over 8 million pairwise comparisons. To speed up this calculation, we performed parallel computation on a Linux cluster with a message-passing interface (MPI) environment 
 <xref rid="pone.0078122-Dalcn1" ref-type="bibr">[30]</xref>. The matrix was confirmed to be positive semi-definite by Cholesky decomposition. Following Collins and Duffy 
 <xref rid="pone.0078122-Collins1" ref-type="bibr">[15]</xref>, all entries in the matrix were normalized by the formula
 <disp-formula id="pone.0078122.e063">
  <graphic xlink:href="pone.0078122.e063.jpg" position="anchor" orientation="portrait" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </disp-formula>so that the resulting kernel matrix was less sensitive to differences in the sizes of the respective trees. Values of 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e064.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> for replicate sets of phylogenies generated from random samples were averaged for every pairwise comparison of viruses or virus clades, and the resulting group mean distance matrix was renormalized. Kernel principal components analysis and support vector machine classification were performed on this normalized kernel matrix using the 
 <italic>R</italic> package 
 <italic>kernlab</italic>
 <xref rid="pone.0078122-Karatzoglou1" ref-type="bibr">[31]</xref>.
</p>
