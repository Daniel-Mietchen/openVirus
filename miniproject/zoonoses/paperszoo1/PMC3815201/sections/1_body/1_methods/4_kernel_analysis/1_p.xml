<?xml version="1.0" encoding="UTF-8"?>
<p>To apply the kernel function to these data, we needed to iterate through all internal nodes in two phylogenies and count all subset trees with the same topology (branching order) in both phylogenies (
 <xref ref-type="fig" rid="pone-0078122-g002">Figure 2</xref>). This is akin to quantifying the similarity of two manuscripts by counting the number of times that various words appeared in both texts, as illustrated by our example in the Introduction. Unlike a text, however, the shape of a tree is an ambiguous characteristic of a phylogeny. Rotating the branches around a node can produce a tree that has a different shape, despite remaining evolutionarily equivalent to the original. The number of different shapes for a tree of 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e025.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> tips (where we distinguish left from right and, for the moment, ignore branch lengths) is given by the Catalan numbers 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e026.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula>. For example, a tree of 100 tips has nearly 
 <inline-formula>
  <inline-graphic xlink:href="pone.0078122.e027.jpg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> shapes. This presents a problem: how do we know which resolutions of shapes are being compared between two trees? We resolved this issue by ‘ladderizing’ the trees: rotating branches around every node so that branches leading to the larger number of descendants (tips) were always on the same side. This procedure, conventionally used to produce a more aesthetically pleasing visualization of a phylogeny, greatly increases the chance of finding matching subset trees between two phylogenies. Furthermore, we rotated branches around all ‘cherries’ (nodes that are the direct ancestor of two tips) such that the longer branch was always on the same side. Based on simulations (see below), we determined that this combination of ladderization and rotating cherries significantly improved our ability to correctly classify simulated trees (
 <xref ref-type="supplementary-material" rid="pone.0078122.s006">Table S2</xref>), indicating that these steps resolved different trees into shapes which could be compared in a consistent and meaningful way.
</p>
