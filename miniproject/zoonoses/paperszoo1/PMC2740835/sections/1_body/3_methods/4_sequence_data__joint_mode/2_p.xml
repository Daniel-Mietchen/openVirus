<?xml version="1.0" encoding="UTF-8"?>
<p>We approximate the joint posterior (8) and its marginalizations using MCMC implemented in the software package BEAST 
 <xref rid="pcbi.1000520-Drummond4" ref-type="bibr">[43]</xref>. We employ standard transition kernels over the parameter spaces of 
 <inline-formula>
  <inline-graphic xlink:href="pcbi.1000520.e161.jpg" mimetype="image" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula> and 
 <inline-formula>
  <inline-graphic xlink:href="pcbi.1000520.e162.jpg" mimetype="image" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula>. To sample realizations of 
 <inline-formula>
  <inline-graphic xlink:href="pcbi.1000520.e163.jpg" mimetype="image" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula>, we consider random-walk operators on the continuous portions and a specialized “bit-flip” operator on the Bernoulli rate indicators 
 <inline-formula>
  <inline-graphic xlink:href="pcbi.1000520.e164.jpg" mimetype="image" xmlns:xlink="http://www.w3.org/1999/xlink"/>
 </inline-formula>. 
 <xref rid="pcbi.1000520-Drummond5" ref-type="bibr">[53]</xref> discuss this transition kernel further. Finally, in many situations, inference on the posterior distribution of the root and internal node states is of paramount interest. We implement a pre-order, tree-traversal algorithm in BEAST that allows researchers to generate realizations of the root and internal node states following 
 <xref rid="pcbi.1000520-Pagel2" ref-type="bibr">[20]</xref> and produce posterior summaries. Importantly, this procedure is not limited to phylogeographic models, making general ancestral state reconstruction available in BEAST for the first time.
</p>
