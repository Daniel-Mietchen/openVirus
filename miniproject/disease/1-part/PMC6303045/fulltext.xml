<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">PONE-D-18-16679</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0207777</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune Physiology</subject><subj-group><subject>Antigens</subject><subj-group><subject>Antigenic Variation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune Physiology</subject><subj-group><subject>Antigens</subject><subj-group><subject>Antigenic Variation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune System Proteins</subject><subj-group><subject>Antigens</subject><subj-group><subject>Antigenic Variation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune System Proteins</subject><subj-group><subject>Antigens</subject><subj-group><subject>Antigenic Variation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Immune System Proteins</subject><subj-group><subject>Antigens</subject><subj-group><subject>Antigenic Variation</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>RNA viruses</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject><subj-group><subject>H1N1</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject><subj-group><subject>H1N1</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject><subj-group><subject>H1N1</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject><subj-group><subject>H1N1</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Infectious Diseases</subject><subj-group><subject>Viral Diseases</subject><subj-group><subject>Influenza</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Zoology</subject><subj-group><subject>Animal Diseases</subject><subj-group><subject>Animal Influenza</subject><subj-group><subject>Swine Influenza</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Infectious Diseases</subject><subj-group><subject>Zoonoses</subject><subj-group><subject>Swine Influenza</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>RNA viruses</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza viruses</subject><subj-group><subject>Influenza A virus</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>RNA viruses</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza Viruses</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical Microbiology</subject><subj-group><subject>Microbial Pathogens</subject><subj-group><subject>Viral Pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza Viruses</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Pathology and Laboratory Medicine</subject><subj-group><subject>Pathogens</subject><subj-group><subject>Microbial Pathogens</subject><subj-group><subject>Viral Pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza Viruses</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>Viral Pathogens</subject><subj-group><subject>Orthomyxoviruses</subject><subj-group><subject>Influenza Viruses</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune Physiology</subject><subj-group><subject>Antigens</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune Physiology</subject><subj-group><subject>Antigens</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune System Proteins</subject><subj-group><subject>Antigens</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune System Proteins</subject><subj-group><subject>Antigens</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Immune System Proteins</subject><subj-group><subject>Antigens</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Information Theory</subject><subj-group><subject>Information Entropy</subject></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Predicting antigenic variants of H1N1 influenza virus based on epidemics and pandemics using a stacking model</article-title><alt-title alt-title-type="running-head">Predicting antigenic variants of H1N1 using stacking model</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yin</surname><given-names>Rui</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Data curation</role><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Investigation</role><role content-type="http://credit.casrai.org/">Methodology</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Visualization</role><role content-type="http://credit.casrai.org/">Writing &#x02013; original draft</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Tran</surname><given-names>Viet Hung</given-names></name><role content-type="http://credit.casrai.org/">Formal analysis</role><role content-type="http://credit.casrai.org/">Investigation</role><role content-type="http://credit.casrai.org/">Visualization</role><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Zhou</surname><given-names>Xinrui</given-names></name><role content-type="http://credit.casrai.org/">Investigation</role><role content-type="http://credit.casrai.org/">Validation</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Zheng</surname><given-names>Jie</given-names></name><role content-type="http://credit.casrai.org/">Project administration</role><role content-type="http://credit.casrai.org/">Resources</role><role content-type="http://credit.casrai.org/">Supervision</role><role content-type="http://credit.casrai.org/">Writing &#x02013; review &#x00026; editing</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="aff" rid="aff003"><sup>3</sup></xref></contrib><contrib contrib-type="author"><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8547-6387</contrib-id><name><surname>Kwoh</surname><given-names>Chee Keong</given-names></name><role content-type="http://credit.casrai.org/">Conceptualization</role><role content-type="http://credit.casrai.org/">Funding acquisition</role><role content-type="http://credit.casrai.org/">Project administration</role><role content-type="http://credit.casrai.org/">Resources</role><role content-type="http://credit.casrai.org/">Software</role><role content-type="http://credit.casrai.org/">Supervision</role><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="corresp" rid="cor001">*</xref></contrib></contrib-group><aff id="aff001">
<label>1</label>
<addr-line>School of Computer Science and Engineering, Nanyang Technological University, Singapore, Singapore</addr-line>
</aff><aff id="aff002">
<label>2</label>
<addr-line>School of Information and Communication Technology, Hanoi University of Science and Technology, Hanoi, Vietnam</addr-line>
</aff><aff id="aff003">
<label>3</label>
<addr-line>Genome Institute of Singapore, A*STAR, Biopolis, Singapore, Singapore</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Russell</surname><given-names>Charles J.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">
<addr-line>St. Jude Children&#x02019;s Research Hospital, UNITED STATES</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><corresp id="cor001">* E-mail: <email>ASCKKWOH@ntu.edu.sg</email></corresp></author-notes><pub-date pub-type="collection"><year>2018</year></pub-date><pub-date pub-type="epub"><day>21</day><month>12</month><year>2018</year></pub-date><volume>13</volume><issue>12</issue><elocation-id>e0207777</elocation-id><history><date date-type="received"><day>4</day><month>6</month><year>2018</year></date><date date-type="accepted"><day>6</day><month>11</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; 2018 Yin et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Yin et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0207777.pdf"/><abstract><p>H1N1 is the earliest emerging subtype of influenza A viruses with available genomic sequences, has caused several pandemics and seasonal epidemics, resulting in millions of deaths and enormous economic losses. Timely determination of new antigenic variants is crucial for the vaccine selection and flu prevention. In this study, we chronologically divided the H1N1 strains into several periods in terms of the epidemics and pandemics. Computational models have been constructed to predict antigenic variants based on epidemic and pandemic periods. By sequence analysis, we demonstrated the diverse mutation patterns of HA1 protein on different periods and that an individual model built upon each period can not represent the variations of H1N1 virus. A stacking model was established for the prediction of antigenic variants, combining all the variation patterns across periods, which would help assess a new influenza strain&#x02019;s antigenicity. Three different feature extraction methods, i.e. residue-based, regional band-based and epitope region-based, were applied on the stacking model to verify its feasibility and robustness. The results showed the capability of determining antigenic variants prediction with accuracy as high as 0.908 which performed better than any of the single models. The prediction performance using the stacking model indicates clear distinctions of mutation patterns and antigenicity between epidemic and pandemic strains. It would also facilitate rapid determination of antigenic variants and influenza surveillance.</p></abstract><funding-group><award-group id="award001"><funding-source><institution>This study is supported by Ministry of Education, Singapore.</institution></funding-source><award-id>AcRF Tier 2 grant MOE2014-T2-2-023</award-id><principal-award-recipient><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8547-6387</contrib-id><name><surname>Kwoh</surname><given-names>Chee Keong</given-names></name></principal-award-recipient></award-group><funding-statement>This study is supported by AcRF Tier 2 grant MOE2014-T2-2-023, Ministry of Education, Singapore. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><fig-count count="5"/><table-count count="4"/><page-count count="16"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>All relevant data are within the paper and its Supporting Information files.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Influenza is an infectious disease that poses significant threat to public health worldwide, especially H1N1 of influenza A virus, which caused several pandemics in history, e.g. the 1918 Spanish flu, leading to millions of deaths [<xref rid="pone.0207777.ref001" ref-type="bibr">1</xref>]. Except for the pandemics, epidemics also cause about 250,00 to 500,000 deaths per year around the world [<xref rid="pone.0207777.ref002" ref-type="bibr">2</xref>]. Hemagglutinin (HA) and neuraminidase (NA) are the most important proteins that characterize influenza A viruses [<xref rid="pone.0207777.ref003" ref-type="bibr">3</xref>]. HA is responsible for binding the virus to host cells with sialic acid on the membranes [<xref rid="pone.0207777.ref004" ref-type="bibr">4</xref>] and NA functions as a tetramer that cleaves sialic acid from cells and virion glycoproteins to prevent clumping of released viruses [<xref rid="pone.0207777.ref005" ref-type="bibr">5</xref>]. However, the accumulation of antigenic shift or drift within HA proteins results in new strains of virus which can not be inhibited effectively by antibodies originally targeted at previous strains and thereby causes new epidemics or pandemics. HA protein cleaves into two chains, namely, HA1 and HA2. HA1 mutates much more frequently than HA2 and is subject to strong selection for novel variations [<xref rid="pone.0207777.ref006" ref-type="bibr">6</xref>]. It is the main objective of this paper to study and predict the antigenic variants to facilitate vaccine recommendation.</p><p>Hemagglutinin inhibition (HI) assay is the primary method to determine the antigenicity of influenza viruses and quantitative antibody titers for vaccine selection [<xref rid="pone.0207777.ref007" ref-type="bibr">7</xref>]. However, HI assay is a labour-intensive and time-consuming method, which prompts the development of computational techniques for the prediction of antigenic similarity between antisera and antigens to identify the antigenic variants. The phylogenetic trees combined with antigenic cartography remains prevailing in antigenic analysis. Smith et al. constructed an antigenic map to determine the antigenic evolution of influenza A H3N2 virus from 1968 to 2003 [<xref rid="pone.0207777.ref008" ref-type="bibr">8</xref>]. Lorusso et al. used antigenic cartography to analyze the antigenic properties of 2008 H1 viruses and demonstrated that the viruses in the different phylogenetic clusters are also antigenically divergent [<xref rid="pone.0207777.ref009" ref-type="bibr">9</xref>]. The antigenic patterns and evolution of human influenza A (H1N1) viruses were investigated by Liu et al., who inferred the antigenic clusters from a large-scale sequence data covering the whole epidemic history of H1N1 [<xref rid="pone.0207777.ref010" ref-type="bibr">10</xref>]. Bedford et al. and Du et al. constructed the maps of the global circulation patterns of seasonal flu strains and antigenic evolution, respectively [<xref rid="pone.0207777.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0207777.ref012" ref-type="bibr">12</xref>]. These previous works depicted the evolutionary paths of influenza and provided the foundation for computational models of antigenicity prediction. Sequence-based methods and imputation-based methods [<xref rid="pone.0207777.ref013" ref-type="bibr">13</xref>] are the most common methods for antigenic prediction. For example, Ren et al. applied random forest regression and support vector regression to identify antigenicity-associated sites in the hemagglutinin protein of A/H1N1 seasonal influenza virus [<xref rid="pone.0207777.ref014" ref-type="bibr">14</xref>]. Yin et al. detected the potential critical virulent sites in past pandemic strains using rule-based methods [<xref rid="pone.0207777.ref015" ref-type="bibr">15</xref>]. Besides, one of the most crucial factors for the success of influenza vaccination is the timely determination of emerging influenza virus antigenic variants. Sun et al. provided a novel, experimentally validated, computational method for determining influenza virus antigenicity based on HA sequences [<xref rid="pone.0207777.ref016" ref-type="bibr">16</xref>]. Yao et al. proposed a joint random forest method for predicting influenza H3N2 antigenicity from hemagglutinin sequence data [<xref rid="pone.0207777.ref017" ref-type="bibr">17</xref>]. Qiu et al. incorporated the structural context of HA protein to calculate the antigenicity for influenza virus A/H3N2 with an accuracy of 0.875 [<xref rid="pone.0207777.ref018" ref-type="bibr">18</xref>]. By building a universal model for all HA subtypes of influenza A viruses based on conserved antigenic structures, Peng et al. achieved an accuracy of 0.77 for predicting antigenic variants of avian influenza H9N2 viruses [<xref rid="pone.0207777.ref019" ref-type="bibr">19</xref>]. Furthermore, Richard Neher et al. showed the antigenic differences measured by serological data are well described by antigenic changes along the path connecting viruses in phylogenetic trees [<xref rid="pone.0207777.ref020" ref-type="bibr">20</xref>]. It allows predicting antigenicity from HA sequences by mapping on the trees. Luksza and Laessig developed a fitness model for haemagglutinin that predicts the evolution of the viral population, which maps the adaptive history of influenza A and suggests guidance for vaccine selection [<xref rid="pone.0207777.ref021" ref-type="bibr">21</xref>].</p><p>Despite the availability of these computational methods in identifying antigenicity-associated sites and predicting antigenic variants for influenza, most of the models were built for influenza A/H3N2. There is still insufficient knowledge on the influenza H1N1 that caused numerous epidemics all over the world. Besides, high-performance model for rapid prediction of H1N1 antigenicity from sequences is needed. In this study, we built a stacking model to include all influenza periods of H1N1 based on epidemics and pandemics for the prediction of antigenic variants. To the best of our knowledge, this is the first attempt to take epidemic and pandemic events into account for inferring the antigenic relation between H1N1 virus strains. We categorized influenza strains into two types, pandemic-based and epidemic-based, denoted as &#x0201c;PDM&#x0201d; and &#x0201c;EPD&#x0201d;. The period of five pandemics in recent centuries was shown in <xref rid="pone.0207777.t001" ref-type="table">Table 1</xref> and the rest of the time is regarded as an epidemic period. In this way, we not only classified the antigenic relation of two influenza strains within a certain period, but also compared antigenic relation of two strains more broadly. By analyzing sequence data and calculating the entropy of each residue position of HA1 protein for strains, we demonstrated that influenza H1N1 went through different variations across the periods. Pearson Correlation Coefficient (PCC) [<xref rid="pone.0207777.ref022" ref-type="bibr">22</xref>] was performed to further identify the distinct mutation patterns of H1N1 strains in each period. Individual prediction models of a pair of strains across periods were constructed for the antigenic variants prediction. Finally, a stacking model was built to predict antigenic variants combining H1N1 epidemic and pandemic strains from all periods. The accuracy of the stacking model exceeded those of above-mentioned for H1N1. Three different feature generation methods applied to the construction of models proved its feasibility and reliability. We believe this model could help to analyze epidemic and pandemic strains. The highlighted mutation patterns and constructed models may also help facilitate rough determination of antigenic variants, the surveillance of influenza and as a reference to the selection of vaccine strains.</p><table-wrap id="pone.0207777.t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.t001</object-id><label>Table 1</label><caption><title>The classification of H1N1 periods and data collection based on chronological pandemics (PDM) and epidemics (EPD).</title></caption><alternatives><graphic id="pone.0207777.t001g" xlink:href="pone.0207777.t001"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1">Event</th><th align="center" rowspan="1" colspan="1">Type</th><th align="center" rowspan="1" colspan="1">Year</th><th align="center" rowspan="1" colspan="1">Number of sequences</th><th align="center" rowspan="1" colspan="1">Period</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">1918Spanish</td><td align="center" rowspan="1" colspan="1">PDM</td><td align="center" rowspan="1" colspan="1">1918-1920</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">1</td></tr><tr><td align="center" rowspan="1" colspan="1">SeasonalFlu1</td><td align="center" rowspan="1" colspan="1">EPD</td><td align="center" rowspan="1" colspan="1">1921-1976</td><td align="center" rowspan="1" colspan="1">107</td><td align="center" rowspan="1" colspan="1">2</td></tr><tr><td align="center" rowspan="1" colspan="1">1977Russia</td><td align="center" rowspan="1" colspan="1">PDM</td><td align="center" rowspan="1" colspan="1">1977-1980</td><td align="center" rowspan="1" colspan="1">28</td><td align="center" rowspan="1" colspan="1">3</td></tr><tr><td align="center" rowspan="1" colspan="1">SeasonalFlu2</td><td align="center" rowspan="1" colspan="1">EPD</td><td align="center" rowspan="1" colspan="1">1981-2008</td><td align="center" rowspan="1" colspan="1">2247</td><td align="center" rowspan="1" colspan="1">4</td></tr><tr><td align="center" rowspan="1" colspan="1">2009Swine</td><td align="center" rowspan="1" colspan="1">PDM</td><td align="center" rowspan="1" colspan="1">2009-2011</td><td align="center" rowspan="1" colspan="1">5099</td><td align="center" rowspan="1" colspan="1">5</td></tr><tr><td align="center" rowspan="1" colspan="1">SeasonalFlu3</td><td align="center" rowspan="1" colspan="1">EPD</td><td align="center" rowspan="1" colspan="1">2012-2016</td><td align="center" rowspan="1" colspan="1">2208</td><td align="center" rowspan="1" colspan="1">6</td></tr></tbody></table></alternatives></table-wrap></sec><sec sec-type="materials|methods" id="sec002"><title>Materials and methods</title><sec id="sec003"><title>Data collection</title><p>We used two types of data in this study, including antigenic data and sequence data. Antigenic data was based on hemagglutination inhibition (HI) assay and collected from diverse sources, such as World Health Organization (WHO), European Centre for Disease Prevention and Control (ECDC), The Francis Crick Institute (FCI), U.S Food and Drug Administration (FDA) and relevant literature. In total, 1772 pairs of HI assay data of HA1 viral strains were obtained for influenza H1N1. As for the sequence dataset of HA1, it was obtained from Influenza Virus Resource (IVR) [<xref rid="pone.0207777.ref023" ref-type="bibr">23</xref>] and Global Initiative on Sharing All Influenza Data (GISAID) [<xref rid="pone.0207777.ref024" ref-type="bibr">24</xref>] on 31 Dec, 2016. The sequence collection was filtered by minimal length 327 (HA1 length) and human host. The dataset comprises 9859 sequences in total after removing duplicate sequences for H1N1. Because hemagglutination inhibition assay was developed in 1940s as the method for quantifying the relative concentration of viruses, bacteria or antibodies [<xref rid="pone.0207777.ref025" ref-type="bibr">25</xref>], no antigenic data is available and there are only scarce sequence data for period 1. Thus we only consider period 2 to 6 in subsequent analysis.</p></sec><sec id="sec004"><title>Data cleaning and preprocessing</title><p>We adopted Archetti-Horsfall distance [<xref rid="pone.0207777.ref026" ref-type="bibr">26</xref>] to define the antigenic relations between strains as follows:
<disp-formula id="pone.0207777.e001"><alternatives><graphic xlink:href="pone.0207777.e001.jpg" id="pone.0207777.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p><p><italic>D</italic><sub><italic>ij</italic></sub> stands for the antigenic distance, <italic>H</italic><sub><italic>ij</italic></sub> is the HI titer of strain <italic>i</italic> related to antisera raised against strain <italic>j</italic>. When the value of <italic>D</italic><sub><italic>ij</italic></sub> is greater than or equal to 4 (a threshold defined by Liao et al. [<xref rid="pone.0207777.ref027" ref-type="bibr">27</xref>]), the antigenic relation between the two strains is considered to be distinct, otherwise it is similar. If the HI titer of the same pair was measured in multiple independent institutions, the median titer value was taken [<xref rid="pone.0207777.ref028" ref-type="bibr">28</xref>]. After removing duplicate pairs, we obtained 937 antigenically distinct pairs and 636 antigenically similar pairs in total.</p><p>MAFFT [<xref rid="pone.0207777.ref029" ref-type="bibr">29</xref>] was applied to the collected sequences for multiple sequence alignment. Because of different lengths of HA proteins of H1N1, the aligned sequences showed many insertions and deletions. Thus we only kept the HA1 residues and deleted others including signal peptide in each strain. Moverover, the sequences with a gap ratio greater than 10% were also removed by manual check. The remaining samples comprised 107 strains, 28 strains, 2247 strains, 5099 strains and 2208 strains for periods 2 to 6 respectively shown in <xref rid="pone.0207777.t001" ref-type="table">Table 1</xref>. The antigenic and sequence data of each period can be found in <xref ref-type="supplementary-material" rid="pone.0207777.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pone.0207777.s002">S2</xref> Files after cleaning and preprocessing.</p></sec><sec id="sec005"><title>Feature engineering</title><p>According to our analysis, HA proteins of H1N1 in different periods were probably subject to distinct mechanisms generating antigenic variations at the site level. To build a computational model for the prediction of antigenic variants, three different feature engineering methods were applied to the construction of model built on epidemics and pandemics to test its feasibility and universality, namely, residue-based, ten regional band-based and five epitope region-based methods. Residue-based method uses all the sites on HA1 protein to generate features. By extracting features on single sites between strains, 327 different features were obtained for every pair of strains, where 0 represents the same animo acid between strains on the site and 1 otherwise. The regional bands, defined based on Lees et al. [<xref rid="pone.0207777.ref030" ref-type="bibr">30</xref>], were acquired by the calculation of distance on the C<italic>&#x003b1;</italic> atoms between residues on the top of HA1. Here we adopted ten regional bands to generate new features based on the sites of each band. The number of amino acid changes in each regional band between a pair of sequences was extracted as features. Similarly, epitope regions of H1 [<xref rid="pone.0207777.ref031" ref-type="bibr">31</xref>] to which that the human immune system primarily responds was another way to generate new features in the five epitope regions.</p></sec><sec id="sec006"><title>Model construction</title><p>As we know that the influenza strains in different periods may lead to various levels of disease such as epidemics or pandemics. We first investigated the distinct mutation patterns of strains from different periods regardless of whether they were caused by antigenic drift or antigenic shift. We took the distinctions as facts, focusing on highlighting the variation patterns across periods. To validate that the strains in different periods went through distinct antigenic variations, the mutation patterns of HA1 proteins were analyzed by calculating the moving average position information entropy of amino acid sites on HA1, which could reflect the variant patterns of influenza virus antigens. Then, Pearson Correlation Coefficient (PCC) analysis was performed on the information entropy of amino acid positions between periods in terms of moving average position information entropy. These analyses suggested that the H1N1 viruses in different periods have most likely experienced diverse mutation variations. Therefore, we first built models on each type to predict its antigenicity, described as a single model, illustrating potential evolutionary patterns from periods 2 to 6 in the following way.</p><p>Set H1N1 strains in periods 2 to 6 be designated by letters A, B, C, D, E. We need select two different strains as a pair. Since the evolution of influenza viruses is in a forward path [<xref rid="pone.0207777.ref032" ref-type="bibr">32</xref>], the strains could evolve within one period to another period chronologically. For example, influenza strains in period 2 could only evolve directly or indirectly into strains in any period from 2 to 6, but not to period 1. Here we didn&#x02019;t consider the situation that the subtype H1N1 developed into other subtypes. In this case, we built the model for the prediction of antigenic variants based on period 2 by the settings that for a pair of strains, one of the strains was from period 2 and the other strain was from any of the potential forward periods, which could represent antigenic relation of a pair of strains from period 2 and another. This situation is stated as Type II (AA, AB, AC, AD, AE). In this way, Other types of pairs of strains were presented as Type III (BB, BC, BD, BE), Type IV (CC, CD, CE), Type V (DD, DE) and Type VI (EE). We finally obtained 99, 180, 843, 369 and 74 samples from Type II to VI for the training and testing of antigenic relationship between pairs of strains. Single models were first applied to the individual types for the prediction of antigenic variants by several classifiers including logistic regression (LR), support vector machine (SVM), na&#x000ef;ve bayes (NB), neural network (NN) and k-nearest neighbour (KNN). Due to the imbalanced distribution of antigenic similar and distinct samples, stratified sampling technique was applied to the training process to construct the validation model. We divided the samples into minor and major classes for each type and randomly selected 80% of each class for training and kept the rest for testing. It would make sure that the samples on each class were selected for training with a ratio of 0.8. This could overcome the overfitting problem that the minor class was overwhelmed by the major class with high accuracy. Three feature generation methods were applied to predict the antigenic relationship between strains for each type. The average accuracy was calculated over 10 runs by these classifiers above.</p><p>Furthermore, our objective is to provide a universal model for the prediction of antigenic variants of influenza H1N1 that can be applied to all types, so a stacking model was introduced [<xref rid="pone.0207777.ref033" ref-type="bibr">33</xref>]. The stacking model uses a similar idea as <italic>k</italic>-fold cross validation to create out-of-sample predictions that works for small or medium sized datasets. It constructs a predictive model by combining different models as illustrated in <xref ref-type="fig" rid="pone.0207777.g001">Fig 1</xref>. In this work, we randomly selected 80% samples containing each type from the original dataset <italic>X</italic><sub><italic>m</italic>&#x000d7;<italic>n</italic></sub>, which contained <italic>m</italic> samples and <italic>n</italic> features. The rest 20% data was used to test on the stacking model. The parameter <italic>n</italic> would change in the training dataset <italic>X</italic><sub><italic>m</italic>&#x000d7;<italic>n</italic></sub> according to different feature vectors. At level 1, different classifiers were applied on <italic>X</italic><sub><italic>m</italic>&#x000d7;<italic>n</italic></sub> and tested on the testing data of each type to select the best algorithms as base classifiers in term of their prediction performance. Correspondingly, logistic regression, na&#x000ef;ve bayes and neural network were selected to construct the models at level 2 in terms of the better performance on single models. In addition, random forest and gradient boosting were added to construct the models at level 2. These models at level 2 can provide predictions for the outcome of all data, which were then casted into the second level of training data presented as <italic>X</italic><sub><italic>m</italic>&#x000d7;<italic>M</italic></sub>. The parameter <italic>M</italic> stands for the number of new features of the dataset. The model at level 3 was constructed by logistic regression classifier, trained and tested on <italic>X</italic><sub><italic>m</italic>&#x000d7;<italic>M</italic></sub> to produce the final outcomes of the predictions of antigenic variants. The performance of the stacking model will be compared with the base classifiers. Meanwhile, to study the influence of data bias of different types on the stacking model, we also investigated the stacking model with the model built on balanced datasets. We set 74, the number of Type VI samples, as benchmark number and randomly selected balanced samples from other types. Totally, 370 samples were extracted as new training and testing dataset to predict antigenic relationship between strains. The performance of stacking model with all datasets and balanced datasets was compared to investigate the influence of imbalanced dataset distribution for prediction. Furthermore, ROC (Receiver Operating Characteristic) curve was plotted by the stacking model constructed above to validate its strengthen and stability.</p><fig id="pone.0207777.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.g001</object-id><label>Fig 1</label><caption><title>The workflow of stacking model for the antigenic variants prediction based on pandemics and epidemics.</title></caption><graphic xlink:href="pone.0207777.g001"/></fig><p>We used the software R version 3.4.0 to conduct all the statistical analyses in this work, including entropy calculation, feature engineering, model construction and validation. The classifiers applied in training and testing models were performed by the package H2O ensemble [<xref rid="pone.0207777.ref034" ref-type="bibr">34</xref>]. The package ROCR was used to plot the ROC curve and calculate the area under ROC curve (AUC) [<xref rid="pone.0207777.ref035" ref-type="bibr">35</xref>].</p></sec></sec><sec sec-type="results" id="sec007"><title>Results</title><p>The HA1 viral protein, as the main antigen of influenza viruses, is the immunodominant part of HA segment [<xref rid="pone.0207777.ref036" ref-type="bibr">36</xref>]. The analysis of mutation patterns of HA1 proteins in different periods was implemented by the calculation of information entropy in each residue position. Because of the conserved sites in aligned sequences of HA1, the value of information entropy would be 0 that caused steep distribution values on different sites when plotted in the figure. Therefore, we used the moving average position information entropy with the window size of 11 to reflect variation patterns of HA1 proteins. The results in <xref ref-type="fig" rid="pone.0207777.g002">Fig 2</xref> presented a diverse patterns of entropy variations of the HA1 residues. For example, the peaks of the curve in period 2 located at site 156 and 190, while the same position in period 3 or 4 was in the valley. Some other similar situations could also be found in the figure such as site 75, 145, 160, 200 and 275. These sites could have undergone diverse mutation patterns in different periods. Although some sites reflected similar mutational tendency in all periods, like site 103 and 210, the overall variation patterns tended to be distinct in different periods. However, the accumulation of these mutation sites in distinct variation patterns could lead to different extent of influenza outbreaks through years.</p><fig id="pone.0207777.g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.g002</object-id><label>Fig 2</label><caption><title>Position-dependent entropy.</title><p>Moving average position information entropy was calculated with a window size of 11 for HA1 protein if influenza A virus in each period, that is period 2 (black), period 3 (yellow), period 4 (red), period 5 (green) and period 6 (blue). The amino acid position are in H1 numbering system [<xref rid="pone.0207777.ref037" ref-type="bibr">37</xref>].</p></caption><graphic xlink:href="pone.0207777.g002"/></fig><p>The correlation analysis between residues&#x02019; information entropy on HA1 proteins in different periods further verified distinct mutation patterns shown in <xref rid="pone.0207777.t002" ref-type="table">Table 2</xref>. The correlations of residues&#x02019; entropy variations of HA1 protein ranged from 0.03 to 0.69 among periods, which was measured by Pearson Correlation Coefficient. These results indicated a medium (0.3-0.8) or low (0-0.3) correlations of mutation patterns between periods. Especially, the correlation coefficients of period 3-4 and 3-5 were quite low, only attaining 0.05 and 0.03 respectively. It may infer the influenza H1N1 strains appeared in 1977 Russia flu yielded drastic and frequent mutations during the years from 1978 to 2008, when there were intermittent epidemics occurred all over the world. However, compared with strains in period 3, the strains in period 4 are less disparate than those in period 5 that the correlation reached 0.67. It also reasonably accounted for the low correlation of strains between period 3 and period 5. In combination, the results above suggested the diversity of mutation patterns of influenza H1N1 in terms of pandemic and epidemic events, and gave a better insight for understanding the mutation patterns for H1N1 strains.</p><table-wrap id="pone.0207777.t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.t002</object-id><label>Table 2</label><caption><title>Pearson correlation coefficient between different periods (P2 to P6) based on pandemics and epidemics.</title></caption><alternatives><graphic id="pone.0207777.t002g" xlink:href="pone.0207777.t002"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><tbody><tr><td align="center" rowspan="1" colspan="1">H1N1</td><td align="center" rowspan="1" colspan="1">P2</td><td align="center" rowspan="1" colspan="1">P3</td><td align="center" rowspan="1" colspan="1">P4</td><td align="center" rowspan="1" colspan="1">P5</td><td align="center" rowspan="1" colspan="1">P6</td></tr><tr><td align="center" rowspan="1" colspan="1">P2</td><td align="center" rowspan="1" colspan="1">1.00</td><td align="center" rowspan="1" colspan="1">0.18</td><td align="center" rowspan="1" colspan="1">0.69</td><td align="center" rowspan="1" colspan="1">0.58</td><td align="center" rowspan="1" colspan="1">0.50</td></tr><tr><td align="center" rowspan="1" colspan="1">P3</td><td align="center" rowspan="1" colspan="1">0.18</td><td align="center" rowspan="1" colspan="1">1.00</td><td align="center" rowspan="1" colspan="1">0.05</td><td align="center" rowspan="1" colspan="1">0.03</td><td align="center" rowspan="1" colspan="1">0.25</td></tr><tr><td align="center" rowspan="1" colspan="1">P4</td><td align="center" rowspan="1" colspan="1">0.69</td><td align="center" rowspan="1" colspan="1">0.05</td><td align="center" rowspan="1" colspan="1">1.00</td><td align="center" rowspan="1" colspan="1">0.67</td><td align="center" rowspan="1" colspan="1">0.36</td></tr><tr><td align="center" rowspan="1" colspan="1">P5</td><td align="center" rowspan="1" colspan="1">0.58</td><td align="center" rowspan="1" colspan="1">0.03</td><td align="center" rowspan="1" colspan="1">0.67</td><td align="center" rowspan="1" colspan="1">1.00</td><td align="center" rowspan="1" colspan="1">0.36</td></tr><tr><td align="center" rowspan="1" colspan="1">P6</td><td align="center" rowspan="1" colspan="1">0.50</td><td align="center" rowspan="1" colspan="1">0.25</td><td align="center" rowspan="1" colspan="1">0.36</td><td align="center" rowspan="1" colspan="1">0.36</td><td align="center" rowspan="1" colspan="1">1.00</td></tr></tbody></table></alternatives></table-wrap><p>Our analysis suggested that HA1 proteins of influenza H1N1 in different periods probably experienced distinct variation patterns. The single models, trained and tested in each type, were constructed by several basic classifiers. These classifiers consisted of logistic regression (LR), support vector machine (SVM), na&#x000ef;ve bayes (NB), neural network (NN) and k-nearest neighbour (KNN). The predicting accuracy of single models on average was shown in <xref rid="pone.0207777.t003" ref-type="table">Table 3</xref> by three feature generation methods. Logistic regression, neural network and na&#x000ef;ve bayes classifiers were selected for the construction of stacking model according to the superior experimental results shown in red. Furthermore, we also explored whether the single model in one type could perform well applied to others. We only presented the results with best classifiers, that is, logistic regression, neural network and na&#x000ef;ve bayes, corresponding to residue-based, regional band-based and epitope region-based features respectively, to test the performance of all types. The model performed quite well when tested within the same type that was highlighted in bold but relatively poor on other types in most cases shown in <xref rid="pone.0207777.t004" ref-type="table">Table 4</xref>. For example, the single model on Type III achieved an accuracy over 0.9 on average based on three different feature generation methods, but it only obtained the accuracy ranging from 0.3 to 0.8 for others. Similar cases can be found in other single models, which further validated the relative insufficient performance to predict the antigenic variants for mutation patterns of different types using single models.</p><table-wrap id="pone.0207777.t003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.t003</object-id><label>Table 3</label><caption><title>Single model prediction accuracy on residue-based, regional band-based and epitope region-based features within the same type.</title></caption><alternatives><graphic id="pone.0207777.t003g" xlink:href="pone.0207777.t003"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="2" colspan="1">Classifier</th><th align="center" colspan="3" rowspan="1">Feature generation methods</th></tr><tr><th align="center" rowspan="1" colspan="1">Residue-based</th><th align="center" rowspan="1" colspan="1">Regional band-based</th><th align="center" rowspan="1" colspan="1">Epitope region-based</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">LR</td><td align="center" rowspan="1" colspan="1"><inline-formula id="pone.0207777.e002"><alternatives><graphic id="pone.0207777.e002g" xlink:href="pone.0207777.e002"/><mml:math id="M2"><mml:mn mathcolor="#ff0000" mathvariant="bold">0.943</mml:mn></mml:math></alternatives></inline-formula></td><td align="center" rowspan="1" colspan="1">0.883</td><td align="center" rowspan="1" colspan="1">0.809</td></tr><tr><td align="center" rowspan="1" colspan="1">SVM</td><td align="center" rowspan="1" colspan="1">0.851</td><td align="center" rowspan="1" colspan="1">0.855</td><td align="center" rowspan="1" colspan="1">0.820</td></tr><tr><td align="center" rowspan="1" colspan="1">NB</td><td align="center" rowspan="1" colspan="1">0.532</td><td align="center" rowspan="1" colspan="1">0.737</td><td align="center" rowspan="1" colspan="1"><inline-formula id="pone.0207777.e003"><alternatives><graphic id="pone.0207777.e003g" xlink:href="pone.0207777.e003"/><mml:math id="M3"><mml:mn mathcolor="#ff0000" mathvariant="bold">0.823</mml:mn></mml:math></alternatives></inline-formula></td></tr><tr><td align="center" rowspan="1" colspan="1">NN</td><td align="center" rowspan="1" colspan="1">0.907</td><td align="center" rowspan="1" colspan="1"><inline-formula id="pone.0207777.e004"><alternatives><graphic id="pone.0207777.e004g" xlink:href="pone.0207777.e004"/><mml:math id="M4"><mml:mn mathcolor="#ff0000" mathvariant="bold">0.919</mml:mn></mml:math></alternatives></inline-formula></td><td align="center" rowspan="1" colspan="1">0.804</td></tr><tr><td align="center" rowspan="1" colspan="1">KNN</td><td align="center" rowspan="1" colspan="1">0.848</td><td align="center" rowspan="1" colspan="1">0.784</td><td align="center" rowspan="1" colspan="1">0.817</td></tr></tbody></table></alternatives></table-wrap><table-wrap id="pone.0207777.t004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.t004</object-id><label>Table 4</label><caption><title>Single model performance on residue-based, regional band-based and epitope region-based computational models trained and tested in Type II-VI.</title><p>&#x0201c;Acc&#x0201d;,accuracy; &#x0201c;Sen&#x0201d;, sensitivity; &#x0201c;Spe&#x0201d;, specificity.</p></caption><alternatives><graphic id="pone.0207777.t004g" xlink:href="pone.0207777.t004"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="2" colspan="1">Training</th><th align="center" rowspan="2" colspan="1">Testing</th><th align="center" colspan="3" rowspan="1">Residue-based</th><th align="center" colspan="3" rowspan="1">Regional band-based</th><th align="center" colspan="3" rowspan="1">Epitope region-based</th></tr><tr><th align="center" rowspan="1" colspan="1">Acc</th><th align="center" rowspan="1" colspan="1">Sen</th><th align="center" rowspan="1" colspan="1">Spe</th><th align="center" rowspan="1" colspan="1">Acc</th><th align="center" rowspan="1" colspan="1">Sen</th><th align="center" rowspan="1" colspan="1">Spe</th><th align="center" rowspan="1" colspan="1">Acc</th><th align="center" rowspan="1" colspan="1">Sen</th><th align="center" rowspan="1" colspan="1">Spe</th></tr></thead><tbody><tr><td align="center" rowspan="5" colspan="1">Type II</td><td align="center" rowspan="1" colspan="1">II</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.949</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.5</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.989</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.949</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.875</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.956</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.888</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.375</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.934</bold></td></tr><tr><td align="center" rowspan="1" colspan="1">III</td><td align="char" char="." rowspan="1" colspan="1">0.533</td><td align="center" rowspan="1" colspan="1">0.857</td><td align="center" rowspan="1" colspan="1">0.506</td><td align="char" char="." rowspan="1" colspan="1">0.9</td><td align="center" rowspan="1" colspan="1">0.077</td><td align="char" char="." rowspan="1" colspan="1">0.969</td><td align="char" char="." rowspan="1" colspan="1">0.783</td><td align="center" rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">0.849</td></tr><tr><td align="center" rowspan="1" colspan="1">IV</td><td align="char" char="." rowspan="1" colspan="1">0.692</td><td align="center" rowspan="1" colspan="1">0.559</td><td align="center" rowspan="1" colspan="1">0.743</td><td align="char" char="." rowspan="1" colspan="1">0.498</td><td align="center" rowspan="1" colspan="1">0.081</td><td align="char" char="." rowspan="1" colspan="1">0.659</td><td align="char" char="." rowspan="1" colspan="1">0.610</td><td align="center" rowspan="1" colspan="1">0.423</td><td align="char" char="." rowspan="1" colspan="1">0.682</td></tr><tr><td align="center" rowspan="1" colspan="1">V</td><td align="char" char="." rowspan="1" colspan="1">0.722</td><td align="center" rowspan="1" colspan="1">0.758</td><td align="center" rowspan="1" colspan="1">0.375</td><td align="char" char="." rowspan="1" colspan="1">0.25</td><td align="center" rowspan="1" colspan="1">0.134</td><td align="char" char="." rowspan="1" colspan="1">0.892</td><td align="char" char="." rowspan="1" colspan="1">0.472</td><td align="center" rowspan="1" colspan="1">0.458</td><td align="char" char="." rowspan="1" colspan="1">0.553</td></tr><tr><td align="center" rowspan="1" colspan="1">VI</td><td align="char" char="." rowspan="1" colspan="1">0.689</td><td align="center" rowspan="1" colspan="1">0.672</td><td align="center" rowspan="1" colspan="1">0.75</td><td align="char" char="." rowspan="1" colspan="1">0.391</td><td align="center" rowspan="1" colspan="1">0.327</td><td align="char" char="." rowspan="1" colspan="1">0.625</td><td align="char" char="." rowspan="1" colspan="1">0.459</td><td align="center" rowspan="1" colspan="1">0.465</td><td align="char" char="." rowspan="1" colspan="1">0.437</td></tr><tr><td align="center" rowspan="5" colspan="1">Type III</td><td align="center" rowspan="1" colspan="1">II</td><td align="char" char="." rowspan="1" colspan="1">0.666</td><td align="center" rowspan="1" colspan="1">0.25</td><td align="center" rowspan="1" colspan="1">0.703</td><td align="char" char="." rowspan="1" colspan="1">0.626</td><td align="center" rowspan="1" colspan="1">0.375</td><td align="char" char="." rowspan="1" colspan="1">0.648</td><td align="char" char="." rowspan="1" colspan="1">0.878</td><td align="center" rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">0.956</td></tr><tr><td align="center" rowspan="1" colspan="1">III</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.95</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.5</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.987</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.938</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.785</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.951</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.861</bold></td><td align="center" rowspan="1" colspan="1"><bold>1</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.849</bold></td></tr><tr><td align="center" rowspan="1" colspan="1">IV</td><td align="char" char="." rowspan="1" colspan="1">0.710</td><td align="center" rowspan="1" colspan="1">0.329</td><td align="center" rowspan="1" colspan="1">0.856</td><td align="char" char="." rowspan="1" colspan="1">0.615</td><td align="center" rowspan="1" colspan="1">0.273</td><td align="char" char="." rowspan="1" colspan="1">0.746</td><td align="char" char="." rowspan="1" colspan="1">0.698</td><td align="center" rowspan="1" colspan="1">0.517</td><td align="char" char="." rowspan="1" colspan="1">0.768</td></tr><tr><td align="center" rowspan="1" colspan="1">V</td><td align="char" char="." rowspan="1" colspan="1">0.336</td><td align="center" rowspan="1" colspan="1">0.288</td><td align="center" rowspan="1" colspan="1">0.607</td><td align="char" char="." rowspan="1" colspan="1">0.576</td><td align="center" rowspan="1" colspan="1">0.583</td><td align="char" char="." rowspan="1" colspan="1">0.535</td><td align="char" char="." rowspan="1" colspan="1">0.777</td><td align="center" rowspan="1" colspan="1">0.846</td><td align="char" char="." rowspan="1" colspan="1">0.392</td></tr><tr><td align="center" rowspan="1" colspan="1">VI</td><td align="char" char="." rowspan="1" colspan="1">0.702</td><td align="center" rowspan="1" colspan="1">0.810</td><td align="center" rowspan="1" colspan="1">0.312</td><td align="char" char="." rowspan="1" colspan="1">0.445</td><td align="center" rowspan="1" colspan="1">0.344</td><td align="char" char="." rowspan="1" colspan="1">0.812</td><td align="char" char="." rowspan="1" colspan="1">0.837</td><td align="center" rowspan="1" colspan="1">0.931</td><td align="char" char="." rowspan="1" colspan="1">0.5</td></tr><tr><td align="center" rowspan="5" colspan="1">Type IV</td><td align="center" rowspan="1" colspan="1">II</td><td align="char" char="." rowspan="1" colspan="1">0.282</td><td align="center" rowspan="1" colspan="1">0.75</td><td align="center" rowspan="1" colspan="1">0.241</td><td align="char" char="." rowspan="1" colspan="1">0.747</td><td align="center" rowspan="1" colspan="1">0.125</td><td align="char" char="." rowspan="1" colspan="1">0.802</td><td align="char" char="." rowspan="1" colspan="1">0.858</td><td align="center" rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">0.934</td></tr><tr><td align="center" rowspan="1" colspan="1">III</td><td align="char" char="." rowspan="1" colspan="1">0.455</td><td align="center" rowspan="1" colspan="1">0.714</td><td align="center" rowspan="1" colspan="1">0.433</td><td align="char" char="." rowspan="1" colspan="1">0.894</td><td align="center" rowspan="1" colspan="1">0.428</td><td align="char" char="." rowspan="1" colspan="1">0.933</td><td align="char" char="." rowspan="1" colspan="1">0.85</td><td align="center" rowspan="1" colspan="1">1</td><td align="char" char="." rowspan="1" colspan="1">0.837</td></tr><tr><td align="center" rowspan="1" colspan="1">IV</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.891</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.782</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.934</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.792</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.303</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.980</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.703</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.739</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.689</bold></td></tr><tr><td align="center" rowspan="1" colspan="1">V</td><td align="char" char="." rowspan="1" colspan="1">0.548</td><td align="center" rowspan="1" colspan="1">0.532</td><td align="center" rowspan="1" colspan="1">0.642</td><td align="char" char="." rowspan="1" colspan="1">0.491</td><td align="center" rowspan="1" colspan="1">0.458</td><td align="char" char="." rowspan="1" colspan="1">0.678</td><td align="char" char="." rowspan="1" colspan="1">0.793</td><td align="center" rowspan="1" colspan="1">0.913</td><td align="char" char="." rowspan="1" colspan="1">0.125</td></tr><tr><td align="center" rowspan="1" colspan="1">VI</td><td align="char" char="." rowspan="1" colspan="1">0.581</td><td align="center" rowspan="1" colspan="1">0.568</td><td align="center" rowspan="1" colspan="1">0.625</td><td align="char" char="." rowspan="1" colspan="1">0.5</td><td align="center" rowspan="1" colspan="1">0.396</td><td align="char" char="." rowspan="1" colspan="1">0.875</td><td align="char" char="." rowspan="1" colspan="1">0.851</td><td align="center" rowspan="1" colspan="1">0.931</td><td align="char" char="." rowspan="1" colspan="1">0.312</td></tr><tr><td align="center" rowspan="5" colspan="1">Type V</td><td align="center" rowspan="1" colspan="1">II</td><td align="char" char="." rowspan="1" colspan="1">0.575</td><td align="center" rowspan="1" colspan="1">0.75</td><td align="center" rowspan="1" colspan="1">0.560</td><td align="char" char="." rowspan="1" colspan="1">0.434</td><td align="center" rowspan="1" colspan="1">1</td><td align="char" char="." rowspan="1" colspan="1">0.384</td><td align="char" char="." rowspan="1" colspan="1">0.414</td><td align="center" rowspan="1" colspan="1">1</td><td align="char" char="." rowspan="1" colspan="1">0.362</td></tr><tr><td align="center" rowspan="1" colspan="1">III</td><td align="char" char="." rowspan="1" colspan="1">0.761</td><td align="center" rowspan="1" colspan="1">0.714</td><td align="center" rowspan="1" colspan="1">0.765</td><td align="char" char="." rowspan="1" colspan="1">0.827</td><td align="center" rowspan="1" colspan="1">0.928</td><td align="char" char="." rowspan="1" colspan="1">0.819</td><td align="char" char="." rowspan="1" colspan="1">0.322</td><td align="center" rowspan="1" colspan="1">1</td><td align="char" char="." rowspan="1" colspan="1">0.265</td></tr><tr><td align="center" rowspan="1" colspan="1">IV</td><td align="char" char="." rowspan="1" colspan="1">0.581</td><td align="center" rowspan="1" colspan="1">0.850</td><td align="center" rowspan="1" colspan="1">0.478</td><td align="char" char="." rowspan="1" colspan="1">0.442</td><td align="center" rowspan="1" colspan="1">0.944</td><td align="char" char="." rowspan="1" colspan="1">0.25</td><td align="char" char="." rowspan="1" colspan="1">0.317</td><td align="center" rowspan="1" colspan="1">0.965</td><td align="char" char="." rowspan="1" colspan="1">0.0761</td></tr><tr><td align="center" rowspan="1" colspan="1">V</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.937</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.967</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.767</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.934</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.971</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.732</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.810</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.935</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.107</bold></td></tr><tr><td align="center" rowspan="1" colspan="1">VI</td><td align="char" char="." rowspan="1" colspan="1">0.918</td><td align="center" rowspan="1" colspan="1">0.948</td><td align="center" rowspan="1" colspan="1">0.815</td><td align="char" char="." rowspan="1" colspan="1">0.770</td><td align="center" rowspan="1" colspan="1">0.810</td><td align="char" char="." rowspan="1" colspan="1">0.625</td><td align="char" char="." rowspan="1" colspan="1">0.851</td><td align="center" rowspan="1" colspan="1">1</td><td align="char" char="." rowspan="1" colspan="1">0.312</td></tr><tr><td align="center" rowspan="5" colspan="1">Type VI</td><td align="center" rowspan="1" colspan="1">II</td><td align="char" char="." rowspan="1" colspan="1">0.394</td><td align="center" rowspan="1" colspan="1">0.75</td><td align="center" rowspan="1" colspan="1">0.362</td><td align="char" char="." rowspan="1" colspan="1">0.686</td><td align="center" rowspan="1" colspan="1">0.25</td><td align="char" char="." rowspan="1" colspan="1">0.725</td><td align="char" char="." rowspan="1" colspan="1">0.868</td><td align="center" rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">0.945</td></tr><tr><td align="center" rowspan="1" colspan="1">III</td><td align="char" char="." rowspan="1" colspan="1">0.167</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">0.097</td><td align="char" char="." rowspan="1" colspan="1">0.827</td><td align="center" rowspan="1" colspan="1">0.194</td><td align="char" char="." rowspan="1" colspan="1">0.714</td><td align="char" char="." rowspan="1" colspan="1">0.855</td><td align="center" rowspan="1" colspan="1">0.928</td><td align="char" char="." rowspan="1" colspan="1">0.849</td></tr><tr><td align="center" rowspan="1" colspan="1">IV</td><td align="char" char="." rowspan="1" colspan="1">0.550</td><td align="center" rowspan="1" colspan="1">0.623</td><td align="center" rowspan="1" colspan="1">0.521</td><td align="char" char="." rowspan="1" colspan="1">0.432</td><td align="center" rowspan="1" colspan="1">0.589</td><td align="char" char="." rowspan="1" colspan="1">0.371</td><td align="char" char="." rowspan="1" colspan="1">0.666</td><td align="center" rowspan="1" colspan="1">0.717</td><td align="char" char="." rowspan="1" colspan="1">0.646</td></tr><tr><td align="center" rowspan="1" colspan="1">V</td><td align="char" char="." rowspan="1" colspan="1">0.793</td><td align="center" rowspan="1" colspan="1">0.910</td><td align="center" rowspan="1" colspan="1">0.142</td><td align="char" char="." rowspan="1" colspan="1">0.578</td><td align="center" rowspan="1" colspan="1">0.637</td><td align="char" char="." rowspan="1" colspan="1">0.25</td><td align="char" char="." rowspan="1" colspan="1">0.793</td><td align="center" rowspan="1" colspan="1">0.913</td><td align="char" char="." rowspan="1" colspan="1">0.125</td></tr><tr><td align="center" rowspan="1" colspan="1">VI</td><td align="char" char="." rowspan="1" colspan="1"><bold>0.986</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.982</bold></td><td align="center" rowspan="1" colspan="1"><bold>1</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.945</bold></td><td align="center" rowspan="1" colspan="1"><bold>0.982</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.812</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.851</bold></td><td align="center" rowspan="1" colspan="1"><bold>1</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>0.312</bold></td></tr></tbody></table></alternatives></table-wrap><p>We further studied how the partition of different periods of HA1 proteins made the impact on the model of antigenic variants prediction. Due to the rapid antigenic shift or drift that brings about the occurrence of antigenic variants, the effects on antigenicity of specific mutations have not been clear painted. The changes of antigenicity depend not only on the property and number of the amino acid substitutions but also on the amino acids currently encoded at certain key positions in HA1 [<xref rid="pone.0207777.ref038" ref-type="bibr">38</xref>]. The performance of the models based on different feature vectors didn&#x02019;t show much difference, which indicated that the generation of new features from residue sites was probably not the main factor in influencing the prediction results. Some more elements, such as environment and individual immune system, need to be considered for the possibility of H1N1 variation mechanism that distinguishes epidemics and pandemics, which is out of scope in this paper.</p><p>The pilots above prompt the construction of a comprehensive model that can contain all different types for antigenicity prediction. Therefore, a stacking model was built to predict the antigenic variants of HA1 proteins of influenza H1N1 for all circumstances. Logistic regression, neural network and na&#x000ef;ve bayes were selected as base classifiers to constitute the models at level 1 of stacking model due to their performance in single models. Except for these three classifiers, we also introduced two ensemble classifiers, random forest (RF) and gradient boosting (GB), to jointly form the models at level 2, adding diversity and strengthening the robustness. The stacking model at level 3 was built by logistic regression because of the small dimension for new training dataset obtained from level 2. The performance of the stacking model was presented in <xref ref-type="fig" rid="pone.0207777.g003">Fig 3</xref> in comparison with other classifiers used at the level 2 for the prediction of antigenic variants by three different feature vectors. We calculated the mean value of each type obtained by these models in terms of accuracy, sensitivity and specificity. The details of the results could be found in <xref ref-type="supplementary-material" rid="pone.0207777.s003">S3 File</xref>. Accordingly, the best predicting accuracy was 0.908, achieved by stacking model with residue-based features. The sensitivity and specificity of the stacking model also displayed competitiveness, which was 0.755 and 0.811 respectively. We may infer that the more residues we used, the better performance it would achieve on the antigenic variants prediction. Although the results based on five epitope regions and ten regional bands performed not as well as residue-based method, we observed that the stacking model still slightly outperformed other models.</p><fig id="pone.0207777.g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.g003</object-id><label>Fig 3</label><caption><title>Performance comparison of residue-based, regional band-based and epitope-based computational models trained and tested across different types.</title><p>&#x0201c;acc&#x0201d;: accuracy; &#x0201c;sen&#x0201d;: sensitivity; &#x0201c;spe&#x0201d;: specificity.</p></caption><graphic xlink:href="pone.0207777.g003"/></fig><p>In comparison, we also investigated and compared the performance of the stacking model with imbalanced and balanced datasets. The results in <xref ref-type="fig" rid="pone.0207777.g004">Fig 4</xref> only showed the average performance containing all types. (Details can be seen in <xref ref-type="supplementary-material" rid="pone.0207777.s003">S3 File</xref>) It suggested that the stacking model with imbalanced datasets comprehensively presented slight better performances over balanced datasets by all three different feature generation methods except for the sensitivity on five epitope-based method. It was implausible that the evenly distributed datasets negatively contributed to the performance of the model. This was probably due to the small-scale balanced samples we extracted for training and testing, which was not a lot to learn for classifiers. Indeed, the insufficient antigenic data in different periods would set obstacles on the performance of the model. Even though, our stacking model has successfully predicted antigenic relationship between strains based on limited data. Moreover, <xref ref-type="fig" rid="pone.0207777.g005">Fig 5</xref> showed the ROC (Receiver Operating Characteristic) curve with a significant proportion of area under curve (AUC) of 0.915 by the stacking model. The AUC value illustrated the matching degree with the experiment data ranging from 0 to 1 and the larger of the value, the better of the matching level. These outcomes demonstrate that the stacking model built upon epidemics and pandemics not only performs better than models using other classifiers in the experiments, but also achieves comprehensive improvement compared with the results of single models in <xref rid="pone.0207777.t004" ref-type="table">Table 4</xref>.</p><fig id="pone.0207777.g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.g004</object-id><label>Fig 4</label><caption><title>The performance of stacking model with imbalanced and balanced datasets based on three feature generation methods.</title><p>&#x0201c;acc&#x0201d;: accuracy; &#x0201c;sen&#x0201d;: sensitivity; &#x0201c;spe&#x0201d;: specificity. (a) The performance of residue-based stacking model (b) The performance of ten regional-based stacking model (c) The performance of five epitope-based stacking model.</p></caption><graphic xlink:href="pone.0207777.g004"/></fig><fig id="pone.0207777.g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0207777.g005</object-id><label>Fig 5</label><caption><title>The Receiver Operating Characteristic (ROC) curve of the stacking model predicting the antigenic variants of influenza A H1N1 virus.</title></caption><graphic xlink:href="pone.0207777.g005"/></fig></sec><sec sec-type="conclusions" id="sec008"><title>Discussion</title><p>Since the occurrence of 1918 Spanish pandemic, the influenza H1N1 has been evolving and circulating up to now. The rapid mutations of the antigenicity of influenza A virus are unceasingly causing other epidemics or pandemics that severely threaten public health. In this work, we analyzed and compared the mutation patterns of HA1 protein from six periods defined by the characterization of epidemics and pandemics. The moving average position information entropy and Pearson Correlation Coefficient were applied on mutation patterns analysis. Due to the scarce data of strains in period 1, the analysis of mutation patterns of period 1 was excluded. The results in <xref ref-type="fig" rid="pone.0207777.g002">Fig 2</xref> showed similarity of mutation patterns in some regions of the residue sites, for example, the residue sites from 180 to 200 indicated the same variation trend across periods. But the overall variation trend indicates the distinct patterns of epidemics or pandemics in different periods, which is in accordance with update of influenza vaccines every year [<xref rid="pone.0207777.ref039" ref-type="bibr">39</xref>&#x02013;<xref rid="pone.0207777.ref041" ref-type="bibr">41</xref>]. Besides, the value of moving entropy information of period 3 is small compared with other periods. This could be caused by insufficient sequences collected for the calculation of entropy information.</p><p>The purpose of applying three different methods of feature generation for antigenic variants prediction is to validate the feasibility and reliability of the model constructed based on epidemics and pandemics. The residue-based method converts the number of amino acids changes in each residue site between a pair of sequences as one feature and all the sites are taken for generating feature vectors. Although not all sites are closely correlated with antigenic variation, we obtain impressive performance in the prediction of antigenic relation between strains. The features extracted from five epitope regions focus on the regions that encompass the sites at which antibodies bind to HA1 [<xref rid="pone.0207777.ref042" ref-type="bibr">42</xref>]. Different from residue-based method, epitope region-based method would more directly reflect the relation between antigenic sites and variants. Moreover, some researchers regard that the evolutionary selective pressure has varied over time on some specific amino acid position [<xref rid="pone.0207777.ref043" ref-type="bibr">43</xref>], indicating the significance of detecting other important sites influencing immune response. Therefore, ten regional bands have been proposed [<xref rid="pone.0207777.ref030" ref-type="bibr">30</xref>] and the features generated from ten regional bands not only contain many residues in epitope regions but also implicate potential crucial sites that locate outside five antigenic epitopes. <xref ref-type="fig" rid="pone.0207777.g003">Fig 3</xref> suggests that the model using residue-based features achieves better prediction results than regional band-based and epitope regional-based features. We might infer that the more features applied for the prediction of antigenic variants, the better performance will be.</p><p>However, the relative few antigenic data is available in some periods for H1N1 viruses, which could hinder the development of computational models and further hamper the performance of prediction on antigenic variants. Meanwhile, the mutation pattern analyses demonstrated the diversity of influenza virus antigens in different periods. Single model was built to predict their antigenicity at first. The results turned out that these single models performed much worse trained and tested in different types than in the same type, suggesting single model is not capable of predicting antigenicity across types with acceptable confidence. Therefore, a stacking model was developed that integrated all the situations of antigenic variants prediction of influenza H1N1 HA1 proteins in different types using all the antigenic data. Feature vectors extracted by three different methods were applied on the stacking model. Although it performed slightly inferior to single models which were trained and tested in the same type in <xref rid="pone.0207777.t003" ref-type="table">Table 3</xref>, the performance of predicting antigenic variants by the stacking model across types was much better than the single model. Besides, we can also find that the stacking model showed the best performance compared with other classifiers applied at level 2, exceeding 0.87 in accuracy on average. This could be the optimized classifiers applied individual types that constitute the level 2 of the base models, enabling us to average out the noise from diverse models and thereby enhance the generalized prediction results. This is sometimes referred as an approach named &#x0201c;wisdom of crowds&#x0201d;, pulling from the age-old philosophy of Aristotle [<xref rid="pone.0207777.ref044" ref-type="bibr">44</xref>]. By combining antigenic data from all types in terms of epidemic and pandemic information and using diverse modeling approaches, the stacking model gain more accuracy and robustness than a fine-tuned single model can obtain.</p><p>Even if we could obtain good performance on the prediction results based on different influenza epidemics and pandemics, there are still some space on the improvement of specificity and sensitivity. For example, the sensitivity is low in some of the constructed models, especially for the prediction of Type II. (See in <xref ref-type="supplementary-material" rid="pone.0207777.s003">S3 File</xref>) One crucial factor is the limited antigenic data we can collect and the imbalanced classes of similar and distinct pair of strains. We may bring in penalty mechanism or assign unequal weight distribution on samples in the training process to tune the bias towards the minority class. Nevertheless, this stacking model validates its feasibility and reliability on the prediction of antigenic variants of H1N1 influenza A virus. The analysis also raises the perspective of how to select a proper model when predicting the antigenic variants for influenza viruses in different types with few antigenic data available. The model based on the chronological evolutionary paths of H1N1 that caused epidemics and pandemics with closest possible genetic relations could provide a suitable choice to target antigenic variants. Meanwhile, the stacking model built on diverse epidemic and pandemic periods of antigenic data would capture more comprehensive mechanisms behind antigenic variation. Our future work moves towards the improvement of these models and the identification of potential virulent sites that can distinguish the formation of epidemics and pandemics caused by influenza H1N1 viruses.</p></sec><sec sec-type="conclusions" id="sec009"><title>Conclusion</title><p>In conclusion, we divide the influenza strains of H1N1 epidemic and pandemic events into different periods chronologically. Mutation pattern analysis of HA1 of influenza A H1N1 proves that the amino acid changes and antigenic variation of strain pairs differ across periods. The single prediction models constructed show clear poorer performance when tested in the antigenic relation with other types. Therefore, the construction of the stacking model of prediction antigenic variants of influenza H1N1 overcomes the challenge of diverse mutation variations, combining all the situations. Residue-based, five epitope region-based and ten regional band-based feature vectors applied in the training process prove the feasibility and reliability of the stacking model built on chronological epidemic and pandemic periods by achieving a good performance on the prediction of antigenic variants. This study not only paves a path on the study of distinct antigenic evolution of influenza H1N1 virus, but also gives insight on the potential mutation sites that distinguish past epidemic and pandemic outbreaks. It also provides a new perspective for the antigenic variants prediction with reliability and accelerates the selection of vaccine strains.</p></sec><sec sec-type="supplementary-material" id="sec010"><title>Supporting information</title><supplementary-material content-type="local-data" id="pone.0207777.s001"><label>S1 File</label><caption><title>Antigenic and corresponding sequence data of each type for calculating the antigenic relation between strains of influenza H1N1 HA proteins.</title><p>(CSV)</p></caption><media xlink:href="pone.0207777.s001.csv"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0207777.s002"><label>S2 File</label><caption><title>HA Sequence data for the analysis of mutation patterns of epidemic and pandemic strains in each period.</title><p>(FAS)</p></caption><media xlink:href="pone.0207777.s002.fas"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0207777.s003"><label>S3 File</label><caption><title>The performance comparison between stacking model and other models and comparison between stacking model with imbalanced and balanced datasets by residue-based, ten regional band-based and five epitope region-based methods.</title><p>(XLSX)</p></caption><media xlink:href="pone.0207777.s003.xlsx"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack><p>This project is supported by AcRF Tier 2 grant MOE2014-T2-2-023, Ministry of Education, Singapore. We thank all members in Biomedical Informatics Lab of Nanyang Technological University who gave insightful comments to this manuscript.</p></ack><ref-list><title>References</title><ref id="pone.0207777.ref001"><label>1</label><mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>NP</given-names></name>, <name><surname>Mueller</surname><given-names>J</given-names></name>. <article-title>Updating the accounts: global mortality of the 1918-1920 &#x0201c;Spanish&#x0201d; influenza pandemic</article-title>. <source>Bulletin of the History of Medicine</source>. <year>2002</year>;<volume>76</volume>(<issue>1</issue>):<fpage>105</fpage>&#x02013;<lpage>115</lpage>. <pub-id pub-id-type="doi">10.1353/bhm.2002.0022</pub-id>
<?supplied-pmid 11875246?><pub-id pub-id-type="pmid">11875246</pub-id></mixed-citation></ref><ref id="pone.0207777.ref002"><label>2</label><mixed-citation publication-type="other">World Health Organization. Fact sheet No 211: Influenza (Seasonal). WHO: Geneva, Switzerland, April. 2009;.</mixed-citation></ref><ref id="pone.0207777.ref003"><label>3</label><mixed-citation publication-type="journal"><name><surname>de Wit</surname><given-names>E</given-names></name>, <name><surname>Fouchier</surname><given-names>RAM</given-names></name>. <article-title>Emerging influenza</article-title>. <source>Journal of clinical virology: the official publication of the Pan American Society for Clinical Virology</source>. <year>2008</year>;<volume>41</volume>
<issue>1</issue>:<fpage>1</fpage>&#x02013;<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1016/j.jcv.2007.10.017</pub-id><pub-id pub-id-type="pmid">18340670</pub-id></mixed-citation></ref><ref id="pone.0207777.ref004"><label>4</label><mixed-citation publication-type="journal"><name><surname>Russell</surname><given-names>RJ</given-names></name>, <name><surname>Kerry</surname><given-names>PS</given-names></name>, <name><surname>Stevens</surname><given-names>DJ</given-names></name>, <name><surname>Steinhauer</surname><given-names>DA</given-names></name>, <name><surname>Martin</surname><given-names>SR</given-names></name>, <name><surname>Gamblin</surname><given-names>SJ</given-names></name>, <etal>et al</etal>
<article-title>Structure of influenza hemagglutinin in complex with an inhibitor of membrane fusion</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2008</year>;<volume>105</volume>(<issue>46</issue>):<fpage>17736</fpage>&#x02013;<lpage>17741</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0807142105</pub-id></mixed-citation></ref><ref id="pone.0207777.ref005"><label>5</label><mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>E</given-names></name>. <article-title>Influenza virus genetics</article-title>. <source>Biomedicine &#x00026; Pharmacotherapy</source>. <year>2000</year>;<volume>54</volume>(<issue>4</issue>):<fpage>196</fpage>&#x02013;<lpage>209</lpage>. <pub-id pub-id-type="doi">10.1016/S0753-3322(00)89026-5</pub-id><pub-id pub-id-type="pmid">10872718</pub-id></mixed-citation></ref><ref id="pone.0207777.ref006"><label>6</label><mixed-citation publication-type="journal"><name><surname>Plotkin</surname><given-names>JB</given-names></name>, <name><surname>Dushoff</surname><given-names>J</given-names></name>. <article-title>Codon bias and frequency-dependent selection on the hemagglutinin epitopes of influenza A virus</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2003</year>;<volume>100</volume>(<issue>12</issue>):<fpage>7152</fpage>&#x02013;<lpage>7157</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1132114100</pub-id></mixed-citation></ref><ref id="pone.0207777.ref007"><label>7</label><mixed-citation publication-type="journal"><name><surname>De Jong</surname><given-names>J</given-names></name>, <name><surname>Palache</surname><given-names>A</given-names></name>, <name><surname>Beyer</surname><given-names>W</given-names></name>, <name><surname>Rimmelzwaan</surname><given-names>G</given-names></name>, <name><surname>Boon</surname><given-names>A</given-names></name>, <name><surname>Osterhaus</surname><given-names>A</given-names></name>. <article-title>Haemagglutination-inhibiting antibody to influenza virus</article-title>. <source>Developments in biologicals</source>. <year>2003</year>;<volume>115</volume>:<fpage>63</fpage>&#x02013;<lpage>73</lpage>. <?supplied-pmid 15088777?><pub-id pub-id-type="pmid">15088777</pub-id></mixed-citation></ref><ref id="pone.0207777.ref008"><label>8</label><mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>DJ</given-names></name>, <name><surname>Lapedes</surname><given-names>AS</given-names></name>, <name><surname>de Jong</surname><given-names>JC</given-names></name>, <name><surname>Bestebroer</surname><given-names>TM</given-names></name>, <name><surname>Rimmelzwaan</surname><given-names>GF</given-names></name>, <name><surname>Osterhaus</surname><given-names>AD</given-names></name>, <etal>et al</etal>
<article-title>Mapping the antigenic and genetic evolution of influenza virus</article-title>. <source>science</source>. <year>2004</year>;<volume>305</volume>(<issue>5682</issue>):<fpage>371</fpage>&#x02013;<lpage>376</lpage>. <pub-id pub-id-type="doi">10.1126/science.1097211</pub-id>
<?supplied-pmid 15218094?><pub-id pub-id-type="pmid">15218094</pub-id></mixed-citation></ref><ref id="pone.0207777.ref009"><label>9</label><mixed-citation publication-type="journal"><name><surname>Lorusso</surname><given-names>A</given-names></name>, <name><surname>Vincent</surname><given-names>AL</given-names></name>, <name><surname>Harland</surname><given-names>ML</given-names></name>, <name><surname>Alt</surname><given-names>D</given-names></name>, <name><surname>Bayles</surname><given-names>DO</given-names></name>, <name><surname>Swenson</surname><given-names>SL</given-names></name>, <etal>et al</etal>
<article-title>Genetic and antigenic characterization of H1 influenza viruses from United States swine from 2008</article-title>. <source>Journal of General Virology</source>. <year>2011</year>;<volume>92</volume>(<issue>4</issue>):<fpage>919</fpage>&#x02013;<lpage>930</lpage>. <pub-id pub-id-type="doi">10.1099/vir.0.027557-0</pub-id>
<?supplied-pmid 21177926?><pub-id pub-id-type="pmid">21177926</pub-id></mixed-citation></ref><ref id="pone.0207777.ref010"><label>10</label><mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>M</given-names></name>, <name><surname>Zhao</surname><given-names>X</given-names></name>, <name><surname>Hua</surname><given-names>S</given-names></name>, <name><surname>Du</surname><given-names>X</given-names></name>, <name><surname>Peng</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <etal>et al</etal>
<article-title>Antigenic Patterns and Evolution of the Human Influenza A (H1N1) Virus</article-title>. <source>Scientific reports</source>. <year>2015</year>;<volume>5</volume>.</mixed-citation></ref><ref id="pone.0207777.ref011"><label>11</label><mixed-citation publication-type="journal"><name><surname>Bedford</surname><given-names>T</given-names></name>, <name><surname>Riley</surname><given-names>S</given-names></name>, <name><surname>Barr</surname><given-names>IG</given-names></name>, <name><surname>Broor</surname><given-names>S</given-names></name>, <name><surname>Chadha</surname><given-names>M</given-names></name>, <name><surname>Cox</surname><given-names>NJ</given-names></name>, <etal>et al</etal>
<article-title>Global circulation patterns of seasonal influenza viruses vary with antigenic drift</article-title>. <source>Nature</source>. <year>2015</year>;<volume>523</volume>(<issue>7559</issue>):<fpage>217</fpage>&#x02013;<lpage>220</lpage>. <pub-id pub-id-type="doi">10.1038/nature14460</pub-id>
<?supplied-pmid 26053121?><pub-id pub-id-type="pmid">26053121</pub-id></mixed-citation></ref><ref id="pone.0207777.ref012"><label>12</label><mixed-citation publication-type="journal"><name><surname>Du</surname><given-names>X</given-names></name>, <name><surname>Dong</surname><given-names>L</given-names></name>, <name><surname>Lan</surname><given-names>Y</given-names></name>, <name><surname>Peng</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>A</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <etal>et al</etal>
<article-title>Mapping of H3N2 influenza antigenic evolution in China reveals a strategy for vaccine strain recommendation</article-title>. <source>Nature communications</source>. <year>2012</year>;<volume>3</volume>:<fpage>709</fpage>
<pub-id pub-id-type="doi">10.1038/ncomms1710</pub-id>
<?supplied-pmid 22426230?><pub-id pub-id-type="pmid">22426230</pub-id></mixed-citation></ref><ref id="pone.0207777.ref013"><label>13</label><mixed-citation publication-type="journal"><name><surname>Barnett</surname><given-names>JL</given-names></name>, <name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Cai</surname><given-names>Z</given-names></name>, <name><surname>Zhang</surname><given-names>T</given-names></name>, <name><surname>Wan</surname><given-names>XF</given-names></name>. <article-title>AntigenMap 3D: an online antigenic cartography resource</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>9</issue>):<fpage>1292</fpage>&#x02013;<lpage>1293</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts105</pub-id>
<?supplied-pmid 22399675?><pub-id pub-id-type="pmid">22399675</pub-id></mixed-citation></ref><ref id="pone.0207777.ref014"><label>14</label><mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Shen</surname><given-names>X</given-names></name>, <name><surname>Gao</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>. <article-title>Computational identification of antigenicity-associated sites in the hemagglutinin protein of a/h1n1 seasonal influenza virus</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>5</issue>):<fpage>e0126742</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0126742</pub-id>
<?supplied-pmid 25978416?><pub-id pub-id-type="pmid">25978416</pub-id></mixed-citation></ref><ref id="pone.0207777.ref015"><label>15</label><mixed-citation publication-type="other">Yin R, Zhou X, Ivan FX, Zheng J, Chow VTK, Kwoh CK. Identification of Potential Critical Virulent Sites Based on Hemagglutinin of Influenza a Virus in Past Pandemic Strains. In: ICBBS&#x02019;17; 2017.</mixed-citation></ref><ref id="pone.0207777.ref016"><label>16</label><mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>H</given-names></name>, <name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>T</given-names></name>, <name><surname>Long</surname><given-names>LP</given-names></name>, <name><surname>Jia</surname><given-names>K</given-names></name>, <name><surname>Yang</surname><given-names>G</given-names></name>, <etal>et al</etal>
<article-title>Using sequence data to infer the antigenicity of influenza virus</article-title>. <source>MBio</source>. <year>2013</year>;<volume>4</volume>(<issue>4</issue>):<fpage>e00230</fpage>&#x02013;<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1128/mBio.00230-13</pub-id>
<?supplied-pmid 23820391?><pub-id pub-id-type="pmid">23820391</pub-id></mixed-citation></ref><ref id="pone.0207777.ref017"><label>17</label><mixed-citation publication-type="journal"><name><surname>Yao</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Liao</surname><given-names>B</given-names></name>, <name><surname>Huang</surname><given-names>L</given-names></name>, <name><surname>He</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>F</given-names></name>, <etal>et al</etal>
<article-title>Predicting influenza antigenicity from Hemagglutintin sequence data based on a joint random forest method</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>
<pub-id pub-id-type="doi">10.1038/s41598-017-01699-z</pub-id></mixed-citation></ref><ref id="pone.0207777.ref018"><label>18</label><mixed-citation publication-type="journal"><name><surname>Qiu</surname><given-names>J</given-names></name>, <name><surname>Qiu</surname><given-names>T</given-names></name>, <name><surname>Yang</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>D</given-names></name>, <name><surname>Cao</surname><given-names>Z</given-names></name>. <article-title>Incorporating structure context of HA protein to improve antigenicity calculation for influenza virus A/H3N2</article-title>. <source>Scientific reports</source>. <year>2016</year>;<volume>6</volume>:<fpage>31156</fpage>
<pub-id pub-id-type="doi">10.1038/srep31156</pub-id>
<?supplied-pmid 27498613?><pub-id pub-id-type="pmid">27498613</pub-id></mixed-citation></ref><ref id="pone.0207777.ref019"><label>19</label><mixed-citation publication-type="journal"><name><surname>Peng</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>D</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>K</given-names></name>, <name><surname>Tan</surname><given-names>Z</given-names></name>, <name><surname>Shu</surname><given-names>Y</given-names></name>, <etal>et al</etal>
<article-title>A universal computational model for predicting antigenic variants of influenza A virus based on conserved antigenic structures</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>:<fpage>42051</fpage>
<pub-id pub-id-type="doi">10.1038/srep42051</pub-id>
<?supplied-pmid 28165025?><pub-id pub-id-type="pmid">28165025</pub-id></mixed-citation></ref><ref id="pone.0207777.ref020"><label>20</label><mixed-citation publication-type="journal"><name><surname>Neher</surname><given-names>RA</given-names></name>, <name><surname>Bedford</surname><given-names>T</given-names></name>, <name><surname>Daniels</surname><given-names>RS</given-names></name>, <name><surname>Russell</surname><given-names>CA</given-names></name>, <name><surname>Shraiman</surname><given-names>BI</given-names></name>. <article-title>Prediction, dynamics, and visualization of antigenic phenotypes of seasonal influenza viruses</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>12</issue>):<fpage>E1701</fpage>&#x02013;<lpage>E1709</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1525578113</pub-id></mixed-citation></ref><ref id="pone.0207777.ref021"><label>21</label><mixed-citation publication-type="journal"><name><surname>&#x00141;uksza</surname><given-names>M</given-names></name>, <name><surname>L&#x000e4;ssig</surname><given-names>M</given-names></name>. <article-title>A predictive fitness model for influenza</article-title>. <source>Nature</source>. <year>2014</year>;<volume>507</volume>(<issue>7490</issue>):<fpage>57</fpage>
<pub-id pub-id-type="doi">10.1038/nature13087</pub-id>
<?supplied-pmid 24572367?><pub-id pub-id-type="pmid">24572367</pub-id></mixed-citation></ref><ref id="pone.0207777.ref022"><label>22</label><mixed-citation publication-type="book"><name><surname>Benesty</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Cohen</surname><given-names>I</given-names></name>. <chapter-title>Pearson correlation coefficient</chapter-title> In: <source>Noise reduction in speech processing</source>. <publisher-name>Springer</publisher-name>; <year>2009</year> p. <fpage>1</fpage>&#x02013;<lpage>4</lpage>.</mixed-citation></ref><ref id="pone.0207777.ref023"><label>23</label><mixed-citation publication-type="journal"><name><surname>Sayers</surname><given-names>EW</given-names></name>, <name><surname>Barrett</surname><given-names>T</given-names></name>, <name><surname>Benson</surname><given-names>DA</given-names></name>, <name><surname>Bolton</surname><given-names>E</given-names></name>, <name><surname>Bryant</surname><given-names>SH</given-names></name>, <name><surname>Canese</surname><given-names>K</given-names></name>, <etal>et al</etal>
<article-title>Database resources of the national center for biotechnology information</article-title>. <source>Nucleic acids research</source>. <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D13</fpage>&#x02013;<lpage>D25</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr1184</pub-id>
<?supplied-pmid 22140104?><pub-id pub-id-type="pmid">22140104</pub-id></mixed-citation></ref><ref id="pone.0207777.ref024"><label>24</label><mixed-citation publication-type="journal"><name><surname>Shu</surname><given-names>Y</given-names></name>, <name><surname>McCauley</surname><given-names>J</given-names></name>. <article-title>GISAID: Global initiative on sharing all influenza data&#x02013;from vision to reality</article-title>. <source>Eurosurveillance</source>. <year>2017</year>;<volume>22</volume>(<issue>13</issue>). <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.13.30494</pub-id></mixed-citation></ref><ref id="pone.0207777.ref025"><label>25</label><mixed-citation publication-type="journal"><name><surname>Hirst</surname><given-names>GK</given-names></name>. <article-title>The quantitative determination of influenza virus and antibodies by means of red cell agglutination</article-title>. <source>Journal of Experimental Medicine</source>. <year>1942</year>;<volume>75</volume>(<issue>1</issue>):<fpage>49</fpage>&#x02013;<lpage>64</lpage>. <pub-id pub-id-type="doi">10.1084/jem.75.1.49</pub-id>
<?supplied-pmid 19871167?><pub-id pub-id-type="pmid">19871167</pub-id></mixed-citation></ref><ref id="pone.0207777.ref026"><label>26</label><mixed-citation publication-type="journal"><name><surname>Ndifon</surname><given-names>W</given-names></name>, <name><surname>Dushoff</surname><given-names>J</given-names></name>, <name><surname>Levin</surname><given-names>SA</given-names></name>. <article-title>On the use of hemagglutination-inhibition for influenza surveillance: surveillance data are predictive of influenza vaccine effectiveness</article-title>. <source>Vaccine</source>. <year>2009</year>;<volume>27</volume>(<issue>18</issue>):<fpage>2447</fpage>&#x02013;<lpage>2452</lpage>. <pub-id pub-id-type="doi">10.1016/j.vaccine.2009.02.047</pub-id>
<?supplied-pmid 19368786?><pub-id pub-id-type="pmid">19368786</pub-id></mixed-citation></ref><ref id="pone.0207777.ref027"><label>27</label><mixed-citation publication-type="journal"><name><surname>Liao</surname><given-names>YC</given-names></name>, <name><surname>Lee</surname><given-names>MS</given-names></name>, <name><surname>Ko</surname><given-names>CY</given-names></name>, <name><surname>Hsiung</surname><given-names>CA</given-names></name>. <article-title>Bioinformatics models for predicting antigenic variants of influenza A/H3N2 virus</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>4</issue>):<fpage>505</fpage>&#x02013;<lpage>512</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btm638</pub-id>
<?supplied-pmid 18187440?><pub-id pub-id-type="pmid">18187440</pub-id></mixed-citation></ref><ref id="pone.0207777.ref028"><label>28</label><mixed-citation publication-type="journal"><name><surname>Zacour</surname><given-names>M</given-names></name>, <name><surname>Ward</surname><given-names>BJ</given-names></name>, <name><surname>Brewer</surname><given-names>A</given-names></name>, <name><surname>Tang</surname><given-names>P</given-names></name>, <name><surname>Boivin</surname><given-names>G</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <etal>et al</etal>
<article-title>Standardization of Hemagglutination Inhibition Assay for Influenza Serology Allows for High Reproducibility between Laboratories</article-title>. <source>Clinical and Vaccine Immunology</source>. <year>2016</year>;<volume>23</volume>(<issue>3</issue>):<fpage>236</fpage>&#x02013;<lpage>242</lpage>. <pub-id pub-id-type="doi">10.1128/CVI.00613-15</pub-id>
<?supplied-pmid 26818953?><pub-id pub-id-type="pmid">26818953</pub-id></mixed-citation></ref><ref id="pone.0207777.ref029"><label>29</label><mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Standley</surname><given-names>DM</given-names></name>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Molecular biology and evolution</source>. <year>2013</year>;<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>&#x02013;<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
<?supplied-pmid 23329690?><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation></ref><ref id="pone.0207777.ref030"><label>30</label><mixed-citation publication-type="journal"><name><surname>Lees</surname><given-names>WD</given-names></name>, <name><surname>Moss</surname><given-names>DS</given-names></name>, <name><surname>Shepherd</surname><given-names>AJ</given-names></name>. <article-title>A computational analysis of the antigenic properties of haemagglutinin in influenza A H3N2</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>11</issue>):<fpage>1403</fpage>&#x02013;<lpage>1408</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq160</pub-id>
<?supplied-pmid 20388627?><pub-id pub-id-type="pmid">20388627</pub-id></mixed-citation></ref><ref id="pone.0207777.ref031"><label>31</label><mixed-citation publication-type="journal"><name><surname>Deem</surname><given-names>MW</given-names></name>, <name><surname>Pan</surname><given-names>K</given-names></name>. <article-title>The epitope regions of H1-subtype influenza A, with application to vaccine efficacy</article-title>. <source>Protein Engineering, Design &#x00026; Selection</source>. <year>2009</year>;<volume>22</volume>(<issue>9</issue>):<fpage>543</fpage>&#x02013;<lpage>546</lpage>. <pub-id pub-id-type="doi">10.1093/protein/gzp027</pub-id></mixed-citation></ref><ref id="pone.0207777.ref032"><label>32</label><mixed-citation publication-type="journal"><name><surname>Dunham</surname><given-names>EJ</given-names></name>, <name><surname>Dugan</surname><given-names>VG</given-names></name>, <name><surname>Kaser</surname><given-names>EK</given-names></name>, <name><surname>Perkins</surname><given-names>SE</given-names></name>, <name><surname>Brown</surname><given-names>IH</given-names></name>, <name><surname>Holmes</surname><given-names>EC</given-names></name>, <etal>et al</etal>
<article-title>Different evolutionary trajectories of European avian-like and classical swine H1N1 influenza A viruses</article-title>. <source>Journal of virology</source>. <year>2009</year>;<volume>83</volume>(<issue>11</issue>):<fpage>5485</fpage>&#x02013;<lpage>5494</lpage>. <pub-id pub-id-type="doi">10.1128/JVI.02565-08</pub-id>
<?supplied-pmid 19297491?><pub-id pub-id-type="pmid">19297491</pub-id></mixed-citation></ref><ref id="pone.0207777.ref033"><label>33</label><mixed-citation publication-type="journal"><name><surname>Polikar</surname><given-names>R</given-names></name>. <article-title>Ensemble based systems in decision making</article-title>. <source>IEEE Circuits and systems magazine</source>. <year>2006</year>;<volume>6</volume>(<issue>3</issue>):<fpage>21</fpage>&#x02013;<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1109/MCAS.2006.1688199</pub-id></mixed-citation></ref><ref id="pone.0207777.ref034"><label>34</label><mixed-citation publication-type="other">LeDell E. h2oEnsemble: H2O ensemble learning. R package version 01. 2016;8.</mixed-citation></ref><ref id="pone.0207777.ref035"><label>35</label><mixed-citation publication-type="journal"><name><surname>Robin</surname><given-names>X</given-names></name>, <name><surname>Turck</surname><given-names>N</given-names></name>, <name><surname>Hainard</surname><given-names>A</given-names></name>, <name><surname>Tiberti</surname><given-names>N</given-names></name>, <name><surname>Lisacek</surname><given-names>F</given-names></name>, <name><surname>Sanchez</surname><given-names>JC</given-names></name>, <etal>et al</etal>
<article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title>. <source>BMC bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>77</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-12-77</pub-id>
<?supplied-pmid 21414208?><pub-id pub-id-type="pmid">21414208</pub-id></mixed-citation></ref><ref id="pone.0207777.ref036"><label>36</label><mixed-citation publication-type="journal"><name><surname>Russell</surname><given-names>R</given-names></name>, <name><surname>Gamblin</surname><given-names>S</given-names></name>, <name><surname>Haire</surname><given-names>L</given-names></name>, <name><surname>Stevens</surname><given-names>D</given-names></name>, <name><surname>Xiao</surname><given-names>B</given-names></name>, <name><surname>Ha</surname><given-names>Y</given-names></name>, <etal>et al</etal>
<article-title>H1 and H7 influenza haemagglutinin structures extend a structural classification of haemagglutinin subtypes</article-title>. <source>Virology</source>. <year>2004</year>;<volume>325</volume>(<issue>2</issue>):<fpage>287</fpage>&#x02013;<lpage>296</lpage>. <pub-id pub-id-type="doi">10.1016/j.virol.2004.04.040</pub-id>
<?supplied-pmid 15246268?><pub-id pub-id-type="pmid">15246268</pub-id></mixed-citation></ref><ref id="pone.0207777.ref037"><label>37</label><mixed-citation publication-type="journal"><name><surname>Burke</surname><given-names>DF</given-names></name>, <name><surname>Smith</surname><given-names>DJ</given-names></name>. <article-title>A recommended numbering scheme for influenza A HA subtypes</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>11</issue>):<fpage>e112302</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0112302</pub-id>
<?supplied-pmid 25391151?><pub-id pub-id-type="pmid">25391151</pub-id></mixed-citation></ref><ref id="pone.0207777.ref038"><label>38</label><mixed-citation publication-type="journal"><name><surname>Bush</surname><given-names>RM</given-names></name>, <name><surname>Bender</surname><given-names>CA</given-names></name>, <name><surname>Subbarao</surname><given-names>K</given-names></name>, <name><surname>Cox</surname><given-names>NJ</given-names></name>, <name><surname>Fitch</surname><given-names>WM</given-names></name>. <article-title>Predicting the evolution of human influenza A</article-title>. <source>Science</source>. <year>1999</year>;<volume>286</volume>(<issue>5446</issue>):<fpage>1921</fpage>&#x02013;<lpage>1925</lpage>. <pub-id pub-id-type="doi">10.1126/science.286.5446.1921</pub-id>
<?supplied-pmid 10583948?><pub-id pub-id-type="pmid">10583948</pub-id></mixed-citation></ref><ref id="pone.0207777.ref039"><label>39</label><mixed-citation publication-type="journal"><collab>Centers for Disease Control and Prevention</collab>. <article-title>Updated interim influenza vaccination recommendations&#x02013;2004-05 influenza season</article-title>. <source>MMWR Morbidity and mortality weekly report</source>. <year>2004</year>;<volume>53</volume>(<issue>50</issue>):<fpage>1183</fpage>
<?supplied-pmid 15614237?><pub-id pub-id-type="pmid">15614237</pub-id></mixed-citation></ref><ref id="pone.0207777.ref040"><label>40</label><mixed-citation publication-type="journal"><name><surname>Fiore</surname><given-names>AE</given-names></name>, <name><surname>Shay</surname><given-names>DK</given-names></name>, <name><surname>Broder</surname><given-names>K</given-names></name>, <name><surname>Iskander</surname><given-names>JK</given-names></name>, <name><surname>Uyeki</surname><given-names>TM</given-names></name>, <name><surname>Mootrey</surname><given-names>G</given-names></name>, <etal>et al</etal>
<article-title>Prevention and control of influenza: recommendations of the Advisory Committee on Immunization Practices (ACIP), 2008</article-title>. <source>MMWR Recommendations and reports: Morbidity and mortality weekly report Recommendations and reports</source>. <year>2008</year>;<volume>57</volume>(<issue>RR-7</issue>):<fpage>1</fpage>&#x02013;<lpage>60</lpage>. <?supplied-pmid 18685555?><pub-id pub-id-type="pmid">18685555</pub-id></mixed-citation></ref><ref id="pone.0207777.ref041"><label>41</label><mixed-citation publication-type="journal"><collab>Centers for Disease Control and Prevention</collab>. <article-title>Prevention and control of influenza with vaccines: recommendations of the Advisory Committee on Immunization Practices (ACIP)&#x02013;United States, 2012-13 influenza season</article-title>. <source>MMWR Morbidity and mortality weekly report</source>. <year>2012</year>;<volume>61</volume>(<issue>32</issue>):<fpage>613</fpage>
<?supplied-pmid 22895385?><pub-id pub-id-type="pmid">22895385</pub-id></mixed-citation></ref><ref id="pone.0207777.ref042"><label>42</label><mixed-citation publication-type="journal"><name><surname>Wilson</surname><given-names>IA</given-names></name>, <name><surname>Cox</surname><given-names>NJ</given-names></name>. <article-title>Structural basis of immune recognition of influenza virus hemagglutinin</article-title>. <source>Annual review of immunology</source>. <year>1990</year>;<volume>8</volume>(<issue>1</issue>):<fpage>737</fpage>&#x02013;<lpage>787</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.iy.08.040190.003513</pub-id>
<?supplied-pmid 2188678?><pub-id pub-id-type="pmid">2188678</pub-id></mixed-citation></ref><ref id="pone.0207777.ref043"><label>43</label><mixed-citation publication-type="journal"><name><surname>Blackburne</surname><given-names>BP</given-names></name>, <name><surname>Hay</surname><given-names>AJ</given-names></name>, <name><surname>Goldstein</surname><given-names>RA</given-names></name>. <article-title>Changing selective pressure during antigenic changes in human influenza H3</article-title>. <source>PLoS pathogens</source>. <year>2008</year>;<volume>4</volume>(<issue>5</issue>):<fpage>e1000058</fpage>
<pub-id pub-id-type="doi">10.1371/journal.ppat.1000058</pub-id>
<?supplied-pmid 18451985?><pub-id pub-id-type="pmid">18451985</pub-id></mixed-citation></ref><ref id="pone.0207777.ref044"><label>44</label><mixed-citation publication-type="other">G&#x000fc;ne&#x0015f; F, Wolfinger R, Tan PY. Stacked Ensemble Models for Improved Prediction Accuracy;.</mixed-citation></ref></ref-list></back></article>