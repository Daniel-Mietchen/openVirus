<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?noissn?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD with MathML3 v1.2 20190208//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1-mathml3.dtd?><?SourceDTD.Version 1.2?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">medRxiv</journal-id><journal-id journal-id-type="publisher-id">MEDRXIV</journal-id><journal-title-group><journal-title>medRxiv</journal-title></journal-title-group><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">7273255</article-id><article-id pub-id-type="doi">10.1101/2020.05.01.20086801</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">1</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Efficient prevalence estimation and infected sample identification with group testing for SARS-CoV-2</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cleary</surname><given-names>Brian</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref rid="FN1" ref-type="author-notes">*</xref><xref rid="CR1" ref-type="corresp">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>Hay</surname><given-names>James A.</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref rid="FN1" ref-type="author-notes">*</xref></contrib><contrib contrib-type="author"><name><surname>Blumenstiel</surname><given-names>Brendan</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Gabriel</surname><given-names>Stacey</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Regev</surname><given-names>Aviv</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref><xref ref-type="aff" rid="A5">5</xref><xref rid="CR1" ref-type="corresp">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>Mina</surname><given-names>Michael J.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A6">6</xref><xref ref-type="aff" rid="A7">7</xref><xref rid="CR1" ref-type="corresp">&#x02020;</xref></contrib></contrib-group><aff id="A1"><label>1</label>Broad Institute of MIT and Harvard, Cambridge, MA 02142 USA</aff><aff id="A2"><label>2</label>Centre for Communicable Disease Dynamics, Department of Epidemiology, Harvard School of Public Health, Boston, MA, USA</aff><aff id="A3"><label>3</label>Klarman Cell Observatory, Broad Institute of MIT and Harvard</aff><aff id="A4"><label>4</label>Department of Biology, Massachusetts Institute of Technology, Cambridge, MA 02142 USA</aff><aff id="A5"><label>5</label>Howard Hughes Medical Institute, Chevy Chase, MD, USA</aff><aff id="A6"><label>6</label>Department of Immunology and Infectious Diseases, Harvard School of Public Health</aff><aff id="A7"><label>7</label>Department of Pathology, Brigham and Women&#x02019;s Hospital, Harvard Medical School</aff><author-notes><fn fn-type="equal" id="FN1"><label>*</label><p id="P1">These authors contributed equally to this work</p></fn><fn fn-type="con" id="FN2"><p id="P2"><bold>Author contributions</bold> B.C. and J.H. performed the simulations and modeling. B.B. performed the pooled testing. B.C., J.H, A.R, and M.M. analyzed results and wrote the manuscript with input from all authors.</p></fn><corresp id="CR1"><label>&#x02020;</label>Correspondence should be addressed to: <email>bcleary@broadinstitute.org</email> (B.C.), <email>aregev@broadinstitute.org</email> (A.R.), <email>mmina@hsph.harvard.edu</email> (M.M.)</corresp></author-notes><pub-date pub-type="epub"><day>06</day><month>5</month><year>2020</year></pub-date><elocation-id>2020.05.01.20086801</elocation-id><permissions><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref><license-p>It is made available under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC 4.0 International license</ext-link>.</license-p></license></permissions><self-uri content-type="pdf">nihpp-2020.05.01.20086801.pdf</self-uri><abstract id="ABS1"><p id="P3">The ongoing pandemic of SARS-CoV-2, a novel coronavirus, caused over 3 million reported cases of coronavirus disease 2019 (COVID-19) and 200,000 reported deaths between December 2019 and April 2020<sup><xref rid="R1" ref-type="bibr">1</xref></sup>. Cases and deaths will increase as the virus continues its global march outward. In the absence of effective pharmaceutical interventions or a vaccine, wide-spread virological screening is required to inform where restrictive isolation measures should be targeted and when they can be lifted<sup><xref rid="R2" ref-type="bibr">2</xref>&#x02013;<xref rid="R6" ref-type="bibr">6</xref></sup>. However, limitations on testing capacity have restricted the ability of governments and institutions to identify individual clinical cases, appropriately measure community prevalence, and mitigate transmission. Group testing offers a way to increase efficiency, by combining samples and testing a small number of pools<sup><xref rid="R7" ref-type="bibr">7</xref>&#x02013;<xref rid="R9" ref-type="bibr">9</xref></sup>. Here, we evaluate the effectiveness of group testing designs for individual identification or prevalence estimation of SARS-CoV-2 infection when testing capacity is limited. To do this, we developed mathematical models for epidemic spread, incorporating empirically measured individual-level viral kinetics to simulate changing viral loads in a large population over the course of an epidemic. We used these to construct representative populations and assess pooling strategies for community screening, accounting for variability in viral load samples, dilution effects, changing prevalence and resource constraints. We confirmed our group testing framework through pooled tests on de-identified human nasopharyngeal specimens with viral loads representative of the larger population. We show that group testing designs can both accurately estimate overall prevalence using a small number of measurements and substantially increase the identification rate of infected individuals in resource-limited settings.</p></abstract></article-meta></front><body><p id="P4">We aimed to evaluate the effectiveness of group testing for overall prevalence estimation and individual case identification. In the classical version of the identification problem<sup><xref rid="R7" ref-type="bibr">7</xref></sup>, samples from multiple individuals are combined and tested as a single pool (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). If the test is negative (which might be likely if the prevalence is low and the pool is not too large), then each of the individuals is assumed to have been negative. If the test is positive, it is assumed that at least one individual in the pool was positive; each of the pooled samples is then tested individually. This strategy leverages the low frequency of cases which would otherwise cause substantial inefficiency, as the majority of pools will test negative when prevalence is low. The simple pooling method can be expanded to combinatorial pooling (each sample represented in multiple pools) for direct sample identification<sup><xref rid="R8" ref-type="bibr">8</xref>,<xref rid="R9" ref-type="bibr">9</xref></sup> (<xref rid="F1" ref-type="fig">Fig. 1b</xref>) and to pooled testing for prevalence estimation<sup><xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R11" ref-type="bibr">11</xref></sup> (<xref rid="F1" ref-type="fig">Fig. 1c</xref>).</p><p id="P5">To deploy group testing in the current pandemic, we need designs that can account for the (i) prevalence of infection within the population, (ii) position along the epidemic curve, and (iii) within-host kinetics of viral infection. These designs should also be optimized for the use case: individual case identification (<xref rid="F1" ref-type="fig">Fig. 1a</xref>,<xref rid="F1" ref-type="fig">b</xref>) or overall prevalence estimation (<xref rid="F1" ref-type="fig">Fig. 1c</xref>). Accounting for the within-host kinetics is important because during the course of an infection an individual&#x02019;s viral load can vary by at least 6 orders of magnitude<sup><xref rid="R12" ref-type="bibr">12</xref>&#x02013;<xref rid="R14" ref-type="bibr">14</xref></sup> and this, along with the prevalence of infection will affect sensitivity to detect a positive sample once diluted in a pool. The position along the epidemic curve when the samples are collected (<italic>i.e</italic>., epidemic growth versus decline) is important because the population distribution of viral titers among those who are positive might (non-intuitively) vary depending on the stage of the epidemic. For example, during early phases, rapid growth of the epidemic implies that positive individuals are more likely to have been infected more recently, such that viral titers likely capture the viral growth phase. The contrast is true on the downside of the epidemic, where an increasing number of individuals will be in the recovery (low virus titer) stage of infection. The importance of this bias depends both on the epidemic growth rate and the relative duration of the within-host viral growth and waning phases.</p><p id="P6">To explore optimal pooling strategies synthetically, we developed a population level mathematical model of SARS-CoV-2 transmission that incorporates realistic within-host virus kinetics (<xref rid="F2" ref-type="fig">Fig. 2</xref>, <xref rid="S1" ref-type="sec">Methods</xref>). We fit the model to published time-series viral load data<sup><xref rid="R14" ref-type="bibr">14</xref></sup> to capture the variation of peak viral loads, delays from symptom onset to peak, virus decay rates and incubation periods (<xref rid="F2" ref-type="fig">Fig. 2b</xref>, <xref rid="F5" ref-type="fig">Extended Data Fig. 1</xref>, and <xref rid="T1" ref-type="table">Extended Data Table 1</xref>). We simulated infection prevalence under an epidemic growth and decay process, using a deterministic Susceptible-Exposed-Infected-Removed (SEIR) model of infection dynamics with parameters that reflect the natural history of SARS-CoV-2 (<xref rid="F2" ref-type="fig">Fig. 2d</xref>, <xref rid="F6" ref-type="fig">Extended Data Fig. 2</xref>, and <xref rid="T1" ref-type="table">Extended Data Table 1</xref>, <xref rid="S1" ref-type="sec">Methods</xref>). For each simulated infection, an incubation period and virus titers over time were drawn at random from representative distributions of incubation periods<sup><xref rid="R15" ref-type="bibr">15</xref></sup> and virus titer kinetics using the parameter fits for viral load over time described above. From these simulations, we generated a contrived realistic population of individuals, each with time-varying viral loads on each day of the outbreak (<xref rid="F2" ref-type="fig">Fig. 2c</xref>,<xref rid="F2" ref-type="fig">e</xref>) and used these to evaluate optimal group testing strategies in a simulated epidemic.</p><p id="P7">We first evaluated prevalence estimation with a range of possible pooling designs. We varied the pool size (<italic>n</italic>) of combined specimens (<italic>n</italic>=48, 96, 192, or 384) and the number of pools (<italic>b</italic>) to be evaluated (<italic>b</italic>=6, 12, 24, or 48), and (knowing the true simulated prevalence) estimated prevalence from pooled tests on random samples of individuals drawn during epidemic growth (days 20&#x02013;150) and decline (days 150&#x02013;300) phases of the epidemic (<xref rid="S1" ref-type="sec">Methods</xref>).</p><p id="P8">Our results (<xref rid="F3" ref-type="fig">Fig. 3</xref>) demonstrate it is possible to obtain accurate estimates of prevalence over at least four orders of magnitude, with up to 400-times less testing. For example, we find that a population prevalence study that collects 9,216 samples can very accurately capture the true prevalence of infection by performing only 48 PCR tests (<italic>b</italic> = 48 pools of <italic>n</italic> = 192 samples each) and that this accuracy holds for a wide range of true prevalences from 0.005% to 30% (<xref rid="F3" ref-type="fig">Fig. 3b</xref>; <xref rid="F7" ref-type="fig">Extended Data Fig. 3</xref>). As expected, the total number (<italic>N</italic>) of samples collected was important for accurate estimates depending on true prevalence. Specifically, estimates were most accurate when <italic>N</italic> is greater than one divided by prevalence (<xref rid="F3" ref-type="fig">Fig. 3a</xref>). When this condition is not met, the estimates perform somewhat better in capturing the prevalence represented within the samples themselves, but we find that error in representative sampling may drive discrepancies away from the true population prevalence (<xref rid="F3" ref-type="fig">Fig. 3c</xref> and <xref rid="F7" ref-type="fig">Extended Data Fig. 3</xref>). For all values of <italic>N</italic>, partitioning the samples into more pools improves accuracy when <italic>N</italic> is greater than one divided by prevalence (see multiple rows with the same values for <italic>N</italic> in <xref rid="F3" ref-type="fig">Fig. 3b</xref>,<xref rid="F3" ref-type="fig">c</xref> and <xref rid="F7" ref-type="fig">Extended Data Fig. 3</xref>). Thus, we find that with a sufficiently large number of total samples collected, very accurate estimates of prevalence can be measured using a small fraction of tests than would be needed in the absence of pooling.</p><p id="P9">We next analyzed the effectiveness of group testing for determination of individual sample results (<xref rid="F1" ref-type="fig">Fig. 1a</xref>,<xref rid="F1" ref-type="fig">b</xref>). Because positive samples are diluted in a pool, usually with many negatives, we might intuit that the sensitivity of the assay would be reduced. However, it is worth noting that this is not always the case because a feature of pooled testing is that a sample that becomes diluted below the LOD may nonetheless be identified (&#x02018;rescued&#x02019;) if the pools containing that sample also include at least one other sample that is sufficiently above the LOD. Based on our models of viral kinetics, we estimate the sensitivity of conventional (non-pooled) PCR testing to be ~70% (<italic>i.e</italic>., 30% of the time we sample an infected individual who has a viral load greater than 1 but below the LOD; here 100 viral copies per mL, <xref rid="F4" ref-type="fig">Fig. 4a</xref>). This reflects a combination of either sampling during the incubation period of the virus (<italic>i.e</italic>., after infection but prior to the onset of symptoms) as well as a relatively long duration of low viral titers during viral clearance (<xref rid="F2" ref-type="fig">Fig. 2b</xref>, <xref rid="F5" ref-type="fig">Extended Data Fig. 1</xref>). In addition to affecting sensitivity, prevalence impacts testing efficiency. Here, we define testing efficiency as the total number of samples tested divided by the total number of tests performed. If there are no positive results, the total number of tests will be equal to the number of pools. As prevalence increases, testing efficiency will decrease because the number of tests needed to be performed in order to resolve exactly which samples are positive will increase.</p><p id="P10">We used our simulated epidemic to generate contrived samples collected over time to estimate how both sensitivity and testing efficiency are affected by the number of pools and number of samples in each pool, throughout the course of the epidemic. We refer to the number of samples divided by the number of samples in each pool as the dilution factor. (<xref rid="F8" ref-type="fig">Extended Data Fig. 4a</xref>, see <xref rid="S1" ref-type="sec">Methods</xref> for a full description of the underlying group testing simulations).</p><p id="P11">Our simulations show how sensitivity is affected by both prevalence and the dilution factor. At early times in the epidemic, prevalence is low and sensitivity is decreased relative to individual testing for all pooling designs due to dilution. When prevalence is high (&#x0003e;10%), sensitivity of group testing approaches the sensitivity of individual testing as lower viral load samples are &#x02018;rescued&#x02019; by higher viral load samples (<xref rid="F4" ref-type="fig">Fig. 4a</xref>). Several aspects of the pooling design contribute to the decrease in sensitivity at earlier times. First, when more samples are tested, the dilution factor has the potential to be bigger. Second, for a given number of samples, the dilution factor will generally be larger when the number of pools is smaller. Third, for a given number of samples and pools, the dilution factor is bigger when each sample is split into more pools. Each of these effects is borne out in our results (<xref rid="F4" ref-type="fig">Fig. 4a</xref>, <xref rid="F8" ref-type="fig">Extended Data Fig. 4a</xref>), with sensitivity decreasing roughly linearly as the log of the dilution factor (<xref rid="F8" ref-type="fig">Extended Data Fig. 4a</xref>). Importantly though, these lower sensitivities are due to failure to identify samples with low viral load (<xref rid="F8" ref-type="fig">Extended Data Fig. 4b</xref>,<xref rid="F8" ref-type="fig">c</xref>,<xref rid="F8" ref-type="fig">d</xref>). Because viral titers peak early after viral infection while virus clearance is associated with a relatively long duration of low virus counts potentially for weeks afterwards (<xref rid="F8" ref-type="fig">Extended Data Fig. 4b</xref>,<xref rid="F8" ref-type="fig">d</xref>), the loss in sensitivity stems from a failure to detect low viral load specimens that might be less clinically relevant. The benefits gained, in terms of testing efficiency, must therefore be weighed against the loss in sensitivity, both for surveillance and with an eye towards the clinical importance of missing low viral load specimens.</p><p id="P12">Testing efficiency is partly determined by the number of pools, and partly determined by the prevalence of infection. When prevalence is low, efficiency is roughly the number of samples divided by the number of pools, since there are rarely putative positives to test in the validation stage (<xref rid="F4" ref-type="fig">Fig. 4b</xref>). However, for any given pooling design, the number of test kits consumed on a daily basis will increase over time as the number of positive samples in the population grows. There are two aspects of the pooling design that mediate the increase in consumed tests. The first and most significant is that, for a given number of samples tested on a daily basis, the number of test kits consumed per day will increase more quickly when there are fewer pools (see different colored lines in <xref rid="F4" ref-type="fig">Fig. 4b</xref>). This is because there will be more putative positives for the same number of true positives when the number of pools is small. For example, when there is only one pool, every sample is a putative positive and must be re-tested if the pool tests positive, whereas with several pools, if only a subset of pools tests positive, then only a subset of samples needs to be re-tested (<xref rid="F1" ref-type="fig">Fig. 1a</xref>,<xref rid="F1" ref-type="fig">b</xref>). For the same reason, with a given number of samples and pools, when each individual sample is split into fewer pools, the total number of tests will increase more quickly (dashed versus solid lines in <xref rid="F4" ref-type="fig">Fig. 4b</xref>).</p><p id="P13">Thus, there are tradeoffs to consider between sensitivity and efficiency: testing more samples will potentially result in lower sensitivity but greater efficiency; having more pools will result in greater sensitivity and lower efficiency when prevalence is low, but higher efficiency when prevalence is high; and, splitting each sample into more pools results in lower sensitivity but greater efficiency. The appropriate balance between these may depend on the goal at hand.</p><p id="P14">In a setting of community screening, we may be ultimately interested in total recall (the total number of positive individuals that we are able to identify). While individual testing may have the highest sensitivity (because samples are not diluted), with limited resources it might be that individual testing identifies fewer positive samples than group testing, because fewer samples are being screened.</p><p id="P15">To systematically explore total recall in resource limited settings, we evaluated results averaged over days 40&#x02013;90 (up to a prevalence of 1.3%, when most designs begin to rapidly lose efficiency; <xref rid="F4" ref-type="fig">Fig. 4b</xref>) for individual testing and a wide array of group designs (<xref rid="T2" ref-type="table">Extended Data Table 2</xref>), under a variety of &#x0201c;budget&#x0201d; constraints on the number of samples collected daily, and the number of reactions that can be run on a daily basis. Across all constraints considered, effectiveness (total recall relative to individual testing) of the optimal design ranges from 1 (when testing every sample individually is optimal) to 20 (<italic>i.e</italic>., identifying 20x more positive samples on a daily basis compared with individual testing with the same budget). Examining the effectiveness of the design achieving the greatest total recall under each combination of budget constraints (<xref rid="F4" ref-type="fig">Fig. 4c</xref>), shows that when sample collection is limiting, samples should always be screened individually (matching our intuitive understanding). When sample collection is in excess of reaction capacity, group testing becomes more effective, with single pool designs being most effective when samples are in slight excess (2&#x02013;8x), and combinatorial designs being most effective when there is a large excess of samples relative to reaction capacity (see trends within rows as the number of samples increases in <xref rid="F4" ref-type="fig">Fig. 4c</xref>). When prevalence is higher (<italic>e.g</italic>., over days 70&#x02013;120, with prevalence from 0.3% to 10%) the optimal designs shift more towards combinatorial pooling and the overall effectiveness is reduced (up to 5.5x more effective than individual testing; <xref rid="F8" ref-type="fig">Extended Data Fig. 4e</xref>).</p><p id="P16">Finally, we performed two pilot lab experiments for group testing of SARS-CoV-2. First, we assessed if testing pooled samples of variable viral loads behaves as expected with respect to dilution effects. Beginning with 5 nasopharyngeal clinical swab samples with previously determined viral loads (11, 140, 1,280, 12,300, and 89,000 viral copies per ml), we diluted each at equal volumes into 23 negative nasopharyngeal swab samples (dilution factor of 24), then extracted viral RNA and ran RT-qPCR on each pool (<xref rid="S1" ref-type="sec">Methods</xref>). The results were consistent with a (diluted) LOD of 10: the first pool was negative, the second inconclusive (negative on N1, positive on N2), and the remaining three all positive (<xref rid="F4" ref-type="fig">Fig. 4d</xref>, <xref rid="T3" ref-type="table">Extended Data Table 3</xref>). Next, we tested combinatorial pooling. Starting with 48 samples (47 negative and 1 positive with a viral load of 12,300) we created 6 pools, with each sample split into 3 pools (<xref rid="F4" ref-type="fig">Fig. 4e</xref>, <xref rid="T4" ref-type="table">Extended Data Table 4</xref>, <xref rid="S1" ref-type="sec">Methods</xref>). As anticipated, 3 pools tested positive and 3 negative, with the 3 positive pools corresponding to those including the single positive sample (<xref rid="F4" ref-type="fig">Fig. 4e</xref>, <xref rid="T5" ref-type="table">Extended Data Table 5</xref>). One negative sample was included in the same 3 pools as the positive sample; thus, 8 total tests (6 pools + 2 validations) were needed to identify the single positive sample out of the 48.</p><p id="P17">Taken together, our results suggest that group testing for SARS-CoV-2 can be a highly effective tool for community screening. Our analysis suggests that a few dozen tests can be used to accurately infer prevalence, and we identify an array of designs for sample identification that optimize the rate at which infected individuals are identified under constraints on sample collection and reaction throughput. While our experimental tests suggest it might be possible to translate these results into practice, there are several reasons why theoretically optimized group testing designs might be limited in the practical context of SARS-CoV-2 epidemiology. First and foremost, there is little point in group testing when sample collection is limiting, as it has been during the current outbreak in some regions of the world due to limited availability of nasopharyngeal swabs. Moreover, even when swabs are not limiting and more samples could be collected, substantial logistical challenges in managing and tracking thousands of samples (potentially in multiple pools) must be overcome. In addition, while we assume that individuals are sampled from the population at random in our analysis, in practice samples that are processed together were also typically collected together. Substantial coordination will therefore be necessary to make group testing practical, but investing in these efforts could enable community screening where it is currently infeasible, and provide epidemiological insights that are urgently needed.</p><sec id="S1"><title>Methods</title><sec id="S2"><title>Model of infection dynamics</title><p id="P18">We implemented a deterministic compartmental model to describe the increase and subsequent decline of SARS-CoV-2 infection incidence and prevalence. The model captured the following progression: individuals begin fully susceptible to infection (<italic>S</italic>); become exposed but not yet infectious (<italic>E</italic>); become infectious (<italic>I</italic>); and are finally removed (<italic>R</italic>). Our aim was to capture changes in incidence over time (increasing incidence rate before the peak and declining incidence thereafter) and the resulting population-level distribution of viral loads, and we therefore did not model additional complexity such as deaths, pre-symptomatic transmission or age-stratified outcomes. Although incorporating these mechanisms may alter the simulated epidemic dynamics for a given set of transmission parameters, we do not expect them to impact inference from the pooled testing analyses.</p><p id="P19">The model was defined by the following set of ordinary differential equations:
<disp-formula id="FD1"><mml:math id="M9"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD2"><mml:math id="M10"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD3"><mml:math id="M11"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mi>E</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD4"><mml:math id="M12"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math></disp-formula>
where <italic>&#x003b2;</italic>is the transmission rate, scaled to give a basic reproductive number <italic>R</italic><sub>0</sub> of 2.2; 1/<italic>&#x003c3;</italic> is the incubation period, assumed to have a mean of 6.4 days; 1/<italic>&#x003b3;</italic> is the infectious period assumed to have a mean of 7 days; and <italic>N</italic> is the population size, assumed to be 6,900,000 (the state of Massachusetts, USA). All model parameters and assumed values are described in <xref rid="T1" ref-type="table">Extended Data Table 1</xref>. Using this model, we simulated per capita daily infection probability (<italic>i.e</italic>., the daily incidence) and prevalence.</p></sec><sec id="S3"><title>Viral load kinetics</title><p id="P20">Viral load was assumed to increase exponentially following infection, peaking soon after symptom onset, and subsequently undergoing exponential decay. These assumptions are equivalent to linear growth and decay on a log scale. The <italic>log</italic><sub>10</sub> viral load over time, <italic>v</italic>(<italic>t</italic>), was given by:
<disp-formula id="FD5"><mml:math id="M13"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mi>t</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c9;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mi>t</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
where <italic>&#x003b1;</italic> is the peak viral load; <italic>tp</italic> is the time of peak viral load post infection; and <italic>&#x003c9;</italic> is the waning rate post peak. For the purpose of simulation, <italic>tp</italic> was split into the incubation period (time from infection to symptom onset) and time from symptom onset to peak viral load.</p></sec><sec id="S4"><title>Fitting the viral kinetics model</title><p id="P21">Time-series viral load data were obtained from a case series of 9 hospitalized COVID-19 patients from a single hospital in Munich, Germany<sup><xref rid="R14" ref-type="bibr">14</xref></sup>. These data provide regular measurements of <italic>log</italic><sub>10</sub> RNA copies per ml from nasal and nasopharyngeal swabs. Data were extracted using a web plot digitizer (<ext-link ext-link-type="uri" xlink:href="https://automeris.io/WebPlotDigitizer/">https://automeris.io/WebPlotDigitizer/</ext-link>). We used a random-effects model to infer individual-level viral kinetics parameters alongside population-level distributions. Under this model, each individual had their own parameter value for peak viral load, time from symptom onset to peak and waning rate, drawn from normally distributed population-level averages with estimated means (<inline-formula><mml:math id="M14"><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="M15"><mml:mover accent="true"><mml:mi>&#x003c9;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="M16"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>), and fixed or estimated standard deviations (<italic>&#x003c3;</italic><sub><italic>&#x003b1;</italic></sub>, <italic>&#x003c3;</italic><sub><italic>&#x003c9;</italic></sub> and <italic>&#x003c3;</italic><sub><italic>tp</italic></sub>) (<xref rid="T1" ref-type="table">Extended Data Table 1</xref>). Because all of the viral load measurements were taken after the onset of symptoms, we did not infer the timing of infection. Instead, we assumed that 3J represented only the time from symptom onset to peak viral load and <italic>t</italic><sub><italic>i</italic></sub> = 0. This did not affect our estimates for <italic>&#x003b1;</italic>, <italic>tp</italic> or <italic>&#x003c9;</italic>.</p><p id="P22">The model was fit using a Markov chain Monte Carlo (MCMC) framework, using a likelihood that assumes normally distributed observation error with estimated standard deviation :<italic>&#x003c3;</italic><sub><italic>obs</italic></sub>. The likelihood function accounted for truncation at the lower limit of detection (LOD) by integrating over the left hand tail of the normal cumulative density function for model-predicted viral loads less than the LOD. All estimated parameters were given uniform priors with bounds shown in <xref rid="T1" ref-type="table">Extended Data Table 1</xref>. Individual-level viral kinetics parameters were given hyperpriors as described above. Code to regenerate the MCMC fitting is provided (see <xref rid="S10" ref-type="sec">Code availability</xref>). Briefly, an adaptive Metropolis-Hastings algorithm was run for 300,000 iterations with the first 100,000 iterations discarded as burn in. Convergence was assessed visually based on trace plots of 3 independent chains (<xref rid="F6" ref-type="fig">Extended Data Fig. 2</xref>). All estimates parameters had an effective sample size (ESS) greater than 200, other than <italic>&#x003c3;</italic><sub><italic>tp</italic>)</sub>which had an ESS of 100.</p></sec><sec id="S5"><title>Simulation framework</title><p id="P23">We combined the estimates from the transmission model and viral kinetics model above to simulate viral loads for a population of <italic>n</italic> individuals over time. For each individual, we simulated a time of infection (or no infection) from the time-varying probability of infection, J(3). For each infected individual, an incubation period was drawn from a log normal distribution with mean (of the natural log) = 1.57 and standard deviation (of the natural log) = 0.65 as estimated previously<sup><xref rid="R15" ref-type="bibr">15</xref></sup>. Next, we drew viral kinetics parameters for each individual from normal distributions with means of <inline-formula><mml:math id="M17"><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="M18"><mml:mover accent="true"><mml:mi>&#x003c9;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="M19"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and standard deviations of <italic>&#x003c3;</italic><sub><italic>&#x003b1;</italic></sub>, <italic>&#x003c3;</italic><sub><italic>&#x003c9;</italic></sub> and <italic>&#x003c3;</italic><sub><italic>tp</italic></sub>, respectively. Finally, we simulated the time-varying viral load of each infected individual, starting at the time of infection. These simulations provide a population of viral loads incorporating realistic variability in viral load kinetics and between-individual parameters.</p></sec><sec id="S6"><title>Estimating prevalence from pooled test results</title><p id="P24">We adapted an inference framework developed for modeling HIV prevalence with pooled antibody tests<sup><xref rid="R10" ref-type="bibr">10</xref></sup> to build a maximum likelihood estimate (MLE) of prevalence among <italic>N</italic> samples based on the results of <italic>b</italic> pooled tests, with each pool consisting of <inline-formula><mml:math id="M20"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> samples. Briefly, the MLE is determined by computing the conditional probability of the observed results given that there were <italic>k</italic> positive samples, and integrating over all values of <italic>k</italic>. To compute these conditional distributions, we estimate an empirical distribution of Ct values that follows from the distribution of viral loads in infected individuals. Notably, fitting empirical distributions allows our inference framework to be independent of the modeling choices made for epidemic spread and viral kinetics. The empirical distributions used here are derived from all of the simulated viral load measurements in a set of individuals selected as a training population. This is conceptually similar to using the empirical distribution of all real measurements from a population taken to date. We note that although these distributions may not be reflective of the true distribution of viral loads across the entire population on a given day (<italic>e.g</italic>., because the distributions on a given day will be different during epidemic growth or decline), we were nonetheless able to accurately infer the true underlying prevalence.</p><p id="P25">Let <italic>f</italic><sub><italic>k</italic>,<italic>n</italic></sub> = <italic>P</italic>(<italic>Y</italic>| <italic>k</italic>,<italic>n</italic>) represent the conditional probability of the observed Ct values in each pool, Y = [<italic>y</italic><sub>1</sub>, &#x02026;, <italic>y</italic><sub><italic>b</italic></sub>], given that there were <italic>k</italic> positive samples in the pool and <italic>n</italic>-<italic>k</italic> negative samples. Computing these distributions will be the central task of generating prevalence estimates.</p><p id="P26">To begin, we model Ct values as a function of the underlying viral loads:
<disp-formula id="FD6"><mml:math id="M21"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>v</italic> is the viral load (in copies per ml). To capture variance in the LOD between labs or across batches within a lab, we let the intercept, <italic>y</italic><sub>0</sub>, be normally distributed with unknown mean and standard deviation. We assume uniform priors over each <italic>y</italic><sub>0</sub> (<italic>&#x003bc;</italic> ~ <italic>Uniform</italic>(37,39), <italic>&#x003c3;</italic> ~ <italic>Uniform</italic>(0.1,1)). These ranges and the log-linear relationship are based on a calibration of Ct values to a dilution curve of positive control SARS-CoV-2 RNA samples (data not shown), and are consistent with prior measurements calibrated to SARS coronavirus<sup><xref rid="R16" ref-type="bibr">16</xref></sup>.</p><p id="P27"><italic>f</italic><sub><italic>k</italic>,<italic>n</italic></sub> depends not only on the distribution of Ct values arising from a given viral load, but also on the distribution of viral loads in infected and uninfected individuals. Here we assume that the viral load in uninfected individuals is always zero (we do, however, allow for false positive PCR results, as discussed below). Given access to the true distribution of viral loads, <italic>f</italic><sub><italic>k</italic>,<italic>n</italic></sub> can be generated by the convolution of <italic>k</italic> density functions. Since we do not have access to the true distributions, we approximate <italic>f</italic><sub><italic>k</italic>,<italic>n</italic></sub> through a kernel density estimate (KDE) of empirical convolutions. Specifically, for a given value of <italic>n</italic> and each value of <italic>k</italic> from 1 to <italic>n</italic>, we generate 10,000 random combinations of <italic>k</italic> viral loads,
<disp-formula id="FD7"><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext mathvariant="italic">&#x000a0;for&#x000a0;i&#x000a0;from&#x000a0;</mml:mtext><mml:mn>1</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>z</italic><sub><italic>j</italic></sub> are the randomly sampled viral loads. For each <italic>i</italic>, we sample <italic>&#x003bc;</italic> ~ <italic>Uniform</italic> (37,39), <italic>&#x003c3;</italic> ~ <italic>Uniform</italic> (0.1,1) and <italic>y</italic><sub>0</sub> ~ <italic>N</italic>(<italic>&#x003bc;</italic>, <italic>&#x003c3;</italic>) and then generate Ct values:
<disp-formula id="FD8"><mml:math id="M23"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext mathvariant="italic">&#x000a0;for&#x000a0;i&#x000a0;from&#x000a0;</mml:mtext><mml:mn>1</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000.</mml:mn></mml:mrow></mml:math></disp-formula></p><p id="P28">We then approximate <italic>f</italic><sub><italic>k</italic>,<italic>n</italic></sub> = <italic>KDE</italic>(<italic>X</italic><sub><italic>k</italic>,<italic>n</italic></sub>) with a bandwidth parameter of 0.1.</p><p id="P29">Several adjustments to these density approximations are needed to account for false positives and undefined Ct values (<italic>i.e</italic>., undetected viral RNA). To allow for Ct values that might arise from false positives, we define <italic>f</italic><sub>0,<italic>n</italic></sub> = <italic>f</italic><sub>1,<italic>n</italic></sub>
<italic>r</italic>, where <italic>r</italic> is an assumed false positive rate of PCR (here, we set <italic>r</italic> = 0.2% and allow this to be misspecified when simulating false positives below). When viral RNA is undetected and <italic>k</italic> &#x0003e; 1, we let <inline-formula><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="italic">undetected</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle><mml:mo>&#x0222b;</mml:mo></mml:mstyle><mml:mrow><mml:mn>40</mml:mn></mml:mrow><mml:mi>&#x0221e;</mml:mi></mml:msubsup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, where a Ct value of 40 is used as a typical limit of detectable RNA. When <italic>k</italic> = 0, <italic>f</italic><sub>0,<italic>n</italic></sub>(<italic>undetected</italic>) = 1 &#x02212; <italic>r</italic>.</p><p id="P30">Following the model of Zenios and Wein<sup><xref rid="R10" ref-type="bibr">10</xref></sup> the MLE of prevalence, <italic>p</italic>, is defined as:
<disp-formula id="FD9"><mml:math id="M25"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext mathvariant="italic">estimated</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mi>k</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>n</italic> is the number of samples per pool, <italic>b</italic>, is the number of pools, and X<sub>M</sub> is the Ct value observed in pool <italic>i</italic>. We calculate <italic>P</italic>(<italic>k</italic> | <italic>y</italic><sub><italic>i</italic></sub>, <italic>p</italic>) using the conditional densities above:
<disp-formula id="FD10"><mml:math id="M26"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
substituting the appropriate values of <italic>f</italic> when the Ct value is undefined. Note that each of the observed Ct values is adjusted to account for <italic>n</italic>-fold dilution. Finally, we find <italic>p</italic><sub><italic>estimated</italic></sub> through an iterative expectation-maximization algorithm, where at each iteration
<disp-formula id="FD11"><mml:math id="M27"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mi>k</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P31">Using this model, we evaluated prevalence estimation across time in our simulated populations. We first partition the simulated population into training and testing sets. Observed viral loads in 20% of individuals (selected at random) are used to train the KDEs above. All remaining analyses are done on the testing population. We simulate viral loads in <italic>b</italic> pools of samples as <inline-formula><mml:math id="M28"><mml:mrow><mml:mi>V</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mtext mathvariant="italic">Poisson</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext mathvariant="italic">&#x000a0;for&#x000a0;i&#x000a0;from&#x000a0;</mml:mtext><mml:mn>1</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>, where Poisson sampling is used to model the sampling of a small volume from each swab. From these we simulate Ct values, <italic>Y</italic>. At each time point, we randomly select <italic>N</italic> individuals, partition them into <italic>b</italic> pools, and simulate the pooled viral loads and Ct values, <italic>Y</italic>, with <italic>y</italic><sub>0</sub> ~ <italic>N</italic>(38.5,1) sampled randomly in each trial and applying the transformation described previously. To capture false positive PCR results at a rate of 1%, with 1% probability in each pool we add a viral load of <inline-formula><mml:math id="M29"><mml:mrow><mml:mtext mathvariant="italic">Poisson</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with <italic>z</italic><sub><italic>j</italic></sub> selected at random from all positive samples with <inline-formula><mml:math id="M30"><mml:mrow><mml:mfrac><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo>&#x0003e;</mml:mo><mml:mi>L</mml:mi><mml:mi>O</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> on a given date. We then compute the true prevalence in the population, <italic>p</italic><sub><italic>true</italic></sub>, the prevalence in the population of <italic>N</italic> samples, <italic>p</italic><sub><italic>sampled</italic></sub>, and the prevalence estimated from <italic>b</italic> tests, <italic>p</italic><sub><italic>estimated</italic></sub>. To quantify accuracy we calculate the mean and standard deviation of these values at each time point across 100 random trials (<xref rid="F3" ref-type="fig">Fig. 3a</xref>), and summarize differences between <italic>p</italic><sub><italic>estimated</italic></sub> and either <italic>p</italic><sub><italic>true</italic></sub> or <italic>p</italic><sub><italic>sampled</italic></sub> with the normalized root mean squared error (NRMSE; either <inline-formula><mml:math id="M31"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext mathvariant="italic">true</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext mathvariant="italic">true</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="M32"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mtext mathvariant="italic">sampled</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext mathvariant="italic">sampled</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>; <xref rid="F3" ref-type="fig">Fig. 3b</xref>,<xref rid="F3" ref-type="fig">c</xref> and <xref rid="F7" ref-type="fig">Extended Data Fig. 3</xref>).</p></sec><sec id="S7"><title>Group testing for sample identification</title><p id="P32">In the classical version of group testing for sample identification, samples from multiple individuals are combined and tested as a single pool. If the test is negative (which might be likely if the frequency of positives is low and the pool is not too big), then each of the individuals is assumed to have been negative. If the test is positive, it is assumed that at least one individual in the pool was positive; each of the pooled samples is then tested individually (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). This strategy leverages the low frequency of cases which would otherwise cause substantial inefficiency, as the majority of pools will test negative when prevalence is low. A mathematical framework for determining optimal pooling sizes was originally applied to efficiently screen for syphilis during World War II<sup><xref rid="R7" ref-type="bibr">7</xref></sup>.</p><p id="P33">More recent applications involve combinatorial pooling strategies, where each sample is split into multiple, partially overlapping pools<sup><xref rid="R8" ref-type="bibr">8</xref>,<xref rid="R9" ref-type="bibr">9</xref></sup> (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). Good designs ensure that each sample is represented in a unique combination of pools, where the number and composition of pools are adjusted depending on the prevalence and error rate. If there are no errors, and at most one sample in the population is positive, then the set of positive tests across the pools uniquely identifies the single positive sample (as in <xref rid="F1" ref-type="fig">Fig. 1b</xref>). Such designs are typically used in non-adaptive group testing, where the goal is to exactly identify the positive samples using only results on a single round of pooled tests. In order to be able to exactly decode up to <italic>k</italic> positives in a population of <italic>N</italic> samples, the number of combinatorial pools needs to scale as <italic>O(k</italic><sup>2</sup><italic>log(N))</italic><sup><xref rid="R8" ref-type="bibr">8</xref>,<xref rid="R9" ref-type="bibr">9</xref></sup>. A class of matrices, called disjunct matrices, that are appropriately sized and allow for exact decoding are typically used in this context.</p><p id="P34">Here we consider a very simple form of adaptive group tests, where putative positive samples are individually tested in a validation stage. Because we perform this second stage of testing, we are not restricted to disjunct matrices (allowing for exact identification in stage (i)), and we can use fewer pools than are required for non-adaptive testing.</p><p id="P35">In this setting, a given pooling design is defined by several parameters: the total number of individuals, <italic>N</italic>; the total number of pools, <italic>b</italic>; and the number of pools, <italic>q</italic>, into which each individual sample is split (each sample will be split the same number of times&#x02014;this constraint is imposed both for ease of laboratory workflow, and so that samples are treated equitably). For instance, if we have <italic>N</italic>=50 individuals with samples split randomly into <italic>q</italic>=2 out of <italic>b</italic>=4 pools, then on average, each pool would contain 25 samples, and thus be diluted 25-fold. We analyzed a large array of designs (with <italic>N</italic> between 2 and 6,144, <italic>b</italic> between 1 and 96, and <italic>q</italic> from 1 to 3; <xref rid="T2" ref-type="table">Extended Data Table 2</xref>) to understand effects on sensitivity, efficiency and total recall, and to identify optimal designs under different resource constraints.</p><p id="P36">For any given design we can simulate pooled testing results on the simulated population described above. For each time point, we randomly select <italic>N</italic> individuals from the population. Each individual is then randomly assigned to <italic>q</italic> out of <italic>b</italic> pools. For each pool, we then calculate the net sampled viral load, <inline-formula><mml:math id="M33"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mtext mathvariant="italic">Poisson</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>d</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using the viral loads <italic>z</italic><sub><italic>j</italic></sub> for each individual included in <italic>pool</italic><sub><italic>i</italic></sub>, where Poisson sampling is used to model a small volume sampled from each swab. If <italic>v</italic><sub><italic>i</italic></sub> &#x0003e; <italic>LOD</italic> the pool is assigned a positive value, otherwise the pool is negative (here, with LOD=100). To allow for false positive PCR results at a rate of 1%, with probability 1% we set the result of the pool to be positive, regardless of the viral load.</p><p id="P37">Based on the results of <italic>b</italic> pooled tests and the assignments of samples to pools, we can infer putative positive samples. This is done using a simple decoding algorithm: any sample that was included in a negative test is eliminated as a negative; the remaining samples are putatively positive. This simple, yet highly effective algorithm can be easily implemented in a notebook or very simple Excel sheet.</p><p id="P38">Simulations are run by repeating the random pooling, pooled testing, and decoding procedures described above. At each point in time, 2,500 trials are run selecting <italic>N</italic> individuals at random in each trial. We then record the number of validation tests, <italic>s</italic>, in each trial, corresponding to the number of putative positive samples. Average efficiency at a point in time, <italic>t</italic>, is then calculated as <inline-formula><mml:math id="M34"><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">Efficiency</mml:mtext></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Average sensitivity is calculated as <inline-formula><mml:math id="M35"><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">Sensitivity</mml:mtext></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext mathvariant="italic">putative</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext mathvariant="italic">positive</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> where <italic>N</italic><sub><italic>positive</italic></sub> is the total number of infected individuals (viral load &#x0003e; 1) that were sampled across all trials and <italic>N</italic><sub><italic>putative</italic></sub> is the number of such individuals who were identified as putative positives. From these values we calculate <italic>Total Recall</italic><sub><italic>t</italic></sub> = <italic>Efficiency</italic><sub><italic>t</italic></sub>
<italic>Sensitivity</italic><sub><italic>t</italic></sub>.</p><p id="P39">Based on these results we evaluated a large array of group testing designs (<xref rid="T2" ref-type="table">Extended Data Table 2</xref>) under a series of constraints on number of samples collected and number of reactions run per day (<xref rid="F4" ref-type="fig">Fig. 4c</xref>). For a given design <italic>D</italic>: (<italic>N</italic>, <italic>b</italic>, <italic>q</italic>) we calculate the average number of tests run, <inline-formula><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mtext mathvariant="italic">total</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, and the total number of times that <italic>D</italic> could be run on a daily basis, <inline-formula><mml:math id="M37"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">samples&#x000a0;collected</mml:mtext></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">testing&#x000a0;kits</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mtext mathvariant="italic">total</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We then calculate the effective testing capacity on a daily basis, c<sub>D</sub> = <italic>N r</italic><sub><italic>D</italic></sub>
<italic>Sensitivity</italic><sub><italic>D</italic></sub>, and average this value over days 40 to 90 (<xref rid="F4" ref-type="fig">Fig. 4c</xref>) or 70 to 120 (<xref rid="F8" ref-type="fig">Extended Data Fig. 4e</xref>) of the simulated epidemic. Notably, when sample collection is limiting, <italic>c</italic><sub><italic>D</italic></sub> = <italic>samples collected</italic> * <italic>Sensitivity</italic><sub>(<italic>samples collected</italic>,<italic>samples collected</italic>,1)</sub> corresponding to individual testing. Finally, the optimal design for a given combination of constraints is the design with the greatest average effective testing capacity. In <xref rid="F4" ref-type="fig">Fig. 4c</xref> and <xref rid="F8" ref-type="fig">Extended Data Fig. 4e</xref> we show the relative effectiveness, corresponding to effective capacity relative to individual testing.</p></sec><sec id="S8"><title>Sample collection</title><p id="P40">All samples used in this study were de-identified, discarded human nasopharyngeal specimens previously tested at the Broad Institute. Samples were pooled before RNA extraction and qPCR.</p></sec><sec id="S9"><title>RT+qPCR of pooled samples</title><p id="P41">All pooled population samples were tested following the Broad Institute CRSP SARS-CoV-2 Real-time Reverse Transcriptase (RT)-PCR Diagnostic Assay as submitted for Emergency Use Authorization. Briefly, RNA is isolated from nasopharyngeal and oropharygneal specimens in 50ul VTM/UTM using MagMAX&#x02122;&#x02212;96 Viral RNA Isolation Kits (Thermo Fisher Scientific, AMB18365), performed on an Agilent Bravo Liquid Handling Platform running VWorks (Build 11.4.0.1233), and is reverse transcribed to cDNA and subsequently amplified in the Applied Biosystems&#x000ae; ViiA7 Real-Time PCR Instrument with QuantStudio version 1.3 software. In the process, the probe anneals to a specific target sequence located between the forward and reverse primers. During the extension phase of the PCR cycle, the 5&#x02019; nuclease activity of Taq polymerase degrades the probe, causing the reporter dye to separate from the quencher dye, generating a fluorescent signal. With each cycle, additional reporter dye molecules are cleaved from their respective probes, increasing the fluorescence intensity. Fluorescence intensity is monitored at each PCR cycle by Applied Biosystems&#x000ae; ViiA7 Real-Time PCR System with QuantStudio version 1.3 software. The software allows the fluorescence intensity to be monitored at each PCR cycle to allow for the qualitative detection of nucleic acid from SARS-CoV-2.</p></sec><sec id="S10"><title>Code availability</title><p id="P42">The SEIR model, viral kinetics model and MCMC were implemented in R version 3.6.2. The remainder of the work was performed in Python version 3.7. The code used for the MCMC framework is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jameshay218/lazymcmc">https://github.com/jameshay218/lazymcmc</ext-link>. All other code and data used are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/cleary-lab/covid19-group-tests">https://github.com/cleary-lab/covid19-group-tests</ext-link>.</p></sec><sec sec-type="data-availability" id="S11"><title>Data availability</title><p id="P43">Raw data generated in this study are available in <xref rid="T3" ref-type="table">Extended Data Tables 3</xref> and <xref rid="T5" ref-type="table">5</xref>.</p></sec></sec><sec sec-type="extended-data" id="S13"><title>Extended Data</title><fig id="F5" orientation="portrait" position="anchor"><label>Extended Data Fig. 1:</label><caption><title>Model fits to viral loads from the 9 individuals included in the model fitting.</title><p id="P50">Note that data were extracted from (Wolfel et al. 2020). The black dots show observed <italic>log10</italic> RNA copies/ml; solid lines show posterior median estimates; dark shaded regions show 95% credible intervals (CI) on model-predicted latent viral loads; light shaded regions show 95% CI on simulated viral loads with added observation noise. The horizontal dashed line shows the limit of detection. Inset text shows posterior median and 95% credible intervals for each of the fitted parameters. Note that these are the same fits/trajectories as in <xref rid="F1" ref-type="fig">Fig 1</xref>, but with <italic>log10</italic> viral loads assumed to start at 0 at the time of infection rather than the time of simulated infection. Because we are only inferring parameters post symptom onset (delay from symptom onset to peak viral load, peak viral load and waning rate), this change does not affect our estimates.</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0005"/></fig><fig id="F6" orientation="portrait" position="anchor"><label>Extended Data Fig. 2:</label><caption><title>Trace plots and estimated posterior distributions for all viral kinetics parameters.</title><p id="P51">Each color shows an independent chain. (<bold>A)</bold> Trace plots showing the path of the Markov chain Monte Carlo sampler, demonstrating convergence to the same stationary distribution for all chains. (<bold>B</bold>) Estimated posterior distributions.</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0006"/></fig><fig id="F7" orientation="portrait" position="anchor"><label>Extended Data Fig. 3:</label><caption><title>Prevalence estimation errors during decline phase.</title><p id="P52">Normalized root mean squared error (NRMSE, <inline-formula><mml:math id="M3"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">RMSE</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">prevalence</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>; greyscale and text in each box) between estimated prevalence and true prevalence (<bold>left</bold>) or between estimated prevalence and sampled prevalence (<bold>right</bold>) is shown for a variety of pooling designs (individual rows). Prevalence range shown in individual columns.</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0007"/></fig><fig id="F8" orientation="portrait" position="anchor"><label>Extended Data Fig. 4:</label><caption><title>Sensitivity of case identification relative to viral load and symptom onset.</title><p id="P53">(<bold>A</bold>) The sensitivity (y-axis) of different designs (individual points) is plotted against the dilution factor of each design (x-axis, log scale). Pooling designs are separated by the number of samples tested on a daily basis (individual panels); the number of pools (color); and the number of pools into which each sample is split (circle versus cross). (<bold>B</bold>) The sensitivity (y-axis) of two pooling designs (two panels; design indicated above plot) for individual case identification is plotted against time relative to onset of symptoms (x-axis). Red lines: sensitivity with the indicated group testing design; Blue lines: sensitivity with individual testing. (<bold>C</bold>) As in (<bold>B</bold>) with the same two pooling designs, but with sensitivity plotted as a function of viral load in our simulations (x-axis; log scale). (<bold>D</bold>) The mean (solid line) and standard deviation (shaded region) of viral load (y-axis, log scale) relative to the onset of symptoms (x-axis) in all positive samples in the simulated population. (<bold>E</bold>) Every design was evaluated under a pair of constraints on number of samples collected on a daily basis (columns) and number of reactions that can be run on a daily basis (rows) over days 70&#x02013;120. Text in each box indicates the optimal design for a given set of constraints (arranged vertically: number of samples, number of pools, number of pools into which each sample is split, average number of times this design is run on a daily basis given the constraints). Color indicates the average number of positive samples identified on a daily basis using the optimal design, relative to the number of positive samples identified through individual testing with the same constraints.</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0008"/></fig><table-wrap id="T1" orientation="portrait" position="anchor"><label>Extended Data Table 1:</label><caption><title>Description of all parameters used in the viral kinetics and transmission models.</title><p id="P54">Values shown are posterior median estimates and 95% credible intervals or fixed values. Individual-level estimates are shown in <xref rid="F5" ref-type="fig">Extended Data Fig. 1</xref>. Prior bounds show lower and upper bounds on uniform priors placed on estimated parameters when running the Markov chain Monte Carlo algorithm. Note that the upper bound on delay from symptom onset to peak viral load parameter is varied for each individual. This was taken as the first day post symptom onset for which an individual has an observation.</p></caption><table frame="hsides" rules="none"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><tbody><tr><th colspan="5" align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1">Viral kinetics model</th></tr><tr><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Parameter</th><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Description</th><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Estimate</th><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Prior lower bound</th><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Prior upper bound</th></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="M4"><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Mean of peak viral load parameters</td><td align="left" valign="middle" rowspan="1" colspan="1">7.04 (5.86&#x02013;8.29)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">100</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>&#x003c3;</italic><sup><italic>&#x003b1;</italic></sup></td><td align="left" valign="middle" rowspan="1" colspan="1">Standard deviation of peak viral load parameters</td><td align="left" valign="middle" rowspan="1" colspan="1">0.9 (fixed)</td><td align="left" valign="middle" rowspan="1" colspan="1">NA</td><td align="left" valign="middle" rowspan="1" colspan="1">NA</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="M5"><mml:mover accent="true"><mml:mi>&#x003c9;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Mean of viral waning rate parameters</td><td align="left" valign="middle" rowspan="1" colspan="1">0.613 (0.442&#x02013;0.815)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">10</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>&#x003c3;</italic><sup><italic>&#x003c9;</italic></sup></td><td align="left" valign="middle" rowspan="1" colspan="1">Standard deviation of waning rate parameters</td><td align="left" valign="middle" rowspan="1" colspan="1">0.198 (0.0904&#x02013;0.413)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">10</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="M6"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Mean of delay from symptom onset to peak viral load</td><td align="left" valign="middle" rowspan="1" colspan="1">1.62 (0.477&#x02013;2.67)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">14</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>&#x003c3;</italic><sup><italic>tp</italic></sup></td><td align="left" valign="middle" rowspan="1" colspan="1">Standard deviation of delays from symptom onset to peak viral load</td><td align="left" valign="middle" rowspan="1" colspan="1">0.443 (0.0471&#x02013;1.44)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">5</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>&#x003c3;</italic></td><td align="left" valign="middle" rowspan="1" colspan="1">Standard deviation of observation process</td><td align="left" valign="middle" rowspan="1" colspan="1">1.40 (1.15&#x02013;1.78)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">10</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>&#x003b1;</italic><sub><italic>i</italic></sub></td><td align="left" valign="middle" rowspan="1" colspan="1">Individual peak viral load parameters</td><td align="left" valign="middle" rowspan="1" colspan="1">Varied</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">100</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>tp</italic><sub><italic>i</italic></sub></td><td align="left" valign="middle" rowspan="1" colspan="1">Individual delays from symptom onset to peak viral load</td><td align="left" valign="middle" rowspan="1" colspan="1">Varied</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">Varied, time of first observation</td></tr><tr><td align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1"><italic>&#x003c9;</italic><sub><italic>i</italic></sub></td><td align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Individual viral waning rate parameters</td><td align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Varied</td><td align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">0</td><td align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">2</td></tr></tbody><tbody><tr><th colspan="5" align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1">SEIR Model</th></tr><tr><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Parameter</th><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Description</th><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1">Estimate</th><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1"/><th align="left" valign="middle" style="border-bottom: solid 1px" rowspan="1" colspan="1"/></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>R</italic><sub>0</sub></td><td align="left" valign="middle" rowspan="1" colspan="1">Basic reproductive number</td><td align="left" valign="middle" rowspan="1" colspan="1">2.2 (fixed)</td><td align="left" valign="middle" rowspan="1" colspan="1"/><td align="left" valign="middle" rowspan="1" colspan="1"/></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="M7"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>&#x003b3;</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Infectious period</td><td align="left" valign="middle" rowspan="1" colspan="1">7 days (fixed)</td><td align="left" valign="middle" rowspan="1" colspan="1"/><td align="left" valign="middle" rowspan="1" colspan="1"/></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="M8"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>&#x003c3;</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Incubation period</td><td align="left" valign="middle" rowspan="1" colspan="1">6.4 days (fixed)</td><td align="left" valign="middle" rowspan="1" colspan="1"/><td align="left" valign="middle" rowspan="1" colspan="1"/></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>I</italic><sub>0</sub></td><td align="left" valign="middle" rowspan="1" colspan="1">Initial number of infected individuals</td><td align="left" valign="middle" rowspan="1" colspan="1">100 (fixed)</td><td align="left" valign="middle" rowspan="1" colspan="1"/><td align="left" valign="middle" rowspan="1" colspan="1"/></tr></tbody></table></table-wrap><table-wrap id="T2" orientation="portrait" position="anchor"><label>Extended Data Table 2:</label><caption><p id="P55">List of all group test designs for sample identification.</p></caption><table frame="void" rules="none"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" valign="middle" rowspan="1" colspan="1">Number of pools</th><th align="left" valign="middle" rowspan="1" colspan="1">Number of samples</th><th align="left" valign="middle" rowspan="1" colspan="1">Number of pools per sample</th><th align="left" valign="middle" rowspan="1" colspan="1">Dilution</th></tr></thead><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">32</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">32</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">64</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">64</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">6</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">32</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">64</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">128</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">6</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">32</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">64</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">128</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">6</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">32</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">64</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">1536</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">128</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">1536</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">6</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">32</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">1536</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">64</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">1536</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">3072</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">128</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">48</td><td align="left" valign="middle" rowspan="1" colspan="1">3072</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">6</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">384</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">768</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">24</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">1536</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">32</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">1536</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">48</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">3072</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">64</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">3072</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">96</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">6144</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">128</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">96</td><td align="left" valign="middle" rowspan="1" colspan="1">6144</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">192</td></tr></tbody></table></table-wrap><table-wrap id="T3" orientation="portrait" position="anchor"><label>Extended Data Table 3:</label><caption><title>Ct values from qPCR on pooled samples with variable viral load.</title><p id="P56">Five positive samples with variable viral loads (89,000, 12,300, 1,280, 140, and 11, for samples 1&#x02013;5, respectively) were each pooled with 23 negative samples. Values in table show the Ct values for each of five pools for three primer pairs (N1, N2, and RP), along with a final call (positive, negative, or inconclusive).</p></caption><table frame="box" rules="all"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" valign="top" rowspan="1" colspan="1">Sample Name</th><th align="left" valign="top" rowspan="1" colspan="1">N1 CT</th><th align="left" valign="top" rowspan="1" colspan="1">N2 CT</th><th align="left" valign="top" rowspan="1" colspan="1">RP CT</th><th align="left" valign="top" rowspan="1" colspan="1">Call</th></tr></thead><tbody><tr><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">24_Dil_1</td><td align="left" valign="top" rowspan="1" colspan="1">28.93</td><td align="left" valign="top" rowspan="1" colspan="1">29.58</td><td align="left" valign="top" rowspan="1" colspan="1">28.62</td><td align="left" valign="top" rowspan="1" colspan="1">POS</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">24_Dil_2</td><td align="left" valign="top" rowspan="1" colspan="1">31.07</td><td align="left" valign="top" rowspan="1" colspan="1">31.73</td><td align="left" valign="top" rowspan="1" colspan="1">28.71</td><td align="left" valign="top" rowspan="1" colspan="1">POS</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">24_Dil_3</td><td align="left" valign="top" rowspan="1" colspan="1">33.29</td><td align="left" valign="top" rowspan="1" colspan="1">33.91</td><td align="left" valign="top" rowspan="1" colspan="1">28.37</td><td align="left" valign="top" rowspan="1" colspan="1">POS</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">24_Dil_4</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">35.9</td><td align="left" valign="top" rowspan="1" colspan="1">29.17</td><td align="left" valign="top" rowspan="1" colspan="1">Inconclusive</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">24_Dil_5</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">28.62</td><td align="left" valign="top" rowspan="1" colspan="1">Negative</td></tr></tbody></table></table-wrap><table-wrap id="T4" orientation="portrait" position="anchor"><label>Extended Data Table 4:</label><caption><title>Pool design for combinatorial test with 48 samples.</title><p id="P57">Each of 48 samples was split in equal volume into 3 out of 6 pools. Sample 48 was positive (viral load 12,300), and all other samples were negative.</p></caption><table frame="void" rules="none"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><tbody><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 1: 1, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 25: 1, 4, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 2: 2, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 26: 1, 2, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 3: 3, 4, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 27: 1, 2, 3</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 4: 4, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 28: 3, 4, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 5: 4, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 29: 2, 3, 5</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 6: 1, 3, 4</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 30: 3, 4, 5</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 7: 3, 4, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 31: 1, 3, 4</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 8: 3, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 32: 1, 2, 4</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 9: 2, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 33: 1, 2, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 10: 2, 4, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 34: 1, 2, 5</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 11: 1, 4, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 35: 3, 4, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 12: 2, 4, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 36: 1, 3, 4</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 13: 2, 3, 4</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 37: 2, 3, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 14: 2, 4, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 38: 1, 3, 5</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 15: 1, 3, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 39: 2, 4, 5</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 16: 3, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 40: 1, 4, 5</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 17: 1, 3, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 41: 1, 5, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 18: 2, 3, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 42: 1, 2, 5</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 19: 3, 5, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 43: 2, 3, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 20: 1, 2, 3</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 44: 1, 4, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 21: 2, 3, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 45: 1, 2, 3</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 22: 2, 3, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 46: 2, 5, 6</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 23: 1, 3, 5</td><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 47: 2, 3, 4</td></tr><tr><td align="left" valign="bottom" rowspan="1" colspan="1">Sample 24: 1, 3, 6</td><td align="left" valign="bottom" rowspan="1" colspan="1">*Sample 48: 1, 2, 4(Pos)</td></tr></tbody></table></table-wrap><table-wrap id="T5" orientation="portrait" position="anchor"><label>Extended Data Table 5:</label><caption><title>Ct values from qPCR on combinatorial pools.</title><p id="P58">qPCR results for combinatorial pools in <xref rid="T4" ref-type="table">Extended Data Table 4</xref>. Values in table show the Ct values for each of six pools for three primer pairs (N1, N2, and RP), along with a final call (positive, negative, or inconclusive).</p></caption><table frame="box" rules="all"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" valign="top" rowspan="1" colspan="1">Sample Name</th><th align="left" valign="top" rowspan="1" colspan="1">N1 CT</th><th align="left" valign="top" rowspan="1" colspan="1">N2 CT</th><th align="left" valign="top" rowspan="1" colspan="1">RP CT</th><th align="left" valign="top" rowspan="1" colspan="1">Call</th></tr></thead><tbody><tr><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/><td align="left" valign="top" rowspan="1" colspan="1"/></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Pool_1</td><td align="left" valign="top" rowspan="1" colspan="1">30.49</td><td align="left" valign="top" rowspan="1" colspan="1">31.18</td><td align="left" valign="top" rowspan="1" colspan="1">28.3</td><td align="left" valign="top" rowspan="1" colspan="1">POS</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Pool_2</td><td align="left" valign="top" rowspan="1" colspan="1">31.49</td><td align="left" valign="top" rowspan="1" colspan="1">31.93</td><td align="left" valign="top" rowspan="1" colspan="1">28.75</td><td align="left" valign="top" rowspan="1" colspan="1">POS</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Pool_3</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">29.62</td><td align="left" valign="top" rowspan="1" colspan="1">Negative</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Pool_4</td><td align="left" valign="top" rowspan="1" colspan="1">31.71</td><td align="left" valign="top" rowspan="1" colspan="1">31.66</td><td align="left" valign="top" rowspan="1" colspan="1">29.34</td><td align="left" valign="top" rowspan="1" colspan="1">POS</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Pool_5</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">30.01</td><td align="left" valign="top" rowspan="1" colspan="1">Negative</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1">Pool_6</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">Undetermined</td><td align="left" valign="top" rowspan="1" colspan="1">29.99</td><td align="left" valign="top" rowspan="1" colspan="1">Negative</td></tr></tbody></table></table-wrap></sec></body><back><ack id="S12"><title>Acknowledgements</title><p id="P44">We thank Xihong Lin, Madikay Senghore, Benedicte Gnangnon, Abdul Sesay, Rounak Dey, David Hong, Edgar Doriban and Heather Shakerchi for useful discussions. Work was supported by the Merkin Institute Fellowship at the Broad Institute of MIT and Harvard (B.C.), by the National Institute of General Medical Sciences (#U54GM088558; JAH and MJM); and by an NIH DP5 grant (MJM).</p></ack><fn-group><fn fn-type="COI-statement" id="FN3"><p id="P45"><bold>Competing interests</bold> A.R. is a co-founder and equity holder of Celsius Therapeutics, an equity holder in Immunitas, and an SAB member of ThermoFisher Scientific, Syros Pharmaceuticals, Asimov, and Neogene Therapeutics.</p></fn></fn-group><ref-list><title>References</title><ref id="R1"><label>1.</label><mixed-citation publication-type="journal"><collab>World Health Organization (WHO)</collab>. <article-title>Coronavirus disease 2019 (COVID-19) Situation Report - 101</article-title>. <source>World Heal. Organ.</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.1001/jama.2020.2633</pub-id></mixed-citation></ref><ref id="R2"><label>2.</label><mixed-citation publication-type="journal"><collab>World Health Organization (WHO)</collab>. <article-title>Critical preparedness, readiness and response actions for COVID-19</article-title>. <source>World Heal. Organ.</source> (<year>2020</year>).</mixed-citation></ref><ref id="R3"><label>3.</label><mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>M. P.</given-names></name>
<etal/>
<article-title>Diagnostic Testing for Severe Acute Respiratory Syndrome-Related Coronavirus-2</article-title>. <source>Ann. Intern. Med.</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.7326/m20-1301</pub-id></mixed-citation></ref><ref id="R4"><label>4.</label><mixed-citation publication-type="journal"><name><surname>Yoo</surname><given-names>JH</given-names></name>, <name><surname>Chung</surname><given-names>MS</given-names></name>, <name><surname>Kim</surname><given-names>JY</given-names></name>, <name><surname>Ko</surname><given-names>JH</given-names></name>, <name><surname>Kim</surname><given-names>Y</given-names></name>, <name><surname>Kim</surname><given-names>YJ</given-names></name>, <name><surname>Kim</surname><given-names>JM</given-names></name>, <name><surname>Chung</surname><given-names>YS</given-names></name>, <name><surname>Kim</surname><given-names>HM</given-names></name>, <name><surname>Han</surname><given-names>MG</given-names></name>, <article-title>K. S. Report on the epidemiological features of coronavirus disease 2019 (covid-19) outbreak in the republic of korea from january 19 to march 2, 2020</article-title>. <source>J. Korean Med. Sci.</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.3346/jkms.2020.35.e112</pub-id></mixed-citation></ref><ref id="R5"><label>5.</label><mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>V. J.</given-names></name>, <name><surname>Chiew</surname><given-names>C. J.</given-names></name> &#x00026; <name><surname>Khong</surname><given-names>W. X.</given-names></name>
<article-title>Interrupting transmission of COVID-19: lessons from containment efforts in Singapore</article-title>. <source>J. Travel Med.</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.1093/jtm/taaa039</pub-id></mixed-citation></ref><ref id="R6"><label>6.</label><mixed-citation publication-type="journal"><name><surname>Gudbjartsson</surname><given-names>D. F.</given-names></name>
<etal/>
<article-title>Spread of SARS-CoV-2 in the Icelandic Population</article-title>. <source>N. Engl. J. Med.</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.1056/nejmoa2006100</pub-id></mixed-citation></ref><ref id="R7"><label>7.</label><mixed-citation publication-type="journal"><name><surname>Dorfman</surname><given-names>R.</given-names></name>
<article-title>The Detection of Defective Members of Large Populations</article-title>. <source>Ann. Math. Stat.</source> (<year>1943</year>). doi:<pub-id pub-id-type="doi">10.1214/aoms/1177731363</pub-id></mixed-citation></ref><ref id="R8"><label>8.</label><mixed-citation publication-type="book"><name><surname>Du</surname><given-names>D.</given-names></name>, <name><surname>Hwang</surname><given-names>F. K.</given-names></name> &#x00026; <name><surname>Hwang</surname><given-names>F.</given-names></name>
<source>Combinatorial group testing and its applications</source>. <volume>12</volume>, (<publisher-name>World Scientific</publisher-name>, <year>2000</year>).</mixed-citation></ref><ref id="R9"><label>9.</label><mixed-citation publication-type="journal"><name><surname>Porat</surname><given-names>E.</given-names></name> &#x00026; <name><surname>Rothschild</surname><given-names>A.</given-names></name>
<article-title>Explicit non-adaptive combinatorial group testing schemes</article-title>. in <source>Lecture Notes in Computer Science (including subseries Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics)</source> (<year>2008</year>). doi:<pub-id pub-id-type="doi">10.1007/978-3-540-70575-8_61</pub-id></mixed-citation></ref><ref id="R10"><label>10.</label><mixed-citation publication-type="journal"><name><surname>Zenios</surname><given-names>S. A.</given-names></name> &#x00026; <name><surname>Wein</surname><given-names>L. M.</given-names></name>
<article-title>Pooled testing for HIV prevalence estimation: Exploiting the dilution effect</article-title>. <source>Statistics in Medicine</source> (<year>1998</year>). doi:<pub-id pub-id-type="doi">10.1002/(SICI)1097-0258(19980715)17:13&#x0003c;1447::AID-SIM862&#x0003e;3.0.CO;2-K</pub-id></mixed-citation></ref><ref id="R11"><label>11.</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>C. L.</given-names></name> &#x00026; <name><surname>Swallow</surname><given-names>W. H.</given-names></name>
<article-title>Using Group Testing to Estimate a Proportion, and to Test the Binomial Model</article-title>. <source>Biometrics</source> (<year>1990</year>). doi:<pub-id pub-id-type="doi">10.2307/2532446</pub-id></mixed-citation></ref><ref id="R12"><label>12.</label><mixed-citation publication-type="journal"><name><surname>Ejima</surname><given-names>K.</given-names></name>
<etal/>
<article-title>Inferring Timing of Infection Using Within-host SARS-CoV-2 Infection Dynamics Model: Are &#x02018;Imported Cases&#x02019; Truly Imported?</article-title>
<source>medRxiv</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.1101/2020.03.30.20040519</pub-id></mixed-citation></ref><ref id="R13"><label>13.</label><mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>L.</given-names></name>
<etal/>
<article-title>SARS-CoV-2 viral load in upper respiratory specimens of infected patients</article-title>. <source>New England Journal of Medicine</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.1056/NEJMc2001737</pub-id></mixed-citation></ref><ref id="R14"><label>14.</label><mixed-citation publication-type="journal"><name><surname>W&#x000f6;lfel</surname><given-names>R.</given-names></name>
<etal/>
<article-title>Virological assessment of hospitalized patients with COVID-2019</article-title>. <source>Nature</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.1038/s41586-020-2196-x</pub-id></mixed-citation></ref><ref id="R15"><label>15.</label><mixed-citation publication-type="journal"><name><surname>Bi</surname><given-names>Q.</given-names></name>
<etal/>
<article-title>Epidemiology and Transmission of COVID-19 in Shenzhen China: Analysis of 391 cases and 1,286 of their close contacts</article-title>. <source>medRxiv</source> (<year>2020</year>). doi:<pub-id pub-id-type="doi">10.1101/2020.03.03.20028423</pub-id></mixed-citation></ref><ref id="R16"><label>16.</label><mixed-citation publication-type="journal"><name><surname>Poon</surname><given-names>L. L. M.</given-names></name>
<etal/>
<article-title>Detection of SARS coronavirus in patients with severe acute respiratory syndrome by conventional and real-time quantitative reverse transcription-PCR assays</article-title>. <source>Clin. Chem.</source>
<volume>50</volume>, <fpage>67</fpage>&#x02013;<lpage>72</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">14709637</pub-id></mixed-citation></ref></ref-list></back><floats-group><fig id="F1" orientation="portrait" position="float"><label>Fig. 1:</label><caption><title>Group testing designs for sample identification or prevalence estimation</title><p id="P46">In group testing, multiple samples are pooled and tests are run on one or more pools. The results of these tests can be used for identification of positive samples (<bold>A, B</bold>) or to estimate prevalence (<bold>C</bold>). (<bold>A</bold>) In the simplest design for sample identification, samples are partitioned into non-overlapping pools (magenta boxes). In stage (i) of testing, a negative result (Pool 1) indicates each sample in that pool was negative (Samples 1&#x02013;4), while a positive result (Pool 2) indicates at least one sample in the pool was positive. These putatively positive samples (Samples 5&#x02013;8) are subsequently individually tested in stage (ii) to identify positive results (Sample 7). (<bold>B</bold>) In a combinatorial design, samples are included in multiple pools. Putatively positive samples are those that were not included in any negative test (Sample 4). (<bold>C</bold>) In prevalence estimation, samples are partitioned into pools, and the (quantitative) results from each pool are used to estimate the fraction of samples that would have tested positive, had they been tested individually.</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0001"/></fig><fig id="F2" orientation="portrait" position="float"><label>Fig. 2:</label><caption><title>Viral kinetics model fits, simulated infection dynamics and population-wide viral load kinetics.</title><p id="P47">(<bold>A</bold>) Schematic of the viral kinetics and infection model. Individuals begin susceptible with no viral load, acquire the virus from another infectious individual (exposed), experience an increase in viral load and possibly develop symptoms (infected), and finally either recover following viral waning or die (removed). This process is simulated for many individuals. (<bold>B</bold>) Model fits to time-varying viral loads from 4 of the 9 individuals from the model fitting. The black dots show observed <italic>log10</italic> RNA copies/ml; solid lines show posterior median estimates; dark shaded regions show 95% credible intervals (CI) on model-predicted latent viral loads; light shaded regions show 95% CI on simulated viral loads with added observation noise. The orange region shows viral loads before symptom onset (not included in model fitting), red region shows time after symptom onset (included in model fitting). The horizontal dashed line shows the limit of detection. (<bold>C)</bold> 25 simulated viral loads over time. The heatmap shows the viral load in each individual over time. (<bold>D</bold>) Simulated infection incidence and prevalence of virologically positive individuals from the SEIR model (<xref rid="S1" ref-type="sec">Methods</xref>). Incidence was defined as the number of new infections per day divided by the population size. Prevalence was defined as the number of individuals with viral load &#x0003e; 1 (<italic>log10</italic> viral load &#x0003e; 0) in the population divided by the population size. (<bold>F</bold>) As in (<bold>C</bold>), but for 500 individuals. The distribution of viral loads reflects the increase and subsequent decline of prevalence. We simulated from inferred distributions for the viral load parameters, thereby propagating substantial individual-level variability through the simulations.</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0002"/></fig><fig id="F3" orientation="portrait" position="float"><label>Fig. 3:</label><caption><title>Estimating prevalence from a small number of pooled tests</title><p id="P48">In prevalence estimation, a total of <italic>N</italic> individuals are sampled and partitioned into <italic>b</italic> pools (with <inline-formula><mml:math id="M1"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> samples per pool). The true prevalence in the entire population (x-axis in <bold>A</bold>; individual columns for prevalence ranges in <bold>B</bold> and <bold>C</bold>) varies over time with epidemic spread of viral infections. In (<bold>A</bold>), the prevalence in the sampled population (y-axis; red line depicts average, red shaded region is one standard deviation over 100 random trials at each point in time) and estimated prevalence (y-axis; blue line and shaded region) are plotted against true prevalence for three different pooling designs. (<bold>B</bold> and <bold>C</bold>) Normalized root mean squared error (NRMSE, <inline-formula><mml:math id="M2"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">RMSE</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">prevalence</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>; color and text in each box) between estimated prevalence and true prevalence (in <bold>B</bold>) or between estimated prevalence and sampled prevalence (in <bold>C</bold>) is shown for a variety of pooling designs (individual rows).</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0003"/></fig><fig id="F4" orientation="portrait" position="float"><label>Fig. 4:</label><caption><title>Group testing for sample identification</title><p id="P49">Using a fixed population of 500,000 simulated individuals, a variety of group testing designs for sample identification (Supplementary Table 2) were evaluated on the basis of sensitivity (<bold>A</bold>), efficiency (<bold>B</bold>), and overall effectiveness in identifying positive samples relative to individual testing (<bold>C</bold>). (<bold>A</bold> and <bold>B</bold>) The average sensitivity (<bold>A</bold>, y-axis) and average number of tests needed to identify individual positive samples (<bold>B</bold>, y-axis) using different pooling designs (individual lines) were measured over days 40&#x02013;120 in our simulated population, with results plotted against prevalence (x-axis, log-scale). Results show the average of 2,500 trials, with individuals selected at random on each day in each trial (fluctuations at low prevalence reflect random effects in the small number of infected individuals in fixed population at early times). Pooling designs are separated by the number of samples tested on a daily basis (individual panels); the number of pools (color); and the number of pools into which each sample is split (dashed versus solid line). Solid red line indicates results for individual testing. (<bold>C</bold>) Every design was evaluated under a pair of constraints on number of samples collected on a daily basis (columns) and number of reactions that can be run on a daily basis (rows) over days 40&#x02013;90. Text in each box indicates the optimal design for a given set of constraints (arranged vertically: number of samples, number of pools, number of pools into which each sample is split, average number of times this design is run on a daily basis given the constraints). Color indicates the average number of positive samples identified on a daily basis using the optimal design, relative to the number of positive samples identified through individual testing with the same constraints. (<bold>D</bold>, <bold>E</bold>) Pooled testing of samples was validated experimentally. (<bold>D</bold>) Five pools (columns of matrix), each consisting of 24 nasopharyngeal swab samples (rows of matrix; 23 negative samples per pool and 1 positive, with viral load indicated in teal on right) were tested by viral extraction and RT+qPCR. Pooled results indicated as: negative (black), inconclusive (grey), or positive (teal). (<bold>E</bold>) Six combinatorial pools (columns) of 48 samples (rows; 47 negative and 1 positive with viral load of 12,300) were tested as above. Pools 1, 2, and 4 tested positive. Arrows indicate two samples that were in pools 1, 2, and 4: sample 32 (negative), and sample 48 (positive).</p></caption><graphic xlink:href="nihpp-2020.05.01.20086801-f0004"/></fig></floats-group></article>